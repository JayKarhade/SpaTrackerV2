INFO:numexpr.utils:Note: detected 96 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 96 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
INFO:numexpr.utils:NumExpr defaulting to 16 threads.
Seed set to: 0
Using device: cuda
Found 10 sequences.
Using 10 sequences for evaluation.
Processing sequence: basketball_1.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:09,  5.39it/s]  4%|▍         | 2/50 [00:00<00:10,  4.73it/s]  6%|▌         | 3/50 [00:00<00:10,  4.51it/s]  8%|▊         | 4/50 [00:01<00:12,  3.62it/s] 10%|█         | 5/50 [00:01<00:12,  3.63it/s] 12%|█▏        | 6/50 [00:01<00:11,  3.89it/s] 14%|█▍        | 7/50 [00:01<00:10,  4.07it/s] 16%|█▌        | 8/50 [00:01<00:09,  4.30it/s] 18%|█▊        | 9/50 [00:02<00:09,  4.14it/s] 20%|██        | 10/50 [00:02<00:10,  3.92it/s] 22%|██▏       | 11/50 [00:02<00:10,  3.84it/s] 24%|██▍       | 12/50 [00:03<00:09,  3.82it/s] 26%|██▌       | 13/50 [00:03<00:09,  3.82it/s] 28%|██▊       | 14/50 [00:03<00:09,  3.97it/s] 30%|███       | 15/50 [00:03<00:09,  3.86it/s] 32%|███▏      | 16/50 [00:04<00:08,  3.91it/s] 34%|███▍      | 17/50 [00:04<00:08,  4.04it/s] 36%|███▌      | 18/50 [00:04<00:08,  3.80it/s] 38%|███▊      | 19/50 [00:04<00:07,  4.13it/s] 40%|████      | 20/50 [00:04<00:07,  4.21it/s] 42%|████▏     | 21/50 [00:05<00:07,  3.76it/s] 44%|████▍     | 22/50 [00:05<00:07,  3.67it/s] 46%|████▌     | 23/50 [00:05<00:06,  4.03it/s] 48%|████▊     | 24/50 [00:06<00:07,  3.67it/s] 50%|█████     | 25/50 [00:06<00:09,  2.56it/s] 52%|█████▏    | 26/50 [00:07<00:08,  2.94it/s] 54%|█████▍    | 27/50 [00:07<00:10,  2.20it/s] 56%|█████▌    | 28/50 [00:08<00:08,  2.47it/s] 58%|█████▊    | 29/50 [00:08<00:07,  2.75it/s] 60%|██████    | 30/50 [00:08<00:06,  3.10it/s] 62%|██████▏   | 31/50 [00:08<00:05,  3.40it/s] 64%|██████▍   | 32/50 [00:09<00:05,  3.48it/s] 66%|██████▌   | 33/50 [00:09<00:05,  3.18it/s] 68%|██████▊   | 34/50 [00:09<00:04,  3.21it/s] 70%|███████   | 35/50 [00:09<00:04,  3.58it/s] 72%|███████▏  | 36/50 [00:10<00:03,  3.81it/s] 74%|███████▍  | 37/50 [00:10<00:03,  3.79it/s] 76%|███████▌  | 38/50 [00:10<00:03,  3.60it/s] 78%|███████▊  | 39/50 [00:10<00:03,  3.52it/s] 80%|████████  | 40/50 [00:11<00:02,  3.48it/s] 82%|████████▏ | 41/50 [00:11<00:02,  3.52it/s] 84%|████████▍ | 42/50 [00:11<00:02,  3.70it/s] 86%|████████▌ | 43/50 [00:14<00:06,  1.08it/s] 88%|████████▊ | 44/50 [00:14<00:04,  1.41it/s] 90%|█████████ | 45/50 [00:14<00:02,  1.74it/s] 92%|█████████▏| 46/50 [00:14<00:01,  2.17it/s] 94%|█████████▍| 47/50 [00:15<00:01,  2.65it/s] 96%|█████████▌| 48/50 [00:15<00:00,  3.15it/s] 98%|█████████▊| 49/50 [00:15<00:00,  3.64it/s]100%|██████████| 50/50 [00:15<00:00,  4.06it/s]100%|██████████| 50/50 [00:15<00:00,  3.20it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe23e583680>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:17,  2.80it/s]  6%|▌         | 3/50 [00:00<00:07,  6.27it/s]  8%|▊         | 4/50 [00:00<00:06,  7.17it/s] 10%|█         | 5/50 [00:00<00:05,  7.56it/s] 14%|█▍        | 7/50 [00:00<00:05,  8.16it/s] 16%|█▌        | 8/50 [00:01<00:05,  8.30it/s] 20%|██        | 10/50 [00:01<00:04,  8.99it/s] 24%|██▍       | 12/50 [00:01<00:04,  9.21it/s] 28%|██▊       | 14/50 [00:01<00:03,  9.81it/s] 32%|███▏      | 16/50 [00:01<00:03,  9.85it/s] 34%|███▍      | 17/50 [00:01<00:03,  9.63it/s] 36%|███▌      | 18/50 [00:02<00:09,  3.45it/s] 40%|████      | 20/50 [00:03<00:06,  4.58it/s] 42%|████▏     | 21/50 [00:03<00:05,  5.16it/s] 44%|████▍     | 22/50 [00:04<00:15,  1.82it/s] 46%|████▌     | 23/50 [00:05<00:11,  2.29it/s] 50%|█████     | 25/50 [00:05<00:07,  3.37it/s] 52%|█████▏    | 26/50 [00:05<00:06,  3.76it/s] 54%|█████▍    | 27/50 [00:05<00:05,  4.31it/s] 56%|█████▌    | 28/50 [00:05<00:04,  4.74it/s] 60%|██████    | 30/50 [00:05<00:03,  5.88it/s] 64%|██████▍   | 32/50 [00:06<00:02,  6.99it/s] 68%|██████▊   | 34/50 [00:06<00:02,  7.71it/s] 72%|███████▏  | 36/50 [00:06<00:01,  8.43it/s] 76%|███████▌  | 38/50 [00:06<00:01,  9.00it/s] 78%|███████▊  | 39/50 [00:06<00:01,  9.14it/s] 80%|████████  | 40/50 [00:06<00:01,  8.74it/s] 82%|████████▏ | 41/50 [00:07<00:01,  5.97it/s] 84%|████████▍ | 42/50 [00:07<00:01,  6.08it/s] 86%|████████▌ | 43/50 [00:07<00:01,  6.77it/s] 88%|████████▊ | 44/50 [00:07<00:00,  7.38it/s] 92%|█████████▏| 46/50 [00:07<00:00,  8.42it/s] 94%|█████████▍| 47/50 [00:07<00:00,  8.72it/s] 96%|█████████▌| 48/50 [00:08<00:00,  8.64it/s] 98%|█████████▊| 49/50 [00:08<00:00,  8.81it/s]100%|██████████| 50/50 [00:08<00:00,  8.92it/s]100%|██████████| 50/50 [00:08<00:00,  5.99it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")

WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")

WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")

INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 63736
INFO:root:Parameters : 2379
INFO:root:Iterations : 101
INFO:root:Time : 2.813359022140503 [s]
INFO:root:Initial cost : 1.5051293702913549 [px]
INFO:root:Final cost : 0.22234556645370782 [px]
INFO:root:Residuals : 63810
INFO:root:Parameters : 2373
INFO:root:Iterations : 101
INFO:root:Time : 2.746628999710083 [s]
INFO:root:Initial cost : 1.4414206959281208 [px]
INFO:root:Final cost : 0.16921044427045087 [px]
INFO:root:Residuals : 63718
INFO:root:Parameters : 2361
INFO:root:Iterations : 101
INFO:root:Time : 2.7964069843292236 [s]
INFO:root:Initial cost : 1.4217142029524226 [px]
INFO:root:Final cost : 0.14699287320694274 [px]
INFO:root:Residuals : 63768
INFO:root:Parameters : 2364
INFO:root:Iterations : 101
INFO:root:Time : 2.6958370208740234 [s]
INFO:root:Initial cost : 1.4292411787283559 [px]
INFO:root:Final cost : 0.15732344693474037 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:13,  3.60it/s]  4%|▍         | 2/50 [00:00<00:11,  4.01it/s]  6%|▌         | 3/50 [00:00<00:10,  4.35it/s]  8%|▊         | 4/50 [00:00<00:10,  4.24it/s] 10%|█         | 5/50 [00:01<00:17,  2.56it/s] 12%|█▏        | 6/50 [00:01<00:14,  2.95it/s] 14%|█▍        | 7/50 [00:02<00:20,  2.14it/s] 16%|█▌        | 8/50 [00:02<00:16,  2.58it/s] 18%|█▊        | 9/50 [00:03<00:13,  2.96it/s] 20%|██        | 10/50 [00:03<00:12,  3.19it/s] 22%|██▏       | 11/50 [00:03<00:11,  3.29it/s] 24%|██▍       | 12/50 [00:03<00:10,  3.55it/s] 26%|██▌       | 13/50 [00:04<00:09,  3.86it/s] 28%|██▊       | 14/50 [00:04<00:08,  4.19it/s] 30%|███       | 15/50 [00:04<00:07,  4.45it/s] 32%|███▏      | 16/50 [00:04<00:07,  4.42it/s] 34%|███▍      | 17/50 [00:04<00:07,  4.49it/s] 36%|███▌      | 18/50 [00:06<00:16,  1.96it/s] 38%|███▊      | 19/50 [00:06<00:13,  2.31it/s] 40%|████      | 20/50 [00:06<00:11,  2.71it/s] 42%|████▏     | 21/50 [00:06<00:09,  3.16it/s] 44%|████▍     | 22/50 [00:08<00:17,  1.60it/s] 46%|████▌     | 23/50 [00:08<00:13,  1.96it/s] 48%|████▊     | 24/50 [00:08<00:10,  2.41it/s] 50%|█████     | 25/50 [00:08<00:11,  2.27it/s] 52%|█████▏    | 26/50 [00:09<00:08,  2.76it/s] 54%|█████▍    | 27/50 [00:09<00:07,  3.25it/s] 56%|█████▌    | 28/50 [00:09<00:05,  3.68it/s] 58%|█████▊    | 29/50 [00:09<00:05,  4.03it/s] 60%|██████    | 30/50 [00:09<00:04,  4.34it/s] 62%|██████▏   | 31/50 [00:10<00:04,  4.63it/s] 64%|██████▍   | 32/50 [00:10<00:03,  4.52it/s] 66%|██████▌   | 33/50 [00:10<00:03,  4.66it/s] 68%|██████▊   | 34/50 [00:10<00:03,  4.33it/s] 70%|███████   | 35/50 [00:10<00:03,  4.56it/s] 72%|███████▏  | 36/50 [00:11<00:02,  4.74it/s] 74%|███████▍  | 37/50 [00:11<00:02,  4.97it/s] 76%|███████▌  | 38/50 [00:11<00:02,  5.09it/s] 78%|███████▊  | 39/50 [00:11<00:02,  4.84it/s] 80%|████████  | 40/50 [00:11<00:02,  4.67it/s] 82%|████████▏ | 41/50 [00:12<00:02,  4.25it/s] 84%|████████▍ | 42/50 [00:12<00:01,  4.26it/s] 86%|████████▌ | 43/50 [00:12<00:01,  3.55it/s] 88%|████████▊ | 44/50 [00:13<00:01,  3.24it/s] 90%|█████████ | 45/50 [00:13<00:01,  3.34it/s] 92%|█████████▏| 46/50 [00:13<00:01,  3.77it/s] 94%|█████████▍| 47/50 [00:14<00:00,  3.75it/s] 96%|█████████▌| 48/50 [00:14<00:00,  4.08it/s] 98%|█████████▊| 49/50 [00:14<00:00,  4.09it/s]100%|██████████| 50/50 [00:14<00:00,  4.37it/s]100%|██████████| 50/50 [00:14<00:00,  3.41it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_1.npz
metrics: {'epe3d_allo_image_all': 0.21525412529706955, 'epe3d_allo_pixel_all': 0.21964706721720612, 'epe3d_sf_allo_image_all': 0.15240548960864544, 'epe3d_sf_allo_pixel_all': 0.1555158065903983, 'num_valid_pixels': 5047.0, 'delta_0.05': 0.46839706756489, 'delta_0.1': 0.9102437091341391, 'delta_0.2': 0.9782048741826828, 'delta_0.4': 0.9805825242718447, 'outlier_0.15': 0.03804240142659005, 'delta_epe_0.1': 0.4168813156330493, 'delta_epe_0.3': 0.8947889835545869, 'delta_epe_0.5': 0.9684961363186051, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.1517733306914999}
Processing sequence: basketball_2.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:07,  6.14it/s]  4%|▍         | 2/50 [00:00<00:08,  5.62it/s]  6%|▌         | 3/50 [00:00<00:09,  4.79it/s]  8%|▊         | 4/50 [00:00<00:08,  5.13it/s] 10%|█         | 5/50 [00:00<00:09,  5.00it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.87it/s] 14%|█▍        | 7/50 [00:01<00:09,  4.62it/s] 16%|█▌        | 8/50 [00:01<00:10,  4.13it/s] 18%|█▊        | 9/50 [00:01<00:09,  4.42it/s] 20%|██        | 10/50 [00:02<00:08,  4.66it/s] 22%|██▏       | 11/50 [00:02<00:08,  4.68it/s] 24%|██▍       | 12/50 [00:02<00:07,  4.89it/s] 26%|██▌       | 13/50 [00:02<00:07,  4.66it/s] 28%|██▊       | 14/50 [00:02<00:07,  4.89it/s] 30%|███       | 15/50 [00:03<00:07,  4.63it/s] 32%|███▏      | 16/50 [00:03<00:06,  4.95it/s] 34%|███▍      | 17/50 [00:03<00:08,  3.92it/s] 36%|███▌      | 18/50 [00:03<00:08,  3.94it/s] 38%|███▊      | 19/50 [00:04<00:07,  3.95it/s] 40%|████      | 20/50 [00:04<00:07,  4.12it/s] 42%|████▏     | 21/50 [00:04<00:06,  4.45it/s] 44%|████▍     | 22/50 [00:04<00:05,  4.71it/s] 46%|████▌     | 23/50 [00:04<00:05,  4.90it/s] 48%|████▊     | 24/50 [00:05<00:05,  5.13it/s] 50%|█████     | 25/50 [00:05<00:04,  5.34it/s] 52%|█████▏    | 26/50 [00:05<00:04,  5.51it/s] 54%|█████▍    | 27/50 [00:05<00:04,  5.37it/s] 56%|█████▌    | 28/50 [00:05<00:04,  5.48it/s] 58%|█████▊    | 29/50 [00:06<00:03,  5.63it/s] 60%|██████    | 30/50 [00:06<00:03,  5.73it/s] 62%|██████▏   | 31/50 [00:06<00:03,  5.74it/s] 64%|██████▍   | 32/50 [00:06<00:03,  5.71it/s] 66%|██████▌   | 33/50 [00:06<00:02,  5.75it/s] 68%|██████▊   | 34/50 [00:06<00:02,  5.81it/s] 70%|███████   | 35/50 [00:07<00:02,  5.80it/s] 72%|███████▏  | 36/50 [00:07<00:03,  4.39it/s] 74%|███████▍  | 37/50 [00:07<00:03,  4.05it/s] 76%|███████▌  | 38/50 [00:08<00:03,  3.86it/s] 78%|███████▊  | 39/50 [00:08<00:02,  3.67it/s] 80%|████████  | 40/50 [00:08<00:02,  3.65it/s] 82%|████████▏ | 41/50 [00:08<00:02,  3.52it/s] 84%|████████▍ | 42/50 [00:09<00:02,  3.65it/s] 86%|████████▌ | 43/50 [00:09<00:01,  3.69it/s] 88%|████████▊ | 44/50 [00:09<00:01,  3.66it/s] 90%|█████████ | 45/50 [00:09<00:01,  3.59it/s] 92%|█████████▏| 46/50 [00:10<00:01,  3.64it/s] 94%|█████████▍| 47/50 [00:10<00:00,  3.73it/s] 96%|█████████▌| 48/50 [00:10<00:00,  3.70it/s] 98%|█████████▊| 49/50 [00:11<00:00,  3.74it/s]100%|██████████| 50/50 [00:11<00:00,  3.72it/s]100%|██████████| 50/50 [00:11<00:00,  4.42it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe898992d80>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:17,  2.78it/s]  6%|▌         | 3/50 [00:00<00:07,  6.17it/s] 10%|█         | 5/50 [00:00<00:05,  7.69it/s] 14%|█▍        | 7/50 [00:00<00:04,  8.61it/s] 16%|█▌        | 8/50 [00:01<00:04,  8.76it/s] 20%|██        | 10/50 [00:01<00:04,  9.37it/s] 22%|██▏       | 11/50 [00:01<00:05,  7.49it/s] 24%|██▍       | 12/50 [00:01<00:04,  7.88it/s] 28%|██▊       | 14/50 [00:01<00:04,  8.66it/s] 30%|███       | 15/50 [00:01<00:03,  8.77it/s] 32%|███▏      | 16/50 [00:01<00:03,  8.71it/s] 34%|███▍      | 17/50 [00:02<00:05,  5.55it/s] 38%|███▊      | 19/50 [00:02<00:04,  7.02it/s] 42%|████▏     | 21/50 [00:02<00:03,  8.20it/s] 46%|████▌     | 23/50 [00:02<00:02,  9.08it/s] 50%|█████     | 25/50 [00:03<00:02,  9.59it/s] 54%|█████▍    | 27/50 [00:03<00:02, 10.15it/s] 58%|█████▊    | 29/50 [00:03<00:01, 10.57it/s] 62%|██████▏   | 31/50 [00:03<00:01, 10.71it/s] 66%|██████▌   | 33/50 [00:03<00:01, 10.65it/s] 70%|███████   | 35/50 [00:04<00:01,  7.75it/s] 72%|███████▏  | 36/50 [00:04<00:02,  6.73it/s] 74%|███████▍  | 37/50 [00:04<00:01,  6.81it/s] 76%|███████▌  | 38/50 [00:04<00:02,  4.92it/s] 78%|███████▊  | 39/50 [00:05<00:01,  5.56it/s] 80%|████████  | 40/50 [00:05<00:01,  6.26it/s] 82%|████████▏ | 41/50 [00:05<00:01,  6.78it/s] 84%|████████▍ | 42/50 [00:05<00:01,  7.20it/s] 86%|████████▌ | 43/50 [00:05<00:00,  7.77it/s] 88%|████████▊ | 44/50 [00:05<00:00,  8.18it/s] 90%|█████████ | 45/50 [00:05<00:00,  8.49it/s] 92%|█████████▏| 46/50 [00:05<00:00,  7.23it/s] 94%|█████████▍| 47/50 [00:06<00:00,  7.82it/s] 96%|█████████▌| 48/50 [00:06<00:00,  8.20it/s] 98%|█████████▊| 49/50 [00:06<00:00,  8.40it/s]100%|██████████| 50/50 [00:06<00:00,  7.81it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 70900
INFO:root:Parameters : 2499
INFO:root:Iterations : 101
INFO:root:Time : 3.285723924636841 [s]
INFO:root:Initial cost : 1.2254054702684034 [px]
INFO:root:Final cost : 0.17277194684535507 [px]
INFO:root:Residuals : 71068
INFO:root:Parameters : 2496
INFO:root:Iterations : 101
INFO:root:Time : 3.0916590690612793 [s]
INFO:root:Initial cost : 1.003210040221324 [px]
INFO:root:Final cost : 0.14526694586850802 [px]
INFO:root:Residuals : 70740
INFO:root:Parameters : 2481
INFO:root:Iterations : 101
INFO:root:Time : 2.998167037963867 [s]
INFO:root:Initial cost : 0.975588530910186 [px]
INFO:root:Final cost : 0.14771525841881816 [px]
INFO:root:Residuals : 69526
INFO:root:Parameters : 2442
INFO:root:Iterations : 101
INFO:root:Time : 3.00201678276062 [s]
INFO:root:Initial cost : 0.9677039104622818 [px]
INFO:root:Final cost : 0.15184618206743283 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:13,  3.68it/s]  4%|▍         | 2/50 [00:00<00:10,  4.41it/s]  6%|▌         | 3/50 [00:00<00:09,  4.83it/s]  8%|▊         | 4/50 [00:00<00:10,  4.40it/s] 10%|█         | 5/50 [00:01<00:10,  4.23it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.44it/s] 14%|█▍        | 7/50 [00:01<00:12,  3.36it/s] 16%|█▌        | 8/50 [00:02<00:11,  3.72it/s] 18%|█▊        | 9/50 [00:02<00:10,  3.96it/s] 20%|██        | 10/50 [00:02<00:10,  3.89it/s] 22%|██▏       | 11/50 [00:02<00:09,  4.03it/s] 24%|██▍       | 12/50 [00:03<00:10,  3.63it/s] 26%|██▌       | 13/50 [00:03<00:09,  3.80it/s] 28%|██▊       | 14/50 [00:03<00:09,  3.86it/s] 30%|███       | 15/50 [00:03<00:08,  4.06it/s] 32%|███▏      | 16/50 [00:03<00:08,  4.19it/s] 34%|███▍      | 17/50 [00:04<00:08,  4.12it/s] 36%|███▌      | 18/50 [00:04<00:07,  4.29it/s] 38%|███▊      | 19/50 [00:04<00:07,  4.00it/s] 40%|████      | 20/50 [00:04<00:07,  4.08it/s] 42%|████▏     | 21/50 [00:05<00:06,  4.26it/s] 44%|████▍     | 22/50 [00:05<00:06,  4.15it/s] 46%|████▌     | 23/50 [00:05<00:06,  4.33it/s] 48%|████▊     | 24/50 [00:05<00:05,  4.42it/s] 50%|█████     | 25/50 [00:06<00:06,  4.15it/s] 52%|█████▏    | 26/50 [00:06<00:05,  4.12it/s] 54%|█████▍    | 27/50 [00:06<00:06,  3.73it/s] 56%|█████▌    | 28/50 [00:06<00:05,  3.86it/s] 58%|█████▊    | 29/50 [00:07<00:05,  4.13it/s] 60%|██████    | 30/50 [00:07<00:04,  4.02it/s] 62%|██████▏   | 31/50 [00:07<00:04,  4.31it/s] 64%|██████▍   | 32/50 [00:07<00:04,  3.98it/s] 66%|██████▌   | 33/50 [00:08<00:04,  4.22it/s] 68%|██████▊   | 34/50 [00:08<00:03,  4.29it/s] 70%|███████   | 35/50 [00:08<00:03,  4.22it/s] 72%|███████▏  | 36/50 [00:09<00:05,  2.68it/s] 74%|███████▍  | 37/50 [00:09<00:04,  2.91it/s] 76%|███████▌  | 38/50 [00:09<00:03,  3.23it/s] 78%|███████▊  | 39/50 [00:09<00:03,  3.62it/s] 80%|████████  | 40/50 [00:10<00:02,  3.64it/s] 82%|████████▏ | 41/50 [00:10<00:02,  3.98it/s] 84%|████████▍ | 42/50 [00:10<00:01,  4.04it/s] 86%|████████▌ | 43/50 [00:10<00:01,  3.88it/s] 88%|████████▊ | 44/50 [00:11<00:01,  4.00it/s] 90%|█████████ | 45/50 [00:11<00:01,  3.98it/s] 92%|█████████▏| 46/50 [00:11<00:00,  4.26it/s] 94%|█████████▍| 47/50 [00:11<00:00,  4.35it/s] 96%|█████████▌| 48/50 [00:12<00:00,  4.37it/s] 98%|█████████▊| 49/50 [00:12<00:00,  4.63it/s]100%|██████████| 50/50 [00:12<00:00,  4.20it/s]100%|██████████| 50/50 [00:12<00:00,  3.98it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_2.npz
metrics: {'epe3d_allo_image_all': 0.19809251934289931, 'epe3d_allo_pixel_all': 0.20213522306200313, 'epe3d_sf_allo_image_all': 0.1508119110018015, 'epe3d_sf_allo_pixel_all': 0.15388970577320893, 'num_valid_pixels': 2499.0, 'delta_0.05': 0.5686274509803921, 'delta_0.1': 0.9739895958383353, 'delta_0.2': 0.9983993597438976, 'delta_0.4': 1.0, 'outlier_0.15': 0.004401760704281713, 'delta_epe_0.1': 0.5022008803521408, 'delta_epe_0.3': 0.8103241296518607, 'delta_epe_0.5': 0.9819927971188476, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.22048819527811125}
Processing sequence: basketball_3.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:09,  5.08it/s]  4%|▍         | 2/50 [00:00<00:18,  2.57it/s]  6%|▌         | 3/50 [00:00<00:14,  3.31it/s]  8%|▊         | 4/50 [00:01<00:12,  3.56it/s] 10%|█         | 5/50 [00:01<00:12,  3.73it/s] 12%|█▏        | 6/50 [00:01<00:11,  3.90it/s] 14%|█▍        | 7/50 [00:01<00:10,  4.09it/s] 16%|█▌        | 8/50 [00:02<00:09,  4.34it/s] 18%|█▊        | 9/50 [00:02<00:09,  4.33it/s] 20%|██        | 10/50 [00:02<00:08,  4.62it/s] 22%|██▏       | 11/50 [00:02<00:08,  4.35it/s] 24%|██▍       | 12/50 [00:03<00:09,  4.06it/s] 26%|██▌       | 13/50 [00:03<00:08,  4.26it/s] 28%|██▊       | 14/50 [00:03<00:08,  4.21it/s] 30%|███       | 15/50 [00:03<00:07,  4.54it/s] 32%|███▏      | 16/50 [00:03<00:07,  4.80it/s] 34%|███▍      | 17/50 [00:04<00:06,  4.98it/s] 36%|███▌      | 18/50 [00:04<00:06,  4.79it/s] 38%|███▊      | 19/50 [00:04<00:08,  3.80it/s] 40%|████      | 20/50 [00:04<00:08,  3.62it/s] 42%|████▏     | 21/50 [00:05<00:07,  4.02it/s] 44%|████▍     | 22/50 [00:05<00:06,  4.01it/s] 46%|████▌     | 23/50 [00:05<00:06,  4.33it/s] 48%|████▊     | 24/50 [00:05<00:05,  4.37it/s] 50%|█████     | 25/50 [00:06<00:06,  4.07it/s] 52%|█████▏    | 26/50 [00:06<00:05,  4.37it/s] 54%|█████▍    | 27/50 [00:06<00:05,  4.24it/s] 56%|█████▌    | 28/50 [00:06<00:05,  4.05it/s] 58%|█████▊    | 29/50 [00:06<00:04,  4.37it/s] 60%|██████    | 30/50 [00:07<00:07,  2.84it/s] 62%|██████▏   | 31/50 [00:07<00:06,  3.11it/s] 64%|██████▍   | 32/50 [00:08<00:04,  3.60it/s] 66%|██████▌   | 33/50 [00:09<00:12,  1.42it/s] 68%|██████▊   | 34/50 [00:09<00:08,  1.78it/s] 70%|███████   | 35/50 [00:10<00:06,  2.18it/s] 72%|███████▏  | 36/50 [00:10<00:05,  2.35it/s] 74%|███████▍  | 37/50 [00:10<00:05,  2.60it/s] 76%|███████▌  | 38/50 [00:11<00:04,  2.75it/s] 78%|███████▊  | 39/50 [00:11<00:03,  3.08it/s] 80%|████████  | 40/50 [00:11<00:02,  3.56it/s] 82%|████████▏ | 41/50 [00:11<00:02,  3.99it/s] 84%|████████▍ | 42/50 [00:11<00:01,  4.39it/s] 86%|████████▌ | 43/50 [00:12<00:01,  4.26it/s] 88%|████████▊ | 44/50 [00:12<00:01,  4.49it/s] 90%|█████████ | 45/50 [00:12<00:01,  4.79it/s] 92%|█████████▏| 46/50 [00:12<00:00,  5.06it/s] 94%|█████████▍| 47/50 [00:12<00:00,  5.09it/s] 96%|█████████▌| 48/50 [00:13<00:00,  5.17it/s] 98%|█████████▊| 49/50 [00:13<00:00,  5.29it/s]100%|██████████| 50/50 [00:14<00:00,  1.99it/s]100%|██████████| 50/50 [00:14<00:00,  3.45it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe898550ad0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:17,  2.82it/s]  6%|▌         | 3/50 [00:00<00:07,  6.19it/s] 10%|█         | 5/50 [00:00<00:05,  7.98it/s] 14%|█▍        | 7/50 [00:00<00:04,  8.70it/s] 16%|█▌        | 8/50 [00:01<00:04,  8.94it/s] 20%|██        | 10/50 [00:01<00:04,  9.51it/s] 24%|██▍       | 12/50 [00:01<00:03,  9.96it/s] 28%|██▊       | 14/50 [00:01<00:03, 10.05it/s] 32%|███▏      | 16/50 [00:01<00:03, 10.03it/s] 36%|███▌      | 18/50 [00:01<00:03, 10.16it/s] 40%|████      | 20/50 [00:02<00:02, 10.41it/s] 44%|████▍     | 22/50 [00:02<00:02,  9.72it/s] 46%|████▌     | 23/50 [00:02<00:02,  9.75it/s] 50%|█████     | 25/50 [00:02<00:02, 10.01it/s] 54%|█████▍    | 27/50 [00:02<00:02, 10.25it/s] 58%|█████▊    | 29/50 [00:03<00:02, 10.27it/s] 62%|██████▏   | 31/50 [00:03<00:02,  8.20it/s] 66%|██████▌   | 33/50 [00:03<00:02,  8.00it/s] 68%|██████▊   | 34/50 [00:03<00:01,  8.26it/s] 70%|███████   | 35/50 [00:04<00:02,  6.92it/s] 72%|███████▏  | 36/50 [00:04<00:01,  7.15it/s] 76%|███████▌  | 38/50 [00:04<00:02,  4.80it/s] 80%|████████  | 40/50 [00:04<00:01,  5.93it/s] 82%|████████▏ | 41/50 [00:05<00:01,  6.42it/s] 84%|████████▍ | 42/50 [00:05<00:01,  6.18it/s] 86%|████████▌ | 43/50 [00:05<00:01,  6.79it/s] 90%|█████████ | 45/50 [00:05<00:00,  7.97it/s] 94%|█████████▍| 47/50 [00:05<00:00,  8.85it/s] 96%|█████████▌| 48/50 [00:05<00:00,  8.76it/s] 98%|█████████▊| 49/50 [00:05<00:00,  8.75it/s]100%|██████████| 50/50 [00:06<00:00,  3.85it/s]100%|██████████| 50/50 [00:06<00:00,  7.44it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 51914
INFO:root:Parameters : 2136
INFO:root:Iterations : 101
INFO:root:Time : 3.203329086303711 [s]
INFO:root:Initial cost : 1.380899015868568 [px]
INFO:root:Final cost : 0.14791014978382946 [px]
INFO:root:Residuals : 51936
INFO:root:Parameters : 2136
INFO:root:Iterations : 101
INFO:root:Time : 2.4770350456237793 [s]
INFO:root:Initial cost : 1.2831357178710927 [px]
INFO:root:Final cost : 0.14316118202246847 [px]
INFO:root:Residuals : 52082
INFO:root:Parameters : 2142
INFO:root:Iterations : 101
INFO:root:Time : 2.1998941898345947 [s]
INFO:root:Initial cost : 1.2644974123612112 [px]
INFO:root:Final cost : 0.1481808599507203 [px]
INFO:root:Residuals : 51702
INFO:root:Parameters : 2133
INFO:root:Iterations : 101
INFO:root:Time : 2.1906378269195557 [s]
INFO:root:Initial cost : 1.2583890672584352 [px]
INFO:root:Final cost : 0.1547827134162316 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:15,  3.27it/s]  4%|▍         | 2/50 [00:00<00:11,  4.00it/s]  6%|▌         | 3/50 [00:00<00:10,  4.42it/s]  8%|▊         | 4/50 [00:00<00:10,  4.24it/s] 10%|█         | 5/50 [00:01<00:10,  4.45it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.69it/s] 14%|█▍        | 7/50 [00:01<00:08,  4.87it/s] 16%|█▌        | 8/50 [00:01<00:09,  4.59it/s] 18%|█▊        | 9/50 [00:01<00:08,  4.74it/s] 20%|██        | 10/50 [00:02<00:10,  3.75it/s] 22%|██▏       | 11/50 [00:02<00:09,  3.99it/s] 24%|██▍       | 12/50 [00:02<00:08,  4.30it/s] 26%|██▌       | 13/50 [00:02<00:08,  4.51it/s] 28%|██▊       | 14/50 [00:03<00:07,  4.66it/s] 30%|███       | 15/50 [00:03<00:07,  4.79it/s] 32%|███▏      | 16/50 [00:03<00:06,  4.90it/s] 34%|███▍      | 17/50 [00:03<00:08,  4.00it/s] 36%|███▌      | 18/50 [00:04<00:07,  4.22it/s] 38%|███▊      | 19/50 [00:04<00:07,  4.27it/s] 40%|████      | 20/50 [00:04<00:06,  4.45it/s] 42%|████▏     | 21/50 [00:04<00:06,  4.65it/s] 44%|████▍     | 22/50 [00:06<00:19,  1.46it/s] 46%|████▌     | 23/50 [00:06<00:14,  1.84it/s] 48%|████▊     | 24/50 [00:07<00:11,  2.18it/s] 50%|█████     | 25/50 [00:07<00:10,  2.38it/s] 52%|█████▏    | 26/50 [00:07<00:08,  2.68it/s] 54%|█████▍    | 27/50 [00:07<00:08,  2.76it/s] 56%|█████▌    | 28/50 [00:08<00:06,  3.19it/s] 58%|█████▊    | 29/50 [00:08<00:06,  3.34it/s] 60%|██████    | 30/50 [00:08<00:05,  3.70it/s] 62%|██████▏   | 31/50 [00:08<00:04,  3.85it/s] 64%|██████▍   | 32/50 [00:09<00:04,  4.18it/s] 66%|██████▌   | 33/50 [00:09<00:04,  3.81it/s] 68%|██████▊   | 34/50 [00:09<00:03,  4.04it/s] 70%|███████   | 35/50 [00:09<00:03,  4.16it/s] 72%|███████▏  | 36/50 [00:10<00:03,  4.21it/s] 74%|███████▍  | 37/50 [00:10<00:02,  4.44it/s] 76%|███████▌  | 38/50 [00:10<00:02,  4.61it/s] 78%|███████▊  | 39/50 [00:10<00:02,  4.80it/s] 80%|████████  | 40/50 [00:10<00:02,  4.14it/s] 82%|████████▏ | 41/50 [00:11<00:04,  2.23it/s] 84%|████████▍ | 42/50 [00:12<00:03,  2.55it/s] 86%|████████▌ | 43/50 [00:12<00:02,  3.00it/s] 88%|████████▊ | 44/50 [00:12<00:01,  3.46it/s] 90%|█████████ | 45/50 [00:12<00:01,  3.66it/s] 92%|█████████▏| 46/50 [00:12<00:01,  3.94it/s] 94%|█████████▍| 47/50 [00:13<00:00,  3.85it/s] 96%|█████████▌| 48/50 [00:13<00:00,  3.88it/s] 98%|█████████▊| 49/50 [00:13<00:00,  3.93it/s]100%|██████████| 50/50 [00:15<00:00,  1.56it/s]100%|██████████| 50/50 [00:15<00:00,  3.28it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_3.npz
metrics: {'epe3d_allo_image_all': 0.166228239685297, 'epe3d_allo_pixel_all': 0.16962065423997652, 'epe3d_sf_allo_image_all': 0.2052376426756382, 'epe3d_sf_allo_pixel_all': 0.2094261656482684, 'num_valid_pixels': 7938.0, 'delta_0.05': 0.16817838246409675, 'delta_0.1': 0.6570924666162762, 'delta_0.2': 0.8856135046611238, 'delta_0.4': 0.9690098261526833, 'outlier_0.15': 0.17321743512219703, 'delta_epe_0.1': 0.1744771982867221, 'delta_epe_0.3': 0.8344671201814059, 'delta_epe_0.5': 0.9599395313681028, 'delta_epe_1.0': 0.9957168052406148, 'outlier_epe_0.25': 0.25535399344923154}
Processing sequence: basketball_4.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:08,  5.89it/s]  4%|▍         | 2/50 [00:00<00:09,  5.15it/s]  6%|▌         | 3/50 [00:00<00:11,  4.20it/s]  8%|▊         | 4/50 [00:00<00:10,  4.32it/s] 10%|█         | 5/50 [00:01<00:09,  4.53it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.85it/s] 14%|█▍        | 7/50 [00:01<00:09,  4.62it/s] 16%|█▌        | 8/50 [00:01<00:08,  4.89it/s] 18%|█▊        | 9/50 [00:02<00:10,  4.01it/s] 20%|██        | 10/50 [00:02<00:09,  4.32it/s] 22%|██▏       | 11/50 [00:02<00:09,  4.28it/s] 24%|██▍       | 12/50 [00:02<00:08,  4.53it/s] 26%|██▌       | 13/50 [00:02<00:08,  4.30it/s] 28%|██▊       | 14/50 [00:03<00:07,  4.55it/s] 30%|███       | 15/50 [00:03<00:09,  3.67it/s] 32%|███▏      | 16/50 [00:03<00:08,  3.97it/s] 34%|███▍      | 17/50 [00:03<00:08,  4.09it/s] 36%|███▌      | 18/50 [00:04<00:07,  4.41it/s] 38%|███▊      | 19/50 [00:04<00:06,  4.45it/s] 40%|████      | 20/50 [00:04<00:06,  4.69it/s] 42%|████▏     | 21/50 [00:06<00:17,  1.67it/s] 44%|████▍     | 22/50 [00:06<00:14,  1.98it/s] 46%|████▌     | 23/50 [00:06<00:11,  2.41it/s] 48%|████▊     | 24/50 [00:06<00:09,  2.82it/s] 50%|█████     | 25/50 [00:06<00:07,  3.21it/s] 52%|█████▏    | 26/50 [00:07<00:06,  3.58it/s] 54%|█████▍    | 27/50 [00:07<00:05,  4.04it/s] 56%|█████▌    | 28/50 [00:07<00:05,  4.29it/s] 58%|█████▊    | 29/50 [00:09<00:14,  1.47it/s] 60%|██████    | 30/50 [00:09<00:11,  1.81it/s] 62%|██████▏   | 31/50 [00:09<00:08,  2.26it/s] 64%|██████▍   | 32/50 [00:09<00:06,  2.69it/s] 66%|██████▌   | 33/50 [00:10<00:06,  2.69it/s] 68%|██████▊   | 34/50 [00:10<00:05,  3.01it/s] 70%|███████   | 35/50 [00:10<00:04,  3.42it/s] 72%|███████▏  | 36/50 [00:10<00:03,  3.73it/s] 74%|███████▍  | 37/50 [00:11<00:03,  3.99it/s] 76%|███████▌  | 38/50 [00:11<00:02,  4.21it/s] 78%|███████▊  | 39/50 [00:11<00:02,  4.04it/s] 80%|████████  | 40/50 [00:11<00:02,  4.17it/s] 82%|████████▏ | 41/50 [00:12<00:02,  3.01it/s] 84%|████████▍ | 42/50 [00:13<00:03,  2.12it/s] 86%|████████▌ | 43/50 [00:13<00:02,  2.60it/s] 88%|████████▊ | 44/50 [00:13<00:02,  2.94it/s] 90%|█████████ | 45/50 [00:13<00:01,  3.38it/s] 92%|█████████▏| 46/50 [00:14<00:01,  3.61it/s] 94%|█████████▍| 47/50 [00:14<00:00,  3.81it/s] 96%|█████████▌| 48/50 [00:14<00:00,  3.78it/s] 98%|█████████▊| 49/50 [00:14<00:00,  3.93it/s]100%|██████████| 50/50 [00:14<00:00,  4.25it/s]100%|██████████| 50/50 [00:14<00:00,  3.35it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe89830ec00>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:20,  2.44it/s]  6%|▌         | 3/50 [00:00<00:08,  5.30it/s] 10%|█         | 5/50 [00:00<00:06,  7.04it/s] 12%|█▏        | 6/50 [00:00<00:05,  7.53it/s] 16%|█▌        | 8/50 [00:01<00:04,  8.48it/s] 18%|█▊        | 9/50 [00:01<00:04,  8.37it/s] 22%|██▏       | 11/50 [00:01<00:04,  9.17it/s] 26%|██▌       | 13/50 [00:01<00:05,  6.59it/s] 28%|██▊       | 14/50 [00:01<00:05,  7.06it/s] 32%|███▏      | 16/50 [00:02<00:04,  7.86it/s] 36%|███▌      | 18/50 [00:02<00:03,  8.71it/s] 38%|███▊      | 19/50 [00:02<00:03,  8.41it/s] 42%|████▏     | 21/50 [00:02<00:03,  9.42it/s] 44%|████▍     | 22/50 [00:02<00:03,  9.22it/s] 48%|████▊     | 24/50 [00:02<00:02, 10.22it/s] 52%|█████▏    | 26/50 [00:03<00:02,  9.49it/s] 54%|█████▍    | 27/50 [00:03<00:02,  9.48it/s] 56%|█████▌    | 28/50 [00:03<00:02,  7.89it/s] 58%|█████▊    | 29/50 [00:06<00:15,  1.38it/s] 60%|██████    | 30/50 [00:06<00:11,  1.76it/s] 62%|██████▏   | 31/50 [00:06<00:08,  2.26it/s] 64%|██████▍   | 32/50 [00:06<00:06,  2.85it/s] 66%|██████▌   | 33/50 [00:06<00:04,  3.54it/s] 70%|███████   | 35/50 [00:07<00:04,  3.31it/s] 74%|███████▍  | 37/50 [00:07<00:02,  4.50it/s] 78%|███████▊  | 39/50 [00:07<00:01,  5.64it/s] 80%|████████  | 40/50 [00:07<00:01,  6.17it/s] 82%|████████▏ | 41/50 [00:07<00:01,  6.60it/s] 84%|████████▍ | 42/50 [00:08<00:01,  5.83it/s] 86%|████████▌ | 43/50 [00:08<00:01,  6.33it/s] 88%|████████▊ | 44/50 [00:08<00:00,  6.91it/s] 92%|█████████▏| 46/50 [00:08<00:00,  8.19it/s] 94%|█████████▍| 47/50 [00:08<00:00,  8.33it/s] 98%|█████████▊| 49/50 [00:08<00:00,  8.96it/s]100%|██████████| 50/50 [00:08<00:00,  9.08it/s]100%|██████████| 50/50 [00:08<00:00,  5.59it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 68870
INFO:root:Parameters : 2484
INFO:root:Iterations : 101
INFO:root:Time : 4.3737828731536865 [s]
INFO:root:Initial cost : 1.1156020458039715 [px]
INFO:root:Final cost : 0.30772477131942355 [px]
INFO:root:Residuals : 68846
INFO:root:Parameters : 2481
INFO:root:Iterations : 101
INFO:root:Time : 3.982008934020996 [s]
INFO:root:Initial cost : 1.0794427590008788 [px]
INFO:root:Final cost : 0.38814956768607495 [px]
INFO:root:Residuals : 68648
INFO:root:Parameters : 2475
INFO:root:Iterations : 101
INFO:root:Time : 4.236432075500488 [s]
INFO:root:Initial cost : 0.9399332061550105 [px]
INFO:root:Final cost : 0.18007979010248681 [px]
INFO:root:Residuals : 68338
INFO:root:Parameters : 2466
INFO:root:Iterations : 101
INFO:root:Time : 4.868799924850464 [s]
INFO:root:Initial cost : 0.9424931378525188 [px]
INFO:root:Final cost : 0.18476717288880276 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:22,  2.16it/s]  4%|▍         | 2/50 [00:00<00:20,  2.36it/s]  6%|▌         | 3/50 [00:01<00:19,  2.46it/s]  8%|▊         | 4/50 [00:01<00:18,  2.45it/s] 10%|█         | 5/50 [00:01<00:17,  2.60it/s] 12%|█▏        | 6/50 [00:02<00:15,  2.85it/s] 14%|█▍        | 7/50 [00:02<00:15,  2.80it/s] 16%|█▌        | 8/50 [00:03<00:15,  2.80it/s] 18%|█▊        | 9/50 [00:03<00:15,  2.59it/s] 20%|██        | 10/50 [00:03<00:15,  2.54it/s] 22%|██▏       | 11/50 [00:04<00:15,  2.59it/s] 24%|██▍       | 12/50 [00:04<00:13,  2.76it/s] 26%|██▌       | 13/50 [00:05<00:14,  2.49it/s] 28%|██▊       | 14/50 [00:05<00:13,  2.58it/s] 30%|███       | 15/50 [00:05<00:12,  2.76it/s] 32%|███▏      | 16/50 [00:06<00:11,  2.84it/s] 34%|███▍      | 17/50 [00:06<00:11,  2.99it/s] 36%|███▌      | 18/50 [00:06<00:10,  3.03it/s] 38%|███▊      | 19/50 [00:07<00:10,  2.85it/s] 40%|████      | 20/50 [00:07<00:10,  2.94it/s] 42%|████▏     | 21/50 [00:07<00:09,  3.11it/s] 44%|████▍     | 22/50 [00:07<00:09,  3.09it/s] 46%|████▌     | 23/50 [00:08<00:08,  3.26it/s] 48%|████▊     | 24/50 [00:08<00:07,  3.52it/s] 50%|█████     | 25/50 [00:08<00:07,  3.46it/s] 52%|█████▏    | 26/50 [00:09<00:08,  2.68it/s] 54%|█████▍    | 27/50 [00:09<00:08,  2.82it/s] 56%|█████▌    | 28/50 [00:09<00:07,  2.96it/s] 58%|█████▊    | 29/50 [00:10<00:08,  2.49it/s] 60%|██████    | 30/50 [00:10<00:07,  2.65it/s] 62%|██████▏   | 31/50 [00:11<00:06,  3.12it/s] 64%|██████▍   | 32/50 [00:11<00:05,  3.50it/s] 66%|██████▌   | 33/50 [00:11<00:04,  3.90it/s] 68%|██████▊   | 34/50 [00:11<00:03,  4.23it/s] 70%|███████   | 35/50 [00:11<00:03,  4.50it/s] 72%|███████▏  | 36/50 [00:11<00:02,  4.68it/s] 74%|███████▍  | 37/50 [00:12<00:05,  2.30it/s] 76%|███████▌  | 38/50 [00:15<00:14,  1.17s/it] 78%|███████▊  | 39/50 [00:16<00:09,  1.11it/s] 80%|████████  | 40/50 [00:16<00:07,  1.35it/s] 82%|████████▏ | 41/50 [00:16<00:05,  1.65it/s] 84%|████████▍ | 42/50 [00:17<00:04,  1.65it/s] 86%|████████▌ | 43/50 [00:17<00:03,  1.92it/s] 88%|████████▊ | 44/50 [00:17<00:02,  2.18it/s] 90%|█████████ | 45/50 [00:18<00:02,  2.35it/s] 92%|█████████▏| 46/50 [00:18<00:01,  2.52it/s] 94%|█████████▍| 47/50 [00:19<00:01,  2.56it/s] 96%|█████████▌| 48/50 [00:19<00:00,  2.77it/s] 98%|█████████▊| 49/50 [00:19<00:00,  2.49it/s]100%|██████████| 50/50 [00:20<00:00,  2.64it/s]100%|██████████| 50/50 [00:20<00:00,  2.48it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_4.npz
metrics: {'epe3d_allo_image_all': 0.16325745090842247, 'epe3d_allo_pixel_all': 0.1665892345564706, 'epe3d_sf_allo_image_all': 0.16210693864151834, 'epe3d_sf_allo_pixel_all': 0.16541524543141833, 'num_valid_pixels': 2352.0, 'delta_0.05': 0.7427721088435374, 'delta_0.1': 0.9285714285714286, 'delta_0.2': 0.9872448979591837, 'delta_0.4': 0.9974489795918368, 'outlier_0.15': 0.02040816326530612, 'delta_epe_0.1': 0.5017006802721088, 'delta_epe_0.3': 0.8507653061224489, 'delta_epe_0.5': 0.935374149659864, 'delta_epe_1.0': 0.9982993197278912, 'outlier_epe_0.25': 0.19940476190476192}
Processing sequence: basketball_5.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:15,  3.21it/s]  4%|▍         | 2/50 [00:00<00:15,  3.06it/s]  6%|▌         | 3/50 [00:01<00:16,  2.94it/s]  8%|▊         | 4/50 [00:01<00:15,  3.03it/s] 10%|█         | 5/50 [00:01<00:15,  2.94it/s] 12%|█▏        | 6/50 [00:02<00:15,  2.77it/s] 14%|█▍        | 7/50 [00:02<00:15,  2.82it/s] 16%|█▌        | 8/50 [00:02<00:15,  2.79it/s] 18%|█▊        | 9/50 [00:03<00:15,  2.73it/s] 20%|██        | 10/50 [00:03<00:14,  2.84it/s] 22%|██▏       | 11/50 [00:03<00:13,  2.92it/s] 24%|██▍       | 12/50 [00:04<00:13,  2.90it/s] 26%|██▌       | 13/50 [00:05<00:21,  1.70it/s] 28%|██▊       | 14/50 [00:05<00:16,  2.15it/s] 30%|███       | 15/50 [00:05<00:14,  2.46it/s] 32%|███▏      | 16/50 [00:05<00:11,  2.93it/s] 34%|███▍      | 17/50 [00:06<00:10,  3.22it/s] 36%|███▌      | 18/50 [00:06<00:09,  3.50it/s] 38%|███▊      | 19/50 [00:07<00:13,  2.24it/s] 40%|████      | 20/50 [00:07<00:10,  2.73it/s] 42%|████▏     | 21/50 [00:07<00:10,  2.76it/s] 44%|████▍     | 22/50 [00:08<00:09,  2.94it/s] 46%|████▌     | 23/50 [00:08<00:07,  3.38it/s] 48%|████▊     | 24/50 [00:08<00:06,  3.84it/s] 50%|█████     | 25/50 [00:10<00:18,  1.37it/s] 52%|█████▏    | 26/50 [00:10<00:13,  1.75it/s] 54%|█████▍    | 27/50 [00:10<00:11,  2.07it/s] 56%|█████▌    | 28/50 [00:10<00:08,  2.54it/s] 58%|█████▊    | 29/50 [00:11<00:07,  2.84it/s] 60%|██████    | 30/50 [00:11<00:06,  3.31it/s] 62%|██████▏   | 31/50 [00:11<00:05,  3.53it/s] 64%|██████▍   | 32/50 [00:11<00:04,  3.92it/s] 66%|██████▌   | 33/50 [00:12<00:04,  3.77it/s] 68%|██████▊   | 34/50 [00:12<00:04,  3.86it/s] 70%|███████   | 35/50 [00:12<00:03,  4.27it/s] 72%|███████▏  | 36/50 [00:12<00:03,  4.08it/s] 74%|███████▍  | 37/50 [00:12<00:02,  4.43it/s] 76%|███████▌  | 38/50 [00:13<00:02,  4.24it/s] 78%|███████▊  | 39/50 [00:13<00:02,  4.58it/s] 80%|████████  | 40/50 [00:13<00:02,  4.45it/s] 82%|████████▏ | 41/50 [00:14<00:02,  3.39it/s] 84%|████████▍ | 42/50 [00:14<00:02,  3.53it/s] 86%|████████▌ | 43/50 [00:14<00:01,  3.96it/s] 88%|████████▊ | 44/50 [00:14<00:01,  3.89it/s] 90%|█████████ | 45/50 [00:14<00:01,  4.28it/s] 92%|█████████▏| 46/50 [00:15<00:00,  4.24it/s] 94%|█████████▍| 47/50 [00:15<00:00,  4.56it/s] 96%|█████████▌| 48/50 [00:15<00:00,  4.74it/s] 98%|█████████▊| 49/50 [00:15<00:00,  5.01it/s]100%|██████████| 50/50 [00:15<00:00,  5.15it/s]100%|██████████| 50/50 [00:15<00:00,  3.14it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe89867b6e0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:16,  2.99it/s]  6%|▌         | 3/50 [00:00<00:07,  6.38it/s] 10%|█         | 5/50 [00:00<00:05,  7.90it/s] 14%|█▍        | 7/50 [00:00<00:04,  8.66it/s] 18%|█▊        | 9/50 [00:01<00:07,  5.70it/s] 22%|██▏       | 11/50 [00:01<00:05,  6.71it/s] 26%|██▌       | 13/50 [00:03<00:17,  2.06it/s] 28%|██▊       | 14/50 [00:04<00:14,  2.43it/s] 30%|███       | 15/50 [00:04<00:12,  2.90it/s] 32%|███▏      | 16/50 [00:04<00:09,  3.47it/s] 34%|███▍      | 17/50 [00:04<00:08,  4.11it/s] 38%|███▊      | 19/50 [00:04<00:05,  5.52it/s] 40%|████      | 20/50 [00:04<00:04,  6.11it/s] 42%|████▏     | 21/50 [00:04<00:05,  5.71it/s] 44%|████▍     | 22/50 [00:05<00:04,  6.30it/s] 46%|████▌     | 23/50 [00:05<00:03,  6.84it/s] 48%|████▊     | 24/50 [00:05<00:04,  6.10it/s] 50%|█████     | 25/50 [00:06<00:09,  2.66it/s] 52%|█████▏    | 26/50 [00:06<00:07,  3.37it/s] 56%|█████▌    | 28/50 [00:06<00:04,  4.77it/s] 58%|█████▊    | 29/50 [00:06<00:03,  5.46it/s] 60%|██████    | 30/50 [00:08<00:10,  1.85it/s] 62%|██████▏   | 31/50 [00:08<00:08,  2.36it/s] 66%|██████▌   | 33/50 [00:08<00:04,  3.58it/s] 68%|██████▊   | 34/50 [00:09<00:05,  3.01it/s] 70%|███████   | 35/50 [00:09<00:04,  3.51it/s] 74%|███████▍  | 37/50 [00:09<00:03,  3.89it/s] 76%|███████▌  | 38/50 [00:09<00:02,  4.52it/s] 80%|████████  | 40/50 [00:09<00:01,  5.35it/s] 82%|████████▏ | 41/50 [00:10<00:01,  5.16it/s] 84%|████████▍ | 42/50 [00:10<00:01,  5.76it/s] 88%|████████▊ | 44/50 [00:10<00:00,  7.11it/s] 90%|█████████ | 45/50 [00:10<00:00,  7.43it/s] 92%|█████████▏| 46/50 [00:10<00:00,  7.66it/s] 94%|█████████▍| 47/50 [00:10<00:00,  7.56it/s] 98%|█████████▊| 49/50 [00:11<00:00,  8.43it/s]100%|██████████| 50/50 [00:11<00:00,  6.33it/s]100%|██████████| 50/50 [00:11<00:00,  4.38it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 67340
INFO:root:Parameters : 2445
INFO:root:Iterations : 101
INFO:root:Time : 3.988537073135376 [s]
INFO:root:Initial cost : 1.4164885948512278 [px]
INFO:root:Final cost : 0.13855123506993408 [px]
INFO:root:Residuals : 67044
INFO:root:Parameters : 2442
INFO:root:Iterations : 101
INFO:root:Time : 3.753145933151245 [s]
INFO:root:Initial cost : 1.2033917735204138 [px]
INFO:root:Final cost : 0.1335067949222087 [px]
INFO:root:Residuals : 67054
INFO:root:Parameters : 2442
INFO:root:Iterations : 101
INFO:root:Time : 2.7191660404205322 [s]
INFO:root:Initial cost : 1.179881371089143 [px]
INFO:root:Final cost : 0.1353329040481438 [px]
INFO:root:Residuals : 67020
INFO:root:Parameters : 2442
INFO:root:Iterations : 101
INFO:root:Time : 2.973215103149414 [s]
INFO:root:Initial cost : 1.1868445707809314 [px]
INFO:root:Final cost : 0.1396476432672035 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:34,  1.44it/s]  4%|▍         | 2/50 [00:00<00:20,  2.36it/s]  6%|▌         | 3/50 [00:01<00:15,  3.07it/s]  8%|▊         | 4/50 [00:01<00:13,  3.35it/s] 10%|█         | 5/50 [00:01<00:11,  3.83it/s] 12%|█▏        | 6/50 [00:01<00:10,  4.23it/s] 14%|█▍        | 7/50 [00:02<00:10,  4.15it/s] 16%|█▌        | 8/50 [00:02<00:10,  4.16it/s] 18%|█▊        | 9/50 [00:02<00:10,  4.04it/s] 20%|██        | 10/50 [00:02<00:09,  4.07it/s] 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s] 24%|██▍       | 12/50 [00:03<00:09,  4.12it/s] 26%|██▌       | 13/50 [00:04<00:19,  1.93it/s] 28%|██▊       | 14/50 [00:04<00:15,  2.37it/s] 30%|███       | 15/50 [00:05<00:14,  2.42it/s] 32%|███▏      | 16/50 [00:05<00:14,  2.38it/s] 34%|███▍      | 17/50 [00:05<00:11,  2.86it/s] 36%|███▌      | 18/50 [00:05<00:10,  3.17it/s] 38%|███▊      | 19/50 [00:06<00:09,  3.23it/s] 40%|████      | 20/50 [00:06<00:08,  3.50it/s] 42%|████▏     | 21/50 [00:06<00:07,  3.90it/s] 44%|████▍     | 22/50 [00:06<00:07,  3.63it/s] 46%|████▌     | 23/50 [00:07<00:07,  3.85it/s] 48%|████▊     | 24/50 [00:07<00:06,  4.08it/s] 50%|█████     | 25/50 [00:08<00:16,  1.51it/s] 52%|█████▏    | 26/50 [00:09<00:15,  1.53it/s] 54%|█████▍    | 27/50 [00:09<00:12,  1.85it/s] 56%|█████▌    | 28/50 [00:10<00:09,  2.24it/s] 58%|█████▊    | 29/50 [00:10<00:09,  2.17it/s] 60%|██████    | 30/50 [00:10<00:08,  2.50it/s] 62%|██████▏   | 31/50 [00:11<00:06,  2.90it/s] 64%|██████▍   | 32/50 [00:11<00:05,  3.27it/s] 66%|██████▌   | 33/50 [00:11<00:05,  3.30it/s] 68%|██████▊   | 34/50 [00:11<00:04,  3.42it/s] 70%|███████   | 35/50 [00:12<00:04,  3.02it/s] 72%|███████▏  | 36/50 [00:12<00:04,  3.30it/s] 74%|███████▍  | 37/50 [00:12<00:03,  3.66it/s] 76%|███████▌  | 38/50 [00:13<00:03,  3.37it/s] 78%|███████▊  | 39/50 [00:13<00:03,  3.63it/s] 80%|████████  | 40/50 [00:15<00:08,  1.20it/s] 82%|████████▏ | 41/50 [00:16<00:07,  1.26it/s] 84%|████████▍ | 42/50 [00:16<00:04,  1.62it/s] 86%|████████▌ | 43/50 [00:16<00:03,  1.90it/s] 88%|████████▊ | 44/50 [00:16<00:02,  2.34it/s] 90%|█████████ | 45/50 [00:17<00:01,  2.76it/s] 92%|█████████▏| 46/50 [00:17<00:01,  3.22it/s] 94%|█████████▍| 47/50 [00:17<00:01,  2.36it/s] 96%|█████████▌| 48/50 [00:18<00:00,  2.63it/s] 98%|█████████▊| 49/50 [00:18<00:00,  3.10it/s]100%|██████████| 50/50 [00:18<00:00,  3.50it/s]100%|██████████| 50/50 [00:18<00:00,  2.69it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_5.npz
metrics: {'epe3d_allo_image_all': 0.2643920770287514, 'epe3d_allo_pixel_all': 0.26978783389184596, 'epe3d_sf_allo_image_all': 0.1787898863852024, 'epe3d_sf_allo_pixel_all': 0.1824386589315407, 'num_valid_pixels': 3626.0, 'delta_0.05': 0.38968560397131824, 'delta_0.1': 0.7887479316050745, 'delta_0.2': 0.9553226696083839, 'delta_0.4': 0.9856591285162714, 'outlier_0.15': 0.07225592939878654, 'delta_epe_0.1': 0.3560397131825703, 'delta_epe_0.3': 0.8223938223938224, 'delta_epe_0.5': 0.9660783232211804, 'delta_epe_1.0': 0.9966905681191396, 'outlier_epe_0.25': 0.2410369553226696}
Processing sequence: basketball_6.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:08,  6.05it/s]  4%|▍         | 2/50 [00:00<00:15,  3.07it/s]  6%|▌         | 3/50 [00:00<00:12,  3.64it/s]  8%|▊         | 4/50 [00:01<00:10,  4.19it/s] 10%|█         | 5/50 [00:01<00:09,  4.65it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.64it/s] 14%|█▍        | 7/50 [00:03<00:31,  1.38it/s] 16%|█▌        | 8/50 [00:03<00:23,  1.81it/s] 18%|█▊        | 9/50 [00:03<00:18,  2.22it/s] 20%|██        | 10/50 [00:03<00:15,  2.56it/s] 22%|██▏       | 11/50 [00:04<00:15,  2.49it/s] 24%|██▍       | 12/50 [00:04<00:14,  2.55it/s] 26%|██▌       | 13/50 [00:04<00:12,  2.85it/s] 28%|██▊       | 14/50 [00:05<00:11,  3.17it/s] 30%|███       | 15/50 [00:05<00:10,  3.33it/s] 32%|███▏      | 16/50 [00:05<00:09,  3.52it/s] 34%|███▍      | 17/50 [00:05<00:08,  3.72it/s] 36%|███▌      | 18/50 [00:06<00:08,  3.78it/s] 38%|███▊      | 19/50 [00:06<00:07,  3.93it/s] 40%|████      | 20/50 [00:06<00:07,  3.87it/s] 42%|████▏     | 21/50 [00:07<00:12,  2.30it/s] 44%|████▍     | 22/50 [00:07<00:12,  2.23it/s] 46%|████▌     | 23/50 [00:08<00:11,  2.38it/s] 48%|████▊     | 24/50 [00:08<00:09,  2.77it/s] 50%|█████     | 25/50 [00:08<00:08,  3.10it/s] 52%|█████▏    | 26/50 [00:09<00:07,  3.09it/s] 54%|█████▍    | 27/50 [00:10<00:14,  1.55it/s] 56%|█████▌    | 28/50 [00:10<00:11,  1.96it/s] 58%|█████▊    | 29/50 [00:11<00:10,  2.08it/s] 60%|██████    | 30/50 [00:11<00:07,  2.57it/s] 62%|██████▏   | 31/50 [00:11<00:06,  3.07it/s] 64%|██████▍   | 32/50 [00:11<00:05,  3.57it/s] 66%|██████▌   | 33/50 [00:11<00:04,  3.92it/s] 68%|██████▊   | 34/50 [00:12<00:05,  3.06it/s] 70%|███████   | 35/50 [00:12<00:04,  3.56it/s] 72%|███████▏  | 36/50 [00:12<00:03,  3.55it/s] 74%|███████▍  | 37/50 [00:12<00:03,  3.98it/s] 76%|███████▌  | 38/50 [00:13<00:02,  4.36it/s] 78%|███████▊  | 39/50 [00:13<00:02,  4.62it/s] 80%|████████  | 40/50 [00:14<00:06,  1.58it/s] 82%|████████▏ | 41/50 [00:15<00:04,  2.00it/s] 84%|████████▍ | 42/50 [00:15<00:03,  2.48it/s] 86%|████████▌ | 43/50 [00:15<00:02,  2.97it/s] 88%|████████▊ | 44/50 [00:15<00:01,  3.45it/s] 90%|█████████ | 45/50 [00:15<00:01,  3.84it/s] 92%|█████████▏| 46/50 [00:17<00:02,  1.52it/s] 94%|█████████▍| 47/50 [00:17<00:01,  1.94it/s] 96%|█████████▌| 48/50 [00:17<00:00,  2.34it/s] 98%|█████████▊| 49/50 [00:18<00:00,  2.73it/s]100%|██████████| 50/50 [00:18<00:00,  3.20it/s]100%|██████████| 50/50 [00:18<00:00,  2.74it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe89867b9e0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:21,  2.28it/s]  4%|▍         | 2/50 [00:00<00:16,  2.84it/s]  6%|▌         | 3/50 [00:00<00:13,  3.58it/s]  8%|▊         | 4/50 [00:01<00:10,  4.20it/s] 12%|█▏        | 6/50 [00:01<00:07,  5.73it/s] 14%|█▍        | 7/50 [00:01<00:06,  6.29it/s] 16%|█▌        | 8/50 [00:01<00:06,  6.84it/s] 18%|█▊        | 9/50 [00:01<00:05,  7.42it/s] 20%|██        | 10/50 [00:01<00:06,  5.86it/s] 22%|██▏       | 11/50 [00:02<00:06,  6.41it/s] 24%|██▍       | 12/50 [00:02<00:05,  7.08it/s] 26%|██▌       | 13/50 [00:02<00:10,  3.67it/s] 28%|██▊       | 14/50 [00:02<00:08,  4.36it/s] 32%|███▏      | 16/50 [00:03<00:05,  5.99it/s] 36%|███▌      | 18/50 [00:03<00:04,  7.25it/s] 38%|███▊      | 19/50 [00:03<00:04,  7.41it/s] 40%|████      | 20/50 [00:03<00:03,  7.55it/s] 42%|████▏     | 21/50 [00:03<00:03,  7.99it/s] 44%|████▍     | 22/50 [00:03<00:04,  6.04it/s] 46%|████▌     | 23/50 [00:04<00:05,  5.36it/s] 48%|████▊     | 24/50 [00:04<00:04,  6.02it/s] 50%|█████     | 25/50 [00:04<00:03,  6.73it/s] 52%|█████▏    | 26/50 [00:04<00:04,  5.48it/s] 54%|█████▍    | 27/50 [00:04<00:03,  6.16it/s] 56%|█████▌    | 28/50 [00:04<00:03,  6.91it/s] 58%|█████▊    | 29/50 [00:04<00:02,  7.34it/s] 60%|██████    | 30/50 [00:05<00:02,  7.72it/s] 62%|██████▏   | 31/50 [00:05<00:02,  7.08it/s] 64%|██████▍   | 32/50 [00:05<00:04,  3.97it/s] 66%|██████▌   | 33/50 [00:06<00:05,  3.20it/s] 68%|██████▊   | 34/50 [00:06<00:04,  3.69it/s] 72%|███████▏  | 36/50 [00:06<00:02,  5.17it/s] 74%|███████▍  | 37/50 [00:06<00:02,  5.78it/s] 76%|███████▌  | 38/50 [00:06<00:02,  5.45it/s] 78%|███████▊  | 39/50 [00:06<00:01,  6.18it/s] 80%|████████  | 40/50 [00:07<00:01,  6.63it/s] 82%|████████▏ | 41/50 [00:07<00:01,  6.18it/s] 84%|████████▍ | 42/50 [00:07<00:01,  6.69it/s] 86%|████████▌ | 43/50 [00:07<00:00,  7.30it/s] 90%|█████████ | 45/50 [00:07<00:00,  8.50it/s] 92%|█████████▏| 46/50 [00:08<00:01,  3.93it/s] 94%|█████████▍| 47/50 [00:08<00:00,  4.62it/s] 96%|█████████▌| 48/50 [00:08<00:00,  5.24it/s] 98%|█████████▊| 49/50 [00:08<00:00,  5.98it/s]100%|██████████| 50/50 [00:08<00:00,  6.04it/s]100%|██████████| 50/50 [00:08<00:00,  5.59it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 70896
INFO:root:Parameters : 2502
INFO:root:Iterations : 101
INFO:root:Time : 3.0211260318756104 [s]
INFO:root:Initial cost : 1.1376180974985972 [px]
INFO:root:Final cost : 0.22690954799584934 [px]
INFO:root:Residuals : 71052
INFO:root:Parameters : 2496
INFO:root:Iterations : 101
INFO:root:Time : 3.0963430404663086 [s]
INFO:root:Initial cost : 0.9525601805570232 [px]
INFO:root:Final cost : 0.26863282816497264 [px]
INFO:root:Residuals : 71084
INFO:root:Parameters : 2490
INFO:root:Iterations : 101
INFO:root:Time : 2.9032089710235596 [s]
INFO:root:Initial cost : 0.879158324034879 [px]
INFO:root:Final cost : 0.16121924448625777 [px]
INFO:root:Residuals : 70566
INFO:root:Parameters : 2469
INFO:root:Iterations : 101
INFO:root:Time : 2.70832896232605 [s]
INFO:root:Initial cost : 0.8802653175226892 [px]
INFO:root:Final cost : 0.16211764242822602 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:12,  3.78it/s]  4%|▍         | 2/50 [00:02<00:55,  1.15s/it]  6%|▌         | 3/50 [00:02<00:36,  1.28it/s]  8%|▊         | 4/50 [00:02<00:24,  1.84it/s] 10%|█         | 5/50 [00:02<00:18,  2.43it/s] 12%|█▏        | 6/50 [00:02<00:14,  3.02it/s] 14%|█▍        | 7/50 [00:04<00:35,  1.22it/s] 16%|█▌        | 8/50 [00:05<00:27,  1.54it/s] 18%|█▊        | 9/50 [00:06<00:34,  1.18it/s] 20%|██        | 10/50 [00:06<00:26,  1.48it/s] 22%|██▏       | 11/50 [00:06<00:21,  1.82it/s] 24%|██▍       | 12/50 [00:07<00:17,  2.19it/s] 26%|██▌       | 13/50 [00:07<00:13,  2.68it/s] 28%|██▊       | 14/50 [00:07<00:11,  3.19it/s] 30%|███       | 15/50 [00:07<00:09,  3.68it/s] 32%|███▏      | 16/50 [00:08<00:13,  2.47it/s] 34%|███▍      | 17/50 [00:08<00:12,  2.72it/s] 36%|███▌      | 18/50 [00:08<00:09,  3.21it/s] 38%|███▊      | 19/50 [00:08<00:08,  3.67it/s] 40%|████      | 20/50 [00:09<00:07,  4.05it/s] 42%|████▏     | 21/50 [00:09<00:06,  4.36it/s] 44%|████▍     | 22/50 [00:09<00:06,  4.57it/s] 46%|████▌     | 23/50 [00:09<00:05,  4.68it/s] 48%|████▊     | 24/50 [00:09<00:05,  4.85it/s] 50%|█████     | 25/50 [00:10<00:05,  4.98it/s] 52%|█████▏    | 26/50 [00:10<00:04,  5.02it/s] 54%|█████▍    | 27/50 [00:10<00:04,  5.10it/s] 56%|█████▌    | 28/50 [00:10<00:04,  5.17it/s] 58%|█████▊    | 29/50 [00:10<00:04,  5.24it/s] 60%|██████    | 30/50 [00:12<00:11,  1.79it/s] 62%|██████▏   | 31/50 [00:12<00:08,  2.22it/s] 64%|██████▍   | 32/50 [00:12<00:07,  2.38it/s] 66%|██████▌   | 33/50 [00:13<00:06,  2.76it/s] 68%|██████▊   | 34/50 [00:13<00:04,  3.23it/s] 70%|███████   | 35/50 [00:13<00:04,  3.69it/s] 72%|███████▏  | 36/50 [00:13<00:03,  4.06it/s] 74%|███████▍  | 37/50 [00:13<00:02,  4.37it/s] 76%|███████▌  | 38/50 [00:14<00:02,  4.56it/s] 78%|███████▊  | 39/50 [00:15<00:05,  1.84it/s] 80%|████████  | 40/50 [00:15<00:04,  2.23it/s] 82%|████████▏ | 41/50 [00:15<00:03,  2.69it/s] 84%|████████▍ | 42/50 [00:15<00:02,  3.15it/s] 86%|████████▌ | 43/50 [00:16<00:02,  2.98it/s] 88%|████████▊ | 44/50 [00:16<00:02,  2.89it/s] 90%|█████████ | 45/50 [00:16<00:01,  3.34it/s] 92%|█████████▏| 46/50 [00:17<00:01,  2.25it/s] 94%|█████████▍| 47/50 [00:17<00:01,  2.62it/s] 96%|█████████▌| 48/50 [00:18<00:00,  2.50it/s] 98%|█████████▊| 49/50 [00:18<00:00,  2.55it/s]100%|██████████| 50/50 [00:19<00:00,  2.68it/s]100%|██████████| 50/50 [00:19<00:00,  2.63it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_6.npz
metrics: {'epe3d_allo_image_all': 0.25306858360767365, 'epe3d_allo_pixel_all': 0.2582332487819957, 'epe3d_sf_allo_image_all': 0.15252187676727771, 'epe3d_sf_allo_pixel_all': 0.15563456845932266, 'num_valid_pixels': 1176.0, 'delta_0.05': 0.1292517006802721, 'delta_0.1': 0.8494897959183674, 'delta_0.2': 0.9770408163265306, 'delta_0.4': 1.0, 'outlier_0.15': 0.061224489795918366, 'delta_epe_0.1': 0.3401360544217687, 'delta_epe_0.3': 0.8860544217687075, 'delta_epe_0.5': 0.9761904761904762, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.1649659863945578}
Processing sequence: basketball_7.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:13,  3.65it/s]  4%|▍         | 2/50 [00:00<00:12,  3.71it/s]  6%|▌         | 3/50 [00:00<00:13,  3.43it/s]  8%|▊         | 4/50 [00:01<00:20,  2.23it/s] 10%|█         | 5/50 [00:01<00:17,  2.58it/s] 12%|█▏        | 6/50 [00:02<00:14,  3.05it/s] 14%|█▍        | 7/50 [00:02<00:12,  3.37it/s] 16%|█▌        | 8/50 [00:02<00:16,  2.51it/s] 18%|█▊        | 9/50 [00:03<00:14,  2.79it/s] 20%|██        | 10/50 [00:03<00:13,  3.02it/s] 22%|██▏       | 11/50 [00:03<00:12,  3.23it/s] 24%|██▍       | 12/50 [00:04<00:11,  3.18it/s] 26%|██▌       | 13/50 [00:04<00:11,  3.33it/s] 28%|██▊       | 14/50 [00:04<00:11,  3.19it/s] 30%|███       | 15/50 [00:04<00:11,  3.10it/s] 32%|███▏      | 16/50 [00:05<00:11,  2.96it/s] 34%|███▍      | 17/50 [00:05<00:10,  3.17it/s] 36%|███▌      | 18/50 [00:06<00:11,  2.69it/s] 38%|███▊      | 19/50 [00:06<00:10,  2.95it/s] 40%|████      | 20/50 [00:06<00:09,  3.00it/s] 42%|████▏     | 21/50 [00:07<00:11,  2.63it/s] 44%|████▍     | 22/50 [00:07<00:10,  2.80it/s] 46%|████▌     | 23/50 [00:07<00:09,  2.85it/s] 48%|████▊     | 24/50 [00:08<00:08,  2.97it/s] 50%|█████     | 25/50 [00:08<00:08,  3.03it/s] 52%|█████▏    | 26/50 [00:08<00:07,  3.14it/s] 54%|█████▍    | 27/50 [00:09<00:07,  3.23it/s] 56%|█████▌    | 28/50 [00:09<00:07,  3.04it/s] 58%|█████▊    | 29/50 [00:09<00:06,  3.20it/s] 60%|██████    | 30/50 [00:09<00:06,  3.27it/s] 62%|██████▏   | 31/50 [00:10<00:06,  3.08it/s] 64%|██████▍   | 32/50 [00:10<00:06,  2.89it/s] 66%|██████▌   | 33/50 [00:10<00:05,  3.11it/s] 68%|██████▊   | 34/50 [00:11<00:04,  3.23it/s] 70%|███████   | 35/50 [00:11<00:04,  3.32it/s] 72%|███████▏  | 36/50 [00:11<00:04,  3.42it/s] 74%|███████▍  | 37/50 [00:12<00:03,  3.41it/s] 76%|███████▌  | 38/50 [00:12<00:03,  3.12it/s] 78%|███████▊  | 39/50 [00:12<00:04,  2.71it/s] 80%|████████  | 40/50 [00:13<00:03,  2.83it/s] 82%|████████▏ | 41/50 [00:13<00:03,  2.50it/s] 84%|████████▍ | 42/50 [00:14<00:03,  2.63it/s] 86%|████████▌ | 43/50 [00:14<00:02,  2.86it/s] 88%|████████▊ | 44/50 [00:14<00:02,  2.99it/s] 90%|█████████ | 45/50 [00:15<00:01,  3.00it/s] 92%|█████████▏| 46/50 [00:15<00:01,  3.13it/s] 94%|█████████▍| 47/50 [00:15<00:00,  3.16it/s] 96%|█████████▌| 48/50 [00:15<00:00,  3.12it/s] 98%|█████████▊| 49/50 [00:16<00:00,  3.09it/s]100%|██████████| 50/50 [00:17<00:00,  2.25it/s]100%|██████████| 50/50 [00:17<00:00,  2.94it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe8988b7d40>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:18,  2.60it/s]  6%|▌         | 3/50 [00:00<00:07,  6.00it/s]  8%|▊         | 4/50 [00:00<00:08,  5.72it/s] 10%|█         | 5/50 [00:00<00:07,  6.38it/s] 14%|█▍        | 7/50 [00:01<00:06,  6.56it/s] 18%|█▊        | 9/50 [00:01<00:05,  7.45it/s] 20%|██        | 10/50 [00:01<00:05,  7.81it/s] 22%|██▏       | 11/50 [00:01<00:04,  7.87it/s] 24%|██▍       | 12/50 [00:01<00:04,  8.12it/s] 26%|██▌       | 13/50 [00:02<00:07,  4.82it/s] 28%|██▊       | 14/50 [00:02<00:06,  5.44it/s] 30%|███       | 15/50 [00:02<00:05,  6.24it/s] 34%|███▍      | 17/50 [00:02<00:04,  7.57it/s] 36%|███▌      | 18/50 [00:02<00:04,  7.93it/s] 38%|███▊      | 19/50 [00:02<00:03,  8.33it/s] 40%|████      | 20/50 [00:02<00:03,  8.60it/s] 42%|████▏     | 21/50 [00:03<00:03,  8.44it/s] 44%|████▍     | 22/50 [00:03<00:03,  8.40it/s] 46%|████▌     | 23/50 [00:03<00:05,  4.70it/s] 48%|████▊     | 24/50 [00:03<00:04,  5.54it/s] 50%|█████     | 25/50 [00:03<00:04,  6.19it/s] 52%|█████▏    | 26/50 [00:03<00:03,  6.87it/s] 56%|█████▌    | 28/50 [00:04<00:02,  7.39it/s] 58%|█████▊    | 29/50 [00:04<00:02,  7.44it/s] 62%|██████▏   | 31/50 [00:04<00:02,  8.02it/s] 64%|██████▍   | 32/50 [00:04<00:02,  7.95it/s] 66%|██████▌   | 33/50 [00:05<00:03,  5.02it/s] 70%|███████   | 35/50 [00:05<00:02,  6.29it/s] 72%|███████▏  | 36/50 [00:05<00:02,  6.77it/s] 74%|███████▍  | 37/50 [00:05<00:01,  7.28it/s] 76%|███████▌  | 38/50 [00:06<00:04,  2.85it/s] 78%|███████▊  | 39/50 [00:06<00:03,  3.06it/s] 80%|████████  | 40/50 [00:06<00:02,  3.76it/s] 82%|████████▏ | 41/50 [00:06<00:01,  4.54it/s] 84%|████████▍ | 42/50 [00:07<00:01,  5.28it/s] 86%|████████▌ | 43/50 [00:07<00:01,  6.00it/s] 88%|████████▊ | 44/50 [00:07<00:00,  6.61it/s] 90%|█████████ | 45/50 [00:07<00:00,  7.11it/s] 92%|█████████▏| 46/50 [00:07<00:00,  5.77it/s] 94%|█████████▍| 47/50 [00:07<00:00,  6.55it/s] 96%|█████████▌| 48/50 [00:07<00:00,  7.21it/s] 98%|█████████▊| 49/50 [00:07<00:00,  7.69it/s]100%|██████████| 50/50 [00:08<00:00,  7.83it/s]100%|██████████| 50/50 [00:08<00:00,  6.15it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 71648
INFO:root:Parameters : 2511
INFO:root:Iterations : 101
INFO:root:Time : 3.1407551765441895 [s]
INFO:root:Initial cost : 0.9909610942781412 [px]
INFO:root:Final cost : 0.13914544410641577 [px]
INFO:root:Residuals : 71706
INFO:root:Parameters : 2511
INFO:root:Iterations : 101
INFO:root:Time : 2.741971969604492 [s]
INFO:root:Initial cost : 0.8632959177435799 [px]
INFO:root:Final cost : 0.1300288421502888 [px]
INFO:root:Residuals : 71820
INFO:root:Parameters : 2511
INFO:root:Iterations : 101
INFO:root:Time : 2.703376054763794 [s]
INFO:root:Initial cost : 0.8104913680715048 [px]
INFO:root:Final cost : 0.13147281808533107 [px]
INFO:root:Residuals : 71758
INFO:root:Parameters : 2508
INFO:root:Iterations : 101
INFO:root:Time : 2.748156785964966 [s]
INFO:root:Initial cost : 0.7999058479235113 [px]
INFO:root:Final cost : 0.1327118976890396 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:12,  3.80it/s]  4%|▍         | 2/50 [00:00<00:10,  4.43it/s]  6%|▌         | 3/50 [00:00<00:09,  4.84it/s]  8%|▊         | 4/50 [00:00<00:09,  5.10it/s] 10%|█         | 5/50 [00:01<00:08,  5.11it/s] 12%|█▏        | 6/50 [00:01<00:08,  5.16it/s] 14%|█▍        | 7/50 [00:01<00:08,  5.16it/s] 16%|█▌        | 8/50 [00:01<00:08,  5.17it/s] 18%|█▊        | 9/50 [00:01<00:07,  5.20it/s] 20%|██        | 10/50 [00:01<00:07,  5.27it/s] 22%|██▏       | 11/50 [00:02<00:07,  5.35it/s] 24%|██▍       | 12/50 [00:02<00:07,  5.40it/s] 26%|██▌       | 13/50 [00:02<00:06,  5.37it/s] 28%|██▊       | 14/50 [00:02<00:06,  5.40it/s] 30%|███       | 15/50 [00:02<00:06,  5.43it/s] 32%|███▏      | 16/50 [00:03<00:06,  5.47it/s] 34%|███▍      | 17/50 [00:03<00:06,  5.49it/s] 36%|███▌      | 18/50 [00:03<00:05,  5.49it/s] 38%|███▊      | 19/50 [00:03<00:06,  4.76it/s] 40%|████      | 20/50 [00:03<00:06,  4.32it/s] 42%|████▏     | 21/50 [00:04<00:07,  4.01it/s] 44%|████▍     | 22/50 [00:04<00:09,  3.11it/s] 46%|████▌     | 23/50 [00:05<00:08,  3.20it/s] 48%|████▊     | 24/50 [00:05<00:08,  3.25it/s] 50%|█████     | 25/50 [00:05<00:07,  3.35it/s] 52%|█████▏    | 26/50 [00:05<00:07,  3.36it/s] 54%|█████▍    | 27/50 [00:06<00:06,  3.47it/s] 56%|█████▌    | 28/50 [00:06<00:06,  3.56it/s] 58%|█████▊    | 29/50 [00:06<00:05,  3.65it/s] 60%|██████    | 30/50 [00:06<00:05,  3.64it/s] 62%|██████▏   | 31/50 [00:07<00:05,  3.76it/s] 64%|██████▍   | 32/50 [00:07<00:04,  3.75it/s] 66%|██████▌   | 33/50 [00:07<00:04,  3.73it/s] 68%|██████▊   | 34/50 [00:08<00:04,  3.79it/s] 70%|███████   | 35/50 [00:08<00:03,  3.88it/s] 72%|███████▏  | 36/50 [00:08<00:03,  3.55it/s] 74%|███████▍  | 37/50 [00:08<00:03,  3.57it/s] 76%|███████▌  | 38/50 [00:09<00:03,  3.64it/s] 78%|███████▊  | 39/50 [00:09<00:03,  3.36it/s] 80%|████████  | 40/50 [00:09<00:03,  2.95it/s] 82%|████████▏ | 41/50 [00:10<00:03,  2.33it/s] 84%|████████▍ | 42/50 [00:10<00:03,  2.47it/s] 86%|████████▌ | 43/50 [00:11<00:02,  2.78it/s] 88%|████████▊ | 44/50 [00:11<00:02,  2.96it/s] 90%|█████████ | 45/50 [00:11<00:01,  3.17it/s] 92%|█████████▏| 46/50 [00:11<00:01,  3.36it/s] 94%|█████████▍| 47/50 [00:12<00:00,  3.51it/s] 96%|█████████▌| 48/50 [00:12<00:00,  3.57it/s] 98%|█████████▊| 49/50 [00:12<00:00,  3.52it/s]100%|██████████| 50/50 [00:13<00:00,  2.97it/s]100%|██████████| 50/50 [00:13<00:00,  3.77it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_7.npz
metrics: {'epe3d_allo_image_all': 0.1969685038924217, 'epe3d_allo_pixel_all': 0.20098827122783317, 'epe3d_sf_allo_image_all': 0.14426945470273494, 'epe3d_sf_allo_pixel_all': 0.14721373041995575, 'num_valid_pixels': 3332.0, 'delta_0.05': 0.842436974789916, 'delta_0.1': 0.9324729891956782, 'delta_0.2': 0.9366746698679472, 'delta_0.4': 0.987094837935174, 'outlier_0.15': 0.06422569027611044, 'delta_epe_0.1': 0.563625450180072, 'delta_epe_0.3': 0.9162665066026411, 'delta_epe_0.5': 0.9645858343337335, 'delta_epe_1.0': 0.9864945978391356, 'outlier_epe_0.25': 0.1362545018007203}
Processing sequence: basketball_9.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:09,  5.20it/s]  4%|▍         | 2/50 [00:00<00:09,  4.96it/s]  6%|▌         | 3/50 [00:00<00:10,  4.63it/s]  8%|▊         | 4/50 [00:01<00:13,  3.48it/s] 10%|█         | 5/50 [00:01<00:12,  3.47it/s] 12%|█▏        | 6/50 [00:01<00:12,  3.41it/s] 14%|█▍        | 7/50 [00:01<00:10,  3.93it/s] 16%|█▌        | 8/50 [00:02<00:14,  2.81it/s] 18%|█▊        | 9/50 [00:02<00:12,  3.34it/s] 20%|██        | 10/50 [00:02<00:10,  3.80it/s] 22%|██▏       | 11/50 [00:02<00:09,  4.21it/s] 24%|██▍       | 12/50 [00:03<00:09,  4.18it/s] 26%|██▌       | 13/50 [00:03<00:08,  4.44it/s] 28%|██▊       | 14/50 [00:03<00:07,  4.52it/s] 30%|███       | 15/50 [00:03<00:07,  4.72it/s] 32%|███▏      | 16/50 [00:04<00:08,  4.03it/s] 34%|███▍      | 17/50 [00:04<00:13,  2.43it/s] 36%|███▌      | 18/50 [00:05<00:10,  2.92it/s] 38%|███▊      | 19/50 [00:05<00:10,  2.86it/s] 40%|████      | 20/50 [00:05<00:09,  3.02it/s] 42%|████▏     | 21/50 [00:05<00:08,  3.49it/s] 44%|████▍     | 22/50 [00:06<00:07,  3.83it/s] 46%|████▌     | 23/50 [00:06<00:06,  4.17it/s] 48%|████▊     | 24/50 [00:06<00:05,  4.49it/s] 50%|█████     | 25/50 [00:06<00:05,  4.74it/s] 52%|█████▏    | 26/50 [00:06<00:04,  4.95it/s] 54%|█████▍    | 27/50 [00:07<00:04,  5.13it/s] 56%|█████▌    | 28/50 [00:07<00:04,  5.24it/s] 58%|█████▊    | 29/50 [00:07<00:05,  3.94it/s] 60%|██████    | 30/50 [00:07<00:05,  3.78it/s] 62%|██████▏   | 31/50 [00:08<00:06,  3.02it/s] 64%|██████▍   | 32/50 [00:08<00:05,  3.03it/s] 66%|██████▌   | 33/50 [00:09<00:07,  2.41it/s] 68%|██████▊   | 34/50 [00:09<00:06,  2.64it/s] 70%|███████   | 35/50 [00:09<00:05,  2.70it/s] 72%|███████▏  | 36/50 [00:10<00:04,  2.90it/s] 74%|███████▍  | 37/50 [00:10<00:04,  3.09it/s] 76%|███████▌  | 38/50 [00:10<00:03,  3.45it/s] 78%|███████▊  | 39/50 [00:11<00:06,  1.74it/s] 80%|████████  | 40/50 [00:15<00:13,  1.38s/it] 82%|████████▏ | 41/50 [00:17<00:13,  1.55s/it] 84%|████████▍ | 42/50 [00:18<00:12,  1.57s/it] 86%|████████▌ | 43/50 [00:20<00:12,  1.72s/it] 88%|████████▊ | 44/50 [00:22<00:10,  1.79s/it] 90%|█████████ | 45/50 [00:26<00:12,  2.48s/it] 92%|█████████▏| 46/50 [00:28<00:09,  2.36s/it] 94%|█████████▍| 47/50 [00:30<00:06,  2.25s/it] 96%|█████████▌| 48/50 [00:33<00:04,  2.20s/it] 98%|█████████▊| 49/50 [00:33<00:01,  1.65s/it]100%|██████████| 50/50 [00:33<00:00,  1.26s/it]100%|██████████| 50/50 [00:33<00:00,  1.48it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe23e1a7620>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<01:58,  2.42s/it]  4%|▍         | 2/50 [00:04<01:45,  2.20s/it]  6%|▌         | 3/50 [00:06<01:39,  2.11s/it]  8%|▊         | 4/50 [00:06<01:01,  1.33s/it] 10%|█         | 5/50 [00:08<01:10,  1.57s/it] 12%|█▏        | 6/50 [00:10<01:15,  1.72s/it] 14%|█▍        | 7/50 [00:12<01:19,  1.84s/it] 16%|█▌        | 8/50 [00:14<01:19,  1.90s/it] 18%|█▊        | 9/50 [00:16<01:20,  1.95s/it] 20%|██        | 10/50 [00:18<01:18,  1.97s/it] 22%|██▏       | 11/50 [00:20<01:17,  1.98s/it] 24%|██▍       | 12/50 [00:21<00:54,  1.44s/it] 26%|██▌       | 13/50 [00:21<00:38,  1.03s/it] 28%|██▊       | 14/50 [00:21<00:26,  1.33it/s] 30%|███       | 15/50 [00:21<00:19,  1.80it/s] 32%|███▏      | 16/50 [00:21<00:14,  2.39it/s] 34%|███▍      | 17/50 [00:21<00:10,  3.09it/s] 38%|███▊      | 19/50 [00:22<00:09,  3.20it/s] 42%|████▏     | 21/50 [00:22<00:06,  4.41it/s] 46%|████▌     | 23/50 [00:22<00:04,  5.60it/s] 48%|████▊     | 24/50 [00:22<00:04,  6.15it/s] 50%|█████     | 25/50 [00:22<00:03,  6.71it/s] 52%|█████▏    | 26/50 [00:22<00:03,  7.18it/s] 56%|█████▌    | 28/50 [00:23<00:02,  8.19it/s] 58%|█████▊    | 29/50 [00:23<00:02,  8.00it/s] 60%|██████    | 30/50 [00:23<00:02,  8.32it/s] 62%|██████▏   | 31/50 [00:23<00:02,  8.66it/s] 64%|██████▍   | 32/50 [00:23<00:02,  8.94it/s] 66%|██████▌   | 33/50 [00:23<00:03,  5.23it/s] 68%|██████▊   | 34/50 [00:25<00:08,  1.89it/s] 70%|███████   | 35/50 [00:25<00:06,  2.45it/s] 74%|███████▍  | 37/50 [00:25<00:03,  3.76it/s] 78%|███████▊  | 39/50 [00:25<00:02,  5.04it/s] 82%|████████▏ | 41/50 [00:25<00:01,  6.06it/s] 86%|████████▌ | 43/50 [00:26<00:01,  6.87it/s] 88%|████████▊ | 44/50 [00:26<00:00,  7.21it/s] 90%|█████████ | 45/50 [00:26<00:00,  7.64it/s] 92%|█████████▏| 46/50 [00:26<00:00,  8.08it/s] 94%|█████████▍| 47/50 [00:26<00:00,  8.40it/s] 96%|█████████▌| 48/50 [00:26<00:00,  8.47it/s]100%|██████████| 50/50 [00:26<00:00,  9.21it/s]100%|██████████| 50/50 [00:26<00:00,  1.86it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 64592
INFO:root:Parameters : 2364
INFO:root:Iterations : 101
INFO:root:Time : 2.757944107055664 [s]
INFO:root:Initial cost : 0.9721240291280646 [px]
INFO:root:Final cost : 0.15451769733734513 [px]
INFO:root:Residuals : 64614
INFO:root:Parameters : 2367
INFO:root:Iterations : 101
INFO:root:Time : 2.55715012550354 [s]
INFO:root:Initial cost : 0.7828260270020452 [px]
INFO:root:Final cost : 0.17130616629678305 [px]
INFO:root:Residuals : 64574
INFO:root:Parameters : 2367
INFO:root:Iterations : 101
INFO:root:Time : 2.4681479930877686 [s]
INFO:root:Initial cost : 0.7806013167811401 [px]
INFO:root:Final cost : 0.17383622625114062 [px]
INFO:root:Residuals : 64566
INFO:root:Parameters : 2364
INFO:root:Iterations : 101
INFO:root:Time : 3.115931987762451 [s]
INFO:root:Initial cost : 0.7992572665024257 [px]
INFO:root:Final cost : 0.17757640453184292 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:32,  1.89s/it]  4%|▍         | 2/50 [00:03<01:16,  1.60s/it]  6%|▌         | 3/50 [00:05<01:19,  1.69s/it]  8%|▊         | 4/50 [00:06<01:11,  1.55s/it] 10%|█         | 5/50 [00:08<01:15,  1.68s/it] 12%|█▏        | 6/50 [00:10<01:18,  1.79s/it] 14%|█▍        | 7/50 [00:14<01:50,  2.57s/it] 16%|█▌        | 8/50 [00:16<01:37,  2.32s/it] 18%|█▊        | 9/50 [00:18<01:30,  2.21s/it] 20%|██        | 10/50 [00:20<01:28,  2.21s/it] 22%|██▏       | 11/50 [00:22<01:21,  2.09s/it] 24%|██▍       | 12/50 [00:24<01:18,  2.08s/it] 26%|██▌       | 13/50 [00:26<01:18,  2.11s/it] 28%|██▊       | 14/50 [00:28<01:13,  2.03s/it] 30%|███       | 15/50 [00:30<01:11,  2.03s/it] 32%|███▏      | 16/50 [00:32<01:12,  2.14s/it] 34%|███▍      | 17/50 [00:34<01:05,  1.99s/it] 36%|███▌      | 18/50 [00:34<00:46,  1.45s/it] 38%|███▊      | 19/50 [00:34<00:33,  1.07s/it] 40%|████      | 20/50 [00:35<00:29,  1.02it/s] 42%|████▏     | 21/50 [00:36<00:29,  1.01s/it] 44%|████▍     | 22/50 [00:36<00:21,  1.31it/s] 46%|████▌     | 23/50 [00:38<00:28,  1.07s/it] 48%|████▊     | 24/50 [00:40<00:34,  1.34s/it] 50%|█████     | 25/50 [00:42<00:38,  1.53s/it] 52%|█████▏    | 26/50 [00:42<00:27,  1.13s/it] 54%|█████▍    | 27/50 [00:42<00:19,  1.19it/s] 56%|█████▌    | 28/50 [00:43<00:14,  1.56it/s] 58%|█████▊    | 29/50 [00:43<00:10,  1.98it/s] 60%|██████    | 30/50 [00:43<00:08,  2.33it/s] 62%|██████▏   | 31/50 [00:43<00:06,  2.81it/s] 64%|██████▍   | 32/50 [00:43<00:05,  3.31it/s] 66%|██████▌   | 33/50 [00:44<00:04,  3.76it/s] 68%|██████▊   | 34/50 [00:44<00:03,  4.17it/s] 70%|███████   | 35/50 [00:44<00:03,  4.51it/s] 72%|███████▏  | 36/50 [00:44<00:02,  4.76it/s] 74%|███████▍  | 37/50 [00:44<00:02,  5.00it/s] 76%|███████▌  | 38/50 [00:46<00:08,  1.50it/s] 78%|███████▊  | 39/50 [00:46<00:05,  1.92it/s] 80%|████████  | 40/50 [00:46<00:04,  2.39it/s] 82%|████████▏ | 41/50 [00:47<00:03,  2.88it/s] 84%|████████▍ | 42/50 [00:47<00:02,  3.25it/s] 86%|████████▌ | 43/50 [00:47<00:01,  3.70it/s] 88%|████████▊ | 44/50 [00:47<00:01,  4.12it/s] 90%|█████████ | 45/50 [00:48<00:02,  2.28it/s] 92%|█████████▏| 46/50 [00:48<00:01,  2.76it/s] 94%|█████████▍| 47/50 [00:48<00:00,  3.22it/s] 96%|█████████▌| 48/50 [00:49<00:00,  3.64it/s] 98%|█████████▊| 49/50 [00:49<00:00,  3.81it/s]100%|██████████| 50/50 [00:49<00:00,  4.11it/s]100%|██████████| 50/50 [00:49<00:00,  1.01it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_9.npz
metrics: {'epe3d_allo_image_all': 0.4656509619951248, 'epe3d_allo_pixel_all': 0.4751540446195568, 'epe3d_sf_allo_image_all': 0.2812229079008102, 'epe3d_sf_allo_pixel_all': 0.2869621514987831, 'num_valid_pixels': 4165.0, 'delta_0.05': 0.013205282112845138, 'delta_0.1': 0.0921968787515006, 'delta_0.2': 0.5234093637454982, 'delta_0.4': 0.973109243697479, 'outlier_0.15': 0.6518607442977191, 'delta_epe_0.1': 0.06722689075630252, 'delta_epe_0.3': 0.6232893157262905, 'delta_epe_0.5': 0.9279711884753902, 'delta_epe_1.0': 0.9959183673469387, 'outlier_epe_0.25': 0.539015606242497}
Processing sequence: basketball_11.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:07,  6.14it/s]  4%|▍         | 2/50 [00:01<00:32,  1.50it/s]  6%|▌         | 3/50 [00:01<00:21,  2.21it/s]  8%|▊         | 4/50 [00:01<00:16,  2.79it/s] 10%|█         | 5/50 [00:01<00:13,  3.44it/s] 12%|█▏        | 6/50 [00:01<00:11,  3.97it/s] 14%|█▍        | 7/50 [00:02<00:09,  4.44it/s] 16%|█▌        | 8/50 [00:02<00:08,  4.86it/s] 18%|█▊        | 9/50 [00:02<00:07,  5.15it/s] 20%|██        | 10/50 [00:02<00:07,  5.41it/s] 22%|██▏       | 11/50 [00:02<00:06,  5.59it/s] 24%|██▍       | 12/50 [00:03<00:12,  3.15it/s] 26%|██▌       | 13/50 [00:03<00:10,  3.68it/s] 28%|██▊       | 14/50 [00:03<00:08,  4.16it/s] 30%|███       | 15/50 [00:03<00:07,  4.60it/s] 32%|███▏      | 16/50 [00:04<00:06,  4.95it/s] 34%|███▍      | 17/50 [00:04<00:08,  3.94it/s] 36%|███▌      | 18/50 [00:04<00:07,  4.13it/s] 38%|███▊      | 19/50 [00:04<00:06,  4.56it/s] 40%|████      | 20/50 [00:04<00:06,  4.93it/s] 42%|████▏     | 21/50 [00:05<00:05,  5.17it/s] 44%|████▍     | 22/50 [00:05<00:05,  5.03it/s] 46%|████▌     | 23/50 [00:05<00:06,  4.06it/s] 48%|████▊     | 24/50 [00:05<00:06,  4.33it/s] 50%|█████     | 25/50 [00:06<00:05,  4.73it/s] 52%|█████▏    | 26/50 [00:06<00:04,  5.05it/s] 54%|█████▍    | 27/50 [00:06<00:04,  5.28it/s] 56%|█████▌    | 28/50 [00:06<00:04,  5.48it/s] 58%|█████▊    | 29/50 [00:06<00:03,  5.64it/s] 60%|██████    | 30/50 [00:07<00:04,  4.93it/s] 62%|██████▏   | 31/50 [00:07<00:03,  4.85it/s] 64%|██████▍   | 32/50 [00:07<00:03,  4.98it/s] 66%|██████▌   | 33/50 [00:07<00:03,  4.55it/s] 68%|██████▊   | 34/50 [00:07<00:03,  4.90it/s] 70%|███████   | 35/50 [00:08<00:04,  3.42it/s] 72%|███████▏  | 36/50 [00:08<00:04,  3.38it/s] 74%|███████▍  | 37/50 [00:08<00:03,  3.79it/s] 76%|███████▌  | 38/50 [00:10<00:08,  1.41it/s] 78%|███████▊  | 39/50 [00:10<00:06,  1.82it/s] 80%|████████  | 40/50 [00:11<00:04,  2.20it/s] 82%|████████▏ | 41/50 [00:11<00:03,  2.57it/s] 84%|████████▍ | 42/50 [00:11<00:02,  2.97it/s] 86%|████████▌ | 43/50 [00:11<00:02,  2.83it/s] 88%|████████▊ | 44/50 [00:12<00:01,  3.36it/s] 90%|█████████ | 45/50 [00:12<00:01,  3.87it/s] 92%|█████████▏| 46/50 [00:12<00:00,  4.26it/s] 94%|█████████▍| 47/50 [00:12<00:00,  4.40it/s] 96%|█████████▌| 48/50 [00:12<00:00,  4.79it/s] 98%|█████████▊| 49/50 [00:12<00:00,  5.03it/s]100%|██████████| 50/50 [00:13<00:00,  5.23it/s]100%|██████████| 50/50 [00:13<00:00,  3.82it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe89851dd90>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:16,  2.99it/s]  4%|▍         | 2/50 [00:00<00:11,  4.16it/s]  8%|▊         | 4/50 [00:00<00:06,  6.84it/s] 12%|█▏        | 6/50 [00:00<00:05,  8.35it/s] 14%|█▍        | 7/50 [00:01<00:06,  6.56it/s] 18%|█▊        | 9/50 [00:01<00:05,  7.97it/s] 22%|██▏       | 11/50 [00:01<00:04,  8.93it/s] 26%|██▌       | 13/50 [00:01<00:03,  9.61it/s] 30%|███       | 15/50 [00:02<00:04,  7.12it/s] 32%|███▏      | 16/50 [00:03<00:13,  2.54it/s] 34%|███▍      | 17/50 [00:03<00:10,  3.01it/s] 36%|███▌      | 18/50 [00:03<00:09,  3.29it/s] 38%|███▊      | 19/50 [00:04<00:09,  3.33it/s] 42%|████▏     | 21/50 [00:04<00:06,  4.73it/s] 44%|████▍     | 22/50 [00:05<00:13,  2.11it/s] 48%|████▊     | 24/50 [00:05<00:08,  3.11it/s] 50%|█████     | 25/50 [00:05<00:07,  3.55it/s] 52%|█████▏    | 26/50 [00:06<00:05,  4.01it/s] 56%|█████▌    | 28/50 [00:06<00:04,  5.00it/s] 60%|██████    | 30/50 [00:06<00:03,  6.25it/s] 64%|██████▍   | 32/50 [00:06<00:02,  7.37it/s] 68%|██████▊   | 34/50 [00:07<00:02,  5.56it/s] 70%|███████   | 35/50 [00:10<00:11,  1.32it/s] 74%|███████▍  | 37/50 [00:10<00:06,  1.91it/s] 78%|███████▊  | 39/50 [00:12<00:06,  1.58it/s] 82%|████████▏ | 41/50 [00:12<00:04,  2.06it/s] 86%|████████▌ | 43/50 [00:12<00:02,  2.78it/s] 90%|█████████ | 45/50 [00:13<00:01,  3.63it/s] 94%|█████████▍| 47/50 [00:13<00:00,  4.60it/s] 98%|█████████▊| 49/50 [00:13<00:00,  5.61it/s]100%|██████████| 50/50 [00:13<00:00,  3.67it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 63242
INFO:root:Parameters : 2400
INFO:root:Iterations : 101
INFO:root:Time : 2.419814109802246 [s]
INFO:root:Initial cost : 1.5326146354043138 [px]
INFO:root:Final cost : 0.18010078899932316 [px]
INFO:root:Residuals : 63602
INFO:root:Parameters : 2415
INFO:root:Iterations : 101
INFO:root:Time : 2.4123380184173584 [s]
INFO:root:Initial cost : 1.357654064437371 [px]
INFO:root:Final cost : 0.1730303100155357 [px]
INFO:root:Residuals : 63638
INFO:root:Parameters : 2412
INFO:root:Iterations : 101
INFO:root:Time : 2.475269079208374 [s]
INFO:root:Initial cost : 1.3174393763036154 [px]
INFO:root:Final cost : 0.1710043421330686 [px]
INFO:root:Residuals : 61048
INFO:root:Parameters : 2331
INFO:root:Iterations : 101
INFO:root:Time : 2.3608100414276123 [s]
INFO:root:Initial cost : 1.27468041993821 [px]
INFO:root:Final cost : 0.1709379562716596 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:28,  1.75it/s]  4%|▍         | 2/50 [00:00<00:18,  2.64it/s]  6%|▌         | 3/50 [00:01<00:18,  2.48it/s]  8%|▊         | 4/50 [00:01<00:15,  3.01it/s] 10%|█         | 5/50 [00:01<00:12,  3.60it/s] 12%|█▏        | 6/50 [00:01<00:10,  4.06it/s] 14%|█▍        | 7/50 [00:02<00:10,  4.03it/s] 16%|█▌        | 8/50 [00:02<00:09,  4.38it/s] 18%|█▊        | 9/50 [00:02<00:12,  3.22it/s] 20%|██        | 10/50 [00:02<00:11,  3.59it/s] 22%|██▏       | 11/50 [00:03<00:09,  4.03it/s] 24%|██▍       | 12/50 [00:03<00:08,  4.37it/s] 26%|██▌       | 13/50 [00:03<00:08,  4.16it/s] 28%|██▊       | 14/50 [00:04<00:12,  2.96it/s] 30%|███       | 15/50 [00:05<00:23,  1.48it/s] 32%|███▏      | 16/50 [00:05<00:18,  1.86it/s] 34%|███▍      | 17/50 [00:06<00:18,  1.77it/s] 36%|███▌      | 18/50 [00:07<00:20,  1.57it/s] 38%|███▊      | 19/50 [00:07<00:15,  2.00it/s] 40%|████      | 20/50 [00:07<00:12,  2.46it/s] 42%|████▏     | 21/50 [00:07<00:09,  2.95it/s] 44%|████▍     | 22/50 [00:09<00:21,  1.30it/s] 46%|████▌     | 23/50 [00:09<00:16,  1.68it/s] 48%|████▊     | 24/50 [00:09<00:12,  2.12it/s] 50%|█████     | 25/50 [00:10<00:09,  2.60it/s] 52%|█████▏    | 26/50 [00:10<00:07,  3.08it/s] 54%|█████▍    | 27/50 [00:10<00:06,  3.51it/s] 56%|█████▌    | 28/50 [00:12<00:15,  1.39it/s] 58%|█████▊    | 29/50 [00:12<00:11,  1.78it/s] 60%|██████    | 30/50 [00:12<00:08,  2.22it/s] 62%|██████▏   | 31/50 [00:12<00:07,  2.70it/s] 64%|██████▍   | 32/50 [00:13<00:05,  3.18it/s] 66%|██████▌   | 33/50 [00:13<00:05,  3.08it/s] 68%|██████▊   | 34/50 [00:13<00:05,  2.77it/s] 70%|███████   | 35/50 [00:16<00:16,  1.09s/it] 72%|███████▏  | 36/50 [00:16<00:11,  1.22it/s] 74%|███████▍  | 37/50 [00:17<00:08,  1.50it/s] 76%|███████▌  | 38/50 [00:17<00:07,  1.62it/s] 78%|███████▊  | 39/50 [00:18<00:08,  1.36it/s] 80%|████████  | 40/50 [00:19<00:06,  1.49it/s] 82%|████████▏ | 41/50 [00:19<00:05,  1.65it/s] 84%|████████▍ | 42/50 [00:20<00:04,  1.77it/s] 86%|████████▌ | 43/50 [00:20<00:03,  1.91it/s] 88%|████████▊ | 44/50 [00:20<00:02,  2.36it/s] 90%|█████████ | 45/50 [00:21<00:03,  1.58it/s] 92%|█████████▏| 46/50 [00:22<00:02,  1.94it/s] 94%|█████████▍| 47/50 [00:22<00:01,  2.40it/s] 96%|█████████▌| 48/50 [00:22<00:00,  2.87it/s] 98%|█████████▊| 49/50 [00:22<00:00,  3.08it/s]100%|██████████| 50/50 [00:22<00:00,  3.54it/s]100%|██████████| 50/50 [00:22<00:00,  2.19it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_11.npz
metrics: {'epe3d_allo_image_all': 0.22426247641444205, 'epe3d_allo_pixel_all': 0.2288392603523206, 'epe3d_sf_allo_image_all': 0.24577589452266693, 'epe3d_sf_allo_pixel_all': 0.2507917287062793, 'num_valid_pixels': 2842.0, 'delta_0.05': 0.42997888810696694, 'delta_0.1': 0.729064039408867, 'delta_0.2': 0.9778325123152709, 'delta_0.4': 0.9985925404644617, 'outlier_0.15': 0.07705840957072484, 'delta_epe_0.1': 0.16326530612244897, 'delta_epe_0.3': 0.6924700914848698, 'delta_epe_0.5': 0.9415904292751583, 'delta_epe_1.0': 0.9985925404644617, 'outlier_epe_0.25': 0.40182969739619984}
Processing sequence: basketball_12.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:08,  5.54it/s]  4%|▍         | 2/50 [00:00<00:08,  5.57it/s]  6%|▌         | 3/50 [00:00<00:08,  5.39it/s]  8%|▊         | 4/50 [00:00<00:08,  5.52it/s] 10%|█         | 5/50 [00:00<00:08,  5.49it/s] 12%|█▏        | 6/50 [00:01<00:07,  5.54it/s] 14%|█▍        | 7/50 [00:01<00:07,  5.49it/s] 16%|█▌        | 8/50 [00:01<00:07,  5.54it/s] 18%|█▊        | 9/50 [00:01<00:07,  5.22it/s] 20%|██        | 10/50 [00:02<00:10,  3.98it/s] 22%|██▏       | 11/50 [00:02<00:10,  3.76it/s] 24%|██▍       | 12/50 [00:03<00:21,  1.77it/s] 26%|██▌       | 13/50 [00:03<00:16,  2.24it/s] 28%|██▊       | 14/50 [00:03<00:13,  2.74it/s] 30%|███       | 15/50 [00:04<00:10,  3.28it/s] 32%|███▏      | 16/50 [00:04<00:08,  3.79it/s] 34%|███▍      | 17/50 [00:04<00:07,  4.25it/s] 36%|███▌      | 18/50 [00:04<00:07,  4.51it/s] 38%|███▊      | 19/50 [00:04<00:06,  4.84it/s] 40%|████      | 20/50 [00:04<00:05,  5.07it/s] 42%|████▏     | 21/50 [00:05<00:05,  5.21it/s] 44%|████▍     | 22/50 [00:05<00:05,  5.41it/s] 46%|████▌     | 23/50 [00:05<00:04,  5.51it/s] 48%|████▊     | 24/50 [00:05<00:04,  5.37it/s] 50%|█████     | 25/50 [00:05<00:04,  5.51it/s] 52%|█████▏    | 26/50 [00:06<00:04,  5.58it/s] 54%|█████▍    | 27/50 [00:06<00:04,  5.69it/s] 56%|█████▌    | 28/50 [00:06<00:03,  5.75it/s] 58%|█████▊    | 29/50 [00:06<00:05,  3.84it/s] 60%|██████    | 30/50 [00:07<00:04,  4.24it/s] 62%|██████▏   | 31/50 [00:07<00:04,  4.58it/s] 64%|██████▍   | 32/50 [00:07<00:03,  4.90it/s] 66%|██████▌   | 33/50 [00:07<00:03,  5.09it/s] 68%|██████▊   | 34/50 [00:07<00:03,  5.24it/s] 70%|███████   | 35/50 [00:07<00:02,  5.33it/s] 72%|███████▏  | 36/50 [00:08<00:02,  5.44it/s] 74%|███████▍  | 37/50 [00:08<00:02,  5.56it/s] 76%|███████▌  | 38/50 [00:08<00:02,  5.36it/s] 78%|███████▊  | 39/50 [00:08<00:02,  5.29it/s] 80%|████████  | 40/50 [00:08<00:01,  5.37it/s] 82%|████████▏ | 41/50 [00:09<00:01,  5.48it/s] 84%|████████▍ | 42/50 [00:09<00:01,  5.57it/s] 86%|████████▌ | 43/50 [00:09<00:01,  5.61it/s] 88%|████████▊ | 44/50 [00:09<00:01,  5.62it/s] 90%|█████████ | 45/50 [00:09<00:00,  5.58it/s] 92%|█████████▏| 46/50 [00:09<00:00,  5.61it/s] 94%|█████████▍| 47/50 [00:10<00:00,  5.66it/s] 96%|█████████▌| 48/50 [00:10<00:00,  5.65it/s] 98%|█████████▊| 49/50 [00:10<00:00,  5.62it/s]100%|██████████| 50/50 [00:10<00:00,  5.69it/s]100%|██████████| 50/50 [00:10<00:00,  4.72it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7fe893e0eea0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:16,  2.90it/s]  6%|▌         | 3/50 [00:00<00:07,  6.19it/s]  8%|▊         | 4/50 [00:00<00:06,  7.02it/s] 10%|█         | 5/50 [00:00<00:05,  7.79it/s] 14%|█▍        | 7/50 [00:00<00:04,  8.99it/s] 18%|█▊        | 9/50 [00:01<00:04,  9.61it/s] 20%|██        | 10/50 [00:01<00:04,  9.68it/s] 22%|██▏       | 11/50 [00:01<00:04,  9.69it/s] 24%|██▍       | 12/50 [00:02<00:14,  2.59it/s] 28%|██▊       | 14/50 [00:02<00:09,  3.79it/s] 32%|███▏      | 16/50 [00:02<00:06,  5.01it/s] 34%|███▍      | 17/50 [00:03<00:05,  5.59it/s] 36%|███▌      | 18/50 [00:03<00:05,  6.00it/s] 38%|███▊      | 19/50 [00:03<00:04,  6.64it/s] 40%|████      | 20/50 [00:03<00:04,  7.04it/s] 42%|████▏     | 21/50 [00:03<00:03,  7.60it/s] 46%|████▌     | 23/50 [00:03<00:03,  8.69it/s] 50%|█████     | 25/50 [00:03<00:03,  7.92it/s] 52%|█████▏    | 26/50 [00:04<00:02,  8.28it/s] 54%|█████▍    | 27/50 [00:04<00:02,  8.60it/s] 56%|█████▌    | 28/50 [00:04<00:02,  8.86it/s] 58%|█████▊    | 29/50 [00:04<00:02,  9.11it/s] 60%|██████    | 30/50 [00:04<00:02,  9.32it/s] 64%|██████▍   | 32/50 [00:04<00:01,  9.76it/s] 68%|██████▊   | 34/50 [00:04<00:01, 10.13it/s] 72%|███████▏  | 36/50 [00:05<00:01,  9.14it/s] 76%|███████▌  | 38/50 [00:05<00:01,  9.68it/s] 80%|████████  | 40/50 [00:05<00:01,  9.94it/s] 84%|████████▍ | 42/50 [00:05<00:00, 10.29it/s] 88%|████████▊ | 44/50 [00:05<00:00, 10.50it/s] 92%|█████████▏| 46/50 [00:05<00:00, 10.67it/s] 96%|█████████▌| 48/50 [00:06<00:00, 10.79it/s]100%|██████████| 50/50 [00:06<00:00, 10.85it/s]100%|██████████| 50/50 [00:06<00:00,  7.79it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 62912
INFO:root:Parameters : 2361
INFO:root:Iterations : 101
INFO:root:Time : 2.4712729454040527 [s]
INFO:root:Initial cost : 1.3009313723072482 [px]
INFO:root:Final cost : 0.19575800411331729 [px]
INFO:root:Residuals : 63148
INFO:root:Parameters : 2364
INFO:root:Iterations : 101
INFO:root:Time : 2.5339980125427246 [s]
INFO:root:Initial cost : 1.0222237860095538 [px]
INFO:root:Final cost : 0.18816732687249618 [px]
INFO:root:Residuals : 62900
INFO:root:Parameters : 2349
INFO:root:Iterations : 101
INFO:root:Time : 2.525521993637085 [s]
INFO:root:Initial cost : 1.0195940157375882 [px]
INFO:root:Final cost : 0.1900258329591683 [px]
INFO:root:Residuals : 62498
INFO:root:Parameters : 2337
INFO:root:Iterations : 101
INFO:root:Time : 2.4786159992218018 [s]
INFO:root:Initial cost : 1.0348357543399744 [px]
INFO:root:Final cost : 0.19271781328690502 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:13,  3.53it/s]  4%|▍         | 2/50 [00:00<00:11,  4.04it/s]  6%|▌         | 3/50 [00:00<00:11,  4.20it/s]  8%|▊         | 4/50 [00:00<00:10,  4.60it/s] 10%|█         | 5/50 [00:01<00:09,  4.81it/s] 12%|█▏        | 6/50 [00:01<00:08,  4.97it/s] 14%|█▍        | 7/50 [00:01<00:08,  5.08it/s] 16%|█▌        | 8/50 [00:01<00:08,  5.07it/s] 18%|█▊        | 9/50 [00:01<00:08,  4.89it/s] 20%|██        | 10/50 [00:02<00:07,  5.01it/s] 22%|██▏       | 11/50 [00:02<00:07,  5.10it/s] 24%|██▍       | 12/50 [00:05<00:37,  1.02it/s] 26%|██▌       | 13/50 [00:05<00:27,  1.36it/s] 28%|██▊       | 14/50 [00:05<00:20,  1.77it/s] 30%|███       | 15/50 [00:05<00:15,  2.23it/s] 32%|███▏      | 16/50 [00:05<00:12,  2.71it/s] 34%|███▍      | 17/50 [00:05<00:10,  3.21it/s] 36%|███▌      | 18/50 [00:06<00:09,  3.33it/s] 38%|███▊      | 19/50 [00:06<00:08,  3.74it/s] 40%|████      | 20/50 [00:06<00:07,  4.15it/s] 42%|████▏     | 21/50 [00:06<00:06,  4.46it/s] 44%|████▍     | 22/50 [00:06<00:05,  4.74it/s] 46%|████▌     | 23/50 [00:07<00:05,  4.97it/s] 48%|████▊     | 24/50 [00:07<00:05,  4.90it/s] 50%|█████     | 25/50 [00:08<00:08,  2.87it/s] 52%|█████▏    | 26/50 [00:08<00:07,  3.01it/s] 54%|█████▍    | 27/50 [00:08<00:06,  3.33it/s] 56%|█████▌    | 28/50 [00:08<00:06,  3.39it/s] 58%|█████▊    | 29/50 [00:09<00:05,  3.81it/s] 60%|██████    | 30/50 [00:09<00:04,  4.21it/s] 62%|██████▏   | 31/50 [00:09<00:04,  4.56it/s] 64%|██████▍   | 32/50 [00:09<00:03,  4.84it/s] 66%|██████▌   | 33/50 [00:09<00:03,  4.79it/s] 68%|██████▊   | 34/50 [00:09<00:03,  5.00it/s] 70%|███████   | 35/50 [00:10<00:02,  5.19it/s] 72%|███████▏  | 36/50 [00:10<00:02,  5.25it/s] 74%|███████▍  | 37/50 [00:10<00:02,  5.37it/s] 76%|███████▌  | 38/50 [00:10<00:02,  5.31it/s] 78%|███████▊  | 39/50 [00:10<00:02,  5.39it/s] 80%|████████  | 40/50 [00:11<00:03,  3.23it/s] 82%|████████▏ | 41/50 [00:11<00:02,  3.64it/s] 84%|████████▍ | 42/50 [00:11<00:01,  4.02it/s] 86%|████████▌ | 43/50 [00:12<00:01,  4.17it/s] 88%|████████▊ | 44/50 [00:12<00:01,  4.31it/s] 90%|█████████ | 45/50 [00:12<00:01,  4.57it/s] 92%|█████████▏| 46/50 [00:12<00:00,  4.72it/s] 94%|█████████▍| 47/50 [00:12<00:00,  4.87it/s] 96%|█████████▌| 48/50 [00:13<00:00,  5.00it/s] 98%|█████████▊| 49/50 [00:13<00:00,  4.89it/s]100%|██████████| 50/50 [00:13<00:00,  4.92it/s]100%|██████████| 50/50 [00:13<00:00,  3.72it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/pstudio/basketball_12.npz
metrics: {'epe3d_allo_image_all': 0.31482365548610686, 'epe3d_allo_pixel_all': 0.32124862585582314, 'epe3d_sf_allo_image_all': 0.2542543935775757, 'epe3d_sf_allo_pixel_all': 0.2594432590858944, 'num_valid_pixels': 3577.0, 'delta_0.05': 0.14788929270338272, 'delta_0.1': 0.7232317584568074, 'delta_0.2': 0.9287112105116019, 'delta_0.4': 0.9485602460162147, 'outlier_0.15': 0.09057869723231758, 'delta_epe_0.1': 0.2678221973720995, 'delta_epe_0.3': 0.9018730779983226, 'delta_epe_0.5': 0.9250768800670953, 'delta_epe_1.0': 0.950796757058988, 'outlier_epe_0.25': 0.11657813810455689}
Final Metrics across all sequences:
epe3d_allo_image_all: 0.24619985936582084
epe3d_allo_pixel_all: 0.25122434638050317
epe3d_sf_allo_image_all: 0.19273963957838713
epe3d_sf_allo_pixel_all: 0.19667310205450697
num_valid_pixels: 36554.0
delta_0.05: 0.3900422752217617
delta_0.1: 0.7585100593496474
delta_0.2: 0.914845387892212
delta_0.4: 0.9840057326645966
outlier_0.15: 0.12532737210899517
delta_epe_0.1: 0.3353375686579283
delta_epe_0.3: 0.8232692775484957
delta_epe_0.5: 0.9547295746028454
delta_epe_1.0: 0.992250895579717
outlier_epe_0.25: 0.2426701166584806
Metrics saved to tapvid3d_pstudio_spatrackv2_any4d_benchmarking_metrics.txt
