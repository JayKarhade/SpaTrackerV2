INFO:numexpr.utils:Note: detected 96 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 96 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
INFO:numexpr.utils:NumExpr defaulting to 16 threads.
Seed set to: 0
Using device: cuda
Found 10 sequences.
Using 10 sequences for evaluation.
Processing sequence: e0ff8f-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:22,  1.69s/it]  4%|▍         | 2/50 [00:03<01:20,  1.67s/it]  6%|▌         | 3/50 [00:04<01:16,  1.64s/it]  8%|▊         | 4/50 [00:06<01:15,  1.64s/it] 10%|█         | 5/50 [00:08<01:16,  1.69s/it] 12%|█▏        | 6/50 [00:10<01:14,  1.70s/it] 14%|█▍        | 7/50 [00:11<01:10,  1.63s/it] 16%|█▌        | 8/50 [00:13<01:07,  1.60s/it] 18%|█▊        | 9/50 [00:14<01:06,  1.61s/it] 20%|██        | 10/50 [00:16<01:03,  1.59s/it] 22%|██▏       | 11/50 [00:17<01:00,  1.55s/it] 24%|██▍       | 12/50 [00:19<00:57,  1.52s/it] 26%|██▌       | 13/50 [00:20<00:56,  1.53s/it] 28%|██▊       | 14/50 [00:22<00:56,  1.57s/it] 30%|███       | 15/50 [00:24<00:55,  1.59s/it] 32%|███▏      | 16/50 [00:25<00:54,  1.59s/it] 34%|███▍      | 17/50 [00:27<00:52,  1.59s/it] 36%|███▌      | 18/50 [00:28<00:50,  1.59s/it] 38%|███▊      | 19/50 [00:30<00:48,  1.58s/it] 40%|████      | 20/50 [00:31<00:46,  1.55s/it] 42%|████▏     | 21/50 [00:33<00:44,  1.52s/it] 44%|████▍     | 22/50 [00:34<00:41,  1.49s/it] 46%|████▌     | 23/50 [00:36<00:39,  1.48s/it] 48%|████▊     | 24/50 [00:37<00:39,  1.53s/it] 50%|█████     | 25/50 [00:39<00:39,  1.58s/it] 52%|█████▏    | 26/50 [00:41<00:37,  1.58s/it] 54%|█████▍    | 27/50 [00:42<00:37,  1.63s/it] 56%|█████▌    | 28/50 [00:44<00:36,  1.64s/it] 58%|█████▊    | 29/50 [00:46<00:34,  1.66s/it] 60%|██████    | 30/50 [00:47<00:33,  1.69s/it] 62%|██████▏   | 31/50 [00:49<00:32,  1.71s/it] 64%|██████▍   | 32/50 [00:51<00:30,  1.70s/it] 66%|██████▌   | 33/50 [00:53<00:28,  1.69s/it] 68%|██████▊   | 34/50 [00:54<00:27,  1.70s/it] 70%|███████   | 35/50 [00:56<00:25,  1.73s/it] 72%|███████▏  | 36/50 [00:58<00:24,  1.77s/it] 74%|███████▍  | 37/50 [01:00<00:23,  1.78s/it] 76%|███████▌  | 38/50 [01:01<00:21,  1.75s/it] 78%|███████▊  | 39/50 [01:03<00:19,  1.77s/it] 80%|████████  | 40/50 [01:05<00:17,  1.78s/it] 82%|████████▏ | 41/50 [01:07<00:15,  1.75s/it] 84%|████████▍ | 42/50 [01:09<00:14,  1.80s/it] 86%|████████▌ | 43/50 [01:10<00:12,  1.77s/it] 88%|████████▊ | 44/50 [01:12<00:10,  1.74s/it] 90%|█████████ | 45/50 [01:14<00:08,  1.72s/it] 92%|█████████▏| 46/50 [01:15<00:06,  1.71s/it] 94%|█████████▍| 47/50 [01:17<00:05,  1.72s/it] 96%|█████████▌| 48/50 [01:19<00:03,  1.69s/it] 98%|█████████▊| 49/50 [01:20<00:01,  1.69s/it]100%|██████████| 50/50 [01:22<00:00,  1.68s/it]100%|██████████| 50/50 [01:22<00:00,  1.65s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f2db1466c00>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:28,  1.81s/it]  4%|▍         | 2/50 [00:03<01:14,  1.55s/it]  6%|▌         | 3/50 [00:04<01:10,  1.51s/it]  8%|▊         | 4/50 [00:06<01:07,  1.47s/it] 10%|█         | 5/50 [00:07<01:04,  1.44s/it] 12%|█▏        | 6/50 [00:08<01:02,  1.42s/it] 14%|█▍        | 7/50 [00:10<01:01,  1.42s/it] 16%|█▌        | 8/50 [00:11<00:58,  1.40s/it] 18%|█▊        | 9/50 [00:12<00:57,  1.39s/it] 20%|██        | 10/50 [00:14<00:55,  1.38s/it] 22%|██▏       | 11/50 [00:15<00:53,  1.36s/it] 24%|██▍       | 12/50 [00:16<00:51,  1.36s/it] 26%|██▌       | 13/50 [00:18<00:50,  1.35s/it] 28%|██▊       | 14/50 [00:19<00:48,  1.35s/it] 30%|███       | 15/50 [00:21<00:47,  1.35s/it] 32%|███▏      | 16/50 [00:22<00:45,  1.35s/it] 34%|███▍      | 17/50 [00:23<00:44,  1.35s/it] 36%|███▌      | 18/50 [00:25<00:43,  1.35s/it] 38%|███▊      | 19/50 [00:26<00:41,  1.35s/it] 40%|████      | 20/50 [00:27<00:40,  1.35s/it] 42%|████▏     | 21/50 [00:29<00:39,  1.35s/it] 44%|████▍     | 22/50 [00:30<00:37,  1.35s/it] 46%|████▌     | 23/50 [00:31<00:36,  1.34s/it] 48%|████▊     | 24/50 [00:33<00:34,  1.34s/it] 50%|█████     | 25/50 [00:34<00:33,  1.34s/it] 52%|█████▏    | 26/50 [00:35<00:32,  1.36s/it] 54%|█████▍    | 27/50 [00:37<00:31,  1.37s/it] 56%|█████▌    | 28/50 [00:38<00:29,  1.36s/it] 58%|█████▊    | 29/50 [00:39<00:28,  1.36s/it] 60%|██████    | 30/50 [00:41<00:27,  1.38s/it] 62%|██████▏   | 31/50 [00:42<00:26,  1.37s/it] 64%|██████▍   | 32/50 [00:44<00:25,  1.41s/it] 66%|██████▌   | 33/50 [00:45<00:23,  1.39s/it] 68%|██████▊   | 34/50 [00:46<00:22,  1.38s/it] 70%|███████   | 35/50 [00:48<00:20,  1.38s/it] 72%|███████▏  | 36/50 [00:49<00:19,  1.39s/it] 74%|███████▍  | 37/50 [00:51<00:18,  1.39s/it] 76%|███████▌  | 38/50 [00:52<00:16,  1.39s/it] 78%|███████▊  | 39/50 [00:53<00:15,  1.39s/it] 80%|████████  | 40/50 [00:55<00:13,  1.38s/it] 82%|████████▏ | 41/50 [00:56<00:12,  1.39s/it] 84%|████████▍ | 42/50 [00:58<00:11,  1.38s/it] 86%|████████▌ | 43/50 [00:59<00:09,  1.38s/it] 88%|████████▊ | 44/50 [01:00<00:08,  1.38s/it] 90%|█████████ | 45/50 [01:02<00:06,  1.37s/it] 92%|█████████▏| 46/50 [01:03<00:05,  1.37s/it] 94%|█████████▍| 47/50 [01:04<00:04,  1.39s/it] 96%|█████████▌| 48/50 [01:06<00:02,  1.40s/it] 98%|█████████▊| 49/50 [01:07<00:01,  1.39s/it]100%|██████████| 50/50 [01:09<00:00,  1.39s/it]100%|██████████| 50/50 [01:09<00:00,  1.38s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")

WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")

WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")

INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 64176
INFO:root:Parameters : 2424
INFO:root:Iterations : 101
INFO:root:Time : 2.8492400646209717 [s]
INFO:root:Initial cost : 2.1089919802821218 [px]
INFO:root:Final cost : 0.2203725433709376 [px]
INFO:root:Residuals : 64944
INFO:root:Parameters : 2436
INFO:root:Iterations : 101
INFO:root:Time : 2.8494009971618652 [s]
INFO:root:Initial cost : 0.7628042929397969 [px]
INFO:root:Final cost : 0.17939461957460265 [px]
INFO:root:Residuals : 65266
INFO:root:Parameters : 2445
INFO:root:Iterations : 101
INFO:root:Time : 2.8312880992889404 [s]
INFO:root:Initial cost : 0.7484644438505375 [px]
INFO:root:Final cost : 0.1810333234263655 [px]
INFO:root:Residuals : 65338
INFO:root:Parameters : 2448
INFO:root:Iterations : 101
INFO:root:Time : 3.085353136062622 [s]
INFO:root:Initial cost : 0.7479368521580614 [px]
INFO:root:Final cost : 0.18209864898241654 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:18,  1.61s/it]  4%|▍         | 2/50 [00:03<01:16,  1.60s/it]  6%|▌         | 3/50 [00:04<01:15,  1.60s/it]  8%|▊         | 4/50 [00:06<01:14,  1.61s/it] 10%|█         | 5/50 [00:08<01:12,  1.61s/it] 12%|█▏        | 6/50 [00:09<01:10,  1.61s/it] 14%|█▍        | 7/50 [00:11<01:08,  1.60s/it] 16%|█▌        | 8/50 [00:12<01:06,  1.58s/it] 18%|█▊        | 9/50 [00:14<01:04,  1.57s/it] 20%|██        | 10/50 [00:15<01:01,  1.55s/it] 22%|██▏       | 11/50 [00:17<00:59,  1.53s/it] 24%|██▍       | 12/50 [00:18<00:58,  1.54s/it] 26%|██▌       | 13/50 [00:20<00:55,  1.51s/it] 28%|██▊       | 14/50 [00:21<00:55,  1.54s/it] 30%|███       | 15/50 [00:23<00:54,  1.56s/it] 32%|███▏      | 16/50 [00:24<00:51,  1.53s/it] 34%|███▍      | 17/50 [00:26<00:49,  1.51s/it] 36%|███▌      | 18/50 [00:27<00:47,  1.50s/it] 38%|███▊      | 19/50 [00:29<00:46,  1.48s/it] 40%|████      | 20/50 [00:30<00:43,  1.47s/it] 42%|████▏     | 21/50 [00:32<00:42,  1.46s/it] 44%|████▍     | 22/50 [00:33<00:40,  1.45s/it] 46%|████▌     | 23/50 [00:35<00:39,  1.47s/it] 48%|████▊     | 24/50 [00:36<00:38,  1.49s/it] 50%|█████     | 25/50 [00:38<00:37,  1.50s/it] 52%|█████▏    | 26/50 [00:39<00:36,  1.54s/it] 54%|█████▍    | 27/50 [00:41<00:35,  1.54s/it] 56%|█████▌    | 28/50 [00:42<00:33,  1.52s/it] 58%|█████▊    | 29/50 [00:44<00:31,  1.50s/it] 60%|██████    | 30/50 [00:45<00:29,  1.48s/it] 62%|██████▏   | 31/50 [00:47<00:27,  1.46s/it] 64%|██████▍   | 32/50 [00:48<00:26,  1.47s/it] 66%|██████▌   | 33/50 [00:50<00:24,  1.46s/it] 68%|██████▊   | 34/50 [00:51<00:23,  1.48s/it] 70%|███████   | 35/50 [00:53<00:22,  1.51s/it] 72%|███████▏  | 36/50 [00:54<00:21,  1.54s/it] 74%|███████▍  | 37/50 [00:56<00:20,  1.57s/it] 76%|███████▌  | 38/50 [00:58<00:19,  1.59s/it] 78%|███████▊  | 39/50 [00:59<00:17,  1.61s/it] 80%|████████  | 40/50 [01:01<00:16,  1.62s/it] 82%|████████▏ | 41/50 [01:03<00:14,  1.62s/it] 84%|████████▍ | 42/50 [01:04<00:12,  1.62s/it] 86%|████████▌ | 43/50 [01:06<00:11,  1.63s/it] 88%|████████▊ | 44/50 [01:07<00:09,  1.63s/it] 90%|█████████ | 45/50 [01:09<00:08,  1.63s/it] 92%|█████████▏| 46/50 [01:11<00:06,  1.64s/it] 94%|█████████▍| 47/50 [01:12<00:04,  1.63s/it] 96%|█████████▌| 48/50 [01:14<00:03,  1.62s/it] 98%|█████████▊| 49/50 [01:16<00:01,  1.63s/it]100%|██████████| 50/50 [01:17<00:00,  1.62s/it]100%|██████████| 50/50 [01:17<00:00,  1.55s/it]
sequence:e0ff8f-3_obj
metrics: {'epe3d_allo_image_all': 0.5212827727198601, 'epe3d_allo_pixel_all': 0.5212827732165655, 'epe3d_sf_allo_image_all': 0.031952638851944354, 'epe3d_sf_allo_pixel_all': 0.031952638840302826, 'num_valid_pixels': 2400.0, 'delta_0.05': 0.67625, 'delta_0.1': 0.86375, 'delta_0.2': 0.87625, 'delta_0.4': 0.87625, 'outlier_0.15': 0.12375, 'delta_epe_0.1': 0.9729166666666667, 'delta_epe_0.3': 1.0, 'delta_epe_0.5': 1.0, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.0004166666666666667}
Processing sequence: ff80e8-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:14,  1.52s/it]  4%|▍         | 2/50 [00:03<01:16,  1.58s/it]  6%|▌         | 3/50 [00:05<01:21,  1.73s/it]  8%|▊         | 4/50 [00:06<01:17,  1.68s/it] 10%|█         | 5/50 [00:08<01:13,  1.63s/it] 12%|█▏        | 6/50 [00:09<01:09,  1.57s/it] 14%|█▍        | 7/50 [00:11<01:07,  1.57s/it] 16%|█▌        | 8/50 [00:12<01:04,  1.55s/it] 18%|█▊        | 9/50 [00:14<01:03,  1.56s/it] 20%|██        | 10/50 [00:15<01:02,  1.56s/it] 22%|██▏       | 11/50 [00:17<01:00,  1.55s/it] 24%|██▍       | 12/50 [00:18<00:57,  1.52s/it] 26%|██▌       | 13/50 [00:20<00:55,  1.50s/it] 28%|██▊       | 14/50 [00:21<00:53,  1.49s/it] 30%|███       | 15/50 [00:23<00:50,  1.45s/it] 32%|███▏      | 16/50 [00:24<00:47,  1.41s/it] 34%|███▍      | 17/50 [00:25<00:45,  1.37s/it] 36%|███▌      | 18/50 [00:27<00:43,  1.36s/it] 38%|███▊      | 19/50 [00:28<00:41,  1.34s/it] 40%|████      | 20/50 [00:29<00:40,  1.35s/it] 42%|████▏     | 21/50 [00:31<00:39,  1.35s/it] 44%|████▍     | 22/50 [00:32<00:38,  1.39s/it] 46%|████▌     | 23/50 [00:33<00:36,  1.37s/it] 48%|████▊     | 24/50 [00:35<00:35,  1.35s/it] 50%|█████     | 25/50 [00:36<00:34,  1.38s/it] 52%|█████▏    | 26/50 [00:38<00:33,  1.40s/it] 54%|█████▍    | 27/50 [00:39<00:32,  1.41s/it] 56%|█████▌    | 28/50 [00:40<00:30,  1.38s/it] 58%|█████▊    | 29/50 [00:42<00:28,  1.36s/it] 60%|██████    | 30/50 [00:43<00:27,  1.36s/it] 62%|██████▏   | 31/50 [00:44<00:25,  1.34s/it] 64%|██████▍   | 32/50 [00:46<00:24,  1.36s/it] 66%|██████▌   | 33/50 [00:47<00:23,  1.38s/it] 68%|██████▊   | 34/50 [00:48<00:22,  1.38s/it] 70%|███████   | 35/50 [00:50<00:20,  1.38s/it] 72%|███████▏  | 36/50 [00:51<00:19,  1.39s/it] 74%|███████▍  | 37/50 [00:53<00:18,  1.40s/it] 76%|███████▌  | 38/50 [00:54<00:16,  1.36s/it] 78%|███████▊  | 39/50 [00:55<00:15,  1.37s/it] 80%|████████  | 40/50 [00:57<00:13,  1.38s/it] 82%|████████▏ | 41/50 [00:58<00:12,  1.37s/it] 84%|████████▍ | 42/50 [01:00<00:11,  1.38s/it] 86%|████████▌ | 43/50 [01:01<00:09,  1.41s/it] 88%|████████▊ | 44/50 [01:02<00:08,  1.39s/it] 90%|█████████ | 45/50 [01:04<00:06,  1.38s/it] 92%|█████████▏| 46/50 [01:05<00:05,  1.35s/it] 94%|█████████▍| 47/50 [01:06<00:03,  1.33s/it] 96%|█████████▌| 48/50 [01:08<00:02,  1.32s/it] 98%|█████████▊| 49/50 [01:09<00:01,  1.33s/it]100%|██████████| 50/50 [01:10<00:00,  1.29s/it]100%|██████████| 50/50 [01:10<00:00,  1.41s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f3416bb88c0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:14,  1.52s/it]  4%|▍         | 2/50 [00:02<01:05,  1.37s/it]  6%|▌         | 3/50 [00:04<01:02,  1.33s/it]  8%|▊         | 4/50 [00:05<01:00,  1.32s/it] 10%|█         | 5/50 [00:06<00:59,  1.31s/it] 12%|█▏        | 6/50 [00:07<00:57,  1.30s/it] 14%|█▍        | 7/50 [00:09<00:55,  1.28s/it] 16%|█▌        | 8/50 [00:10<00:53,  1.27s/it] 18%|█▊        | 9/50 [00:11<00:51,  1.26s/it] 20%|██        | 10/50 [00:12<00:50,  1.25s/it] 22%|██▏       | 11/50 [00:14<00:48,  1.25s/it] 24%|██▍       | 12/50 [00:15<00:47,  1.25s/it] 26%|██▌       | 13/50 [00:16<00:45,  1.24s/it] 28%|██▊       | 14/50 [00:17<00:44,  1.25s/it] 30%|███       | 15/50 [00:19<00:43,  1.25s/it] 32%|███▏      | 16/50 [00:20<00:42,  1.24s/it] 34%|███▍      | 17/50 [00:21<00:41,  1.25s/it] 36%|███▌      | 18/50 [00:22<00:40,  1.26s/it] 38%|███▊      | 19/50 [00:24<00:39,  1.27s/it] 40%|████      | 20/50 [00:25<00:37,  1.26s/it] 42%|████▏     | 21/50 [00:26<00:36,  1.26s/it] 44%|████▍     | 22/50 [00:27<00:35,  1.25s/it] 46%|████▌     | 23/50 [00:29<00:33,  1.24s/it] 48%|████▊     | 24/50 [00:30<00:32,  1.24s/it] 50%|█████     | 25/50 [00:31<00:31,  1.24s/it] 52%|█████▏    | 26/50 [00:32<00:29,  1.25s/it] 54%|█████▍    | 27/50 [00:34<00:28,  1.26s/it] 56%|█████▌    | 28/50 [00:35<00:27,  1.24s/it] 58%|█████▊    | 29/50 [00:36<00:25,  1.23s/it] 60%|██████    | 30/50 [00:37<00:24,  1.22s/it] 62%|██████▏   | 31/50 [00:38<00:23,  1.22s/it] 64%|██████▍   | 32/50 [00:40<00:21,  1.22s/it] 66%|██████▌   | 33/50 [00:41<00:20,  1.22s/it] 68%|██████▊   | 34/50 [00:42<00:19,  1.21s/it] 70%|███████   | 35/50 [00:43<00:18,  1.21s/it] 72%|███████▏  | 36/50 [00:45<00:16,  1.21s/it] 74%|███████▍  | 37/50 [00:46<00:15,  1.20s/it] 76%|███████▌  | 38/50 [00:47<00:14,  1.21s/it] 78%|███████▊  | 39/50 [00:48<00:13,  1.23s/it] 80%|████████  | 40/50 [00:49<00:12,  1.22s/it] 82%|████████▏ | 41/50 [00:51<00:11,  1.23s/it] 84%|████████▍ | 42/50 [00:52<00:09,  1.23s/it] 86%|████████▌ | 43/50 [00:53<00:08,  1.24s/it] 88%|████████▊ | 44/50 [00:54<00:07,  1.24s/it] 90%|█████████ | 45/50 [00:56<00:06,  1.23s/it] 92%|█████████▏| 46/50 [00:57<00:04,  1.23s/it] 94%|█████████▍| 47/50 [00:58<00:03,  1.24s/it] 96%|█████████▌| 48/50 [00:59<00:02,  1.23s/it] 98%|█████████▊| 49/50 [01:01<00:01,  1.23s/it]100%|██████████| 50/50 [01:02<00:00,  1.22s/it]100%|██████████| 50/50 [01:02<00:00,  1.25s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 56190
INFO:root:Parameters : 2415
INFO:root:Iterations : 101
INFO:root:Time : 2.8555479049682617 [s]
INFO:root:Initial cost : 4.83915038761554 [px]
INFO:root:Final cost : 0.7313355155330139 [px]
INFO:root:Residuals : 56328
INFO:root:Parameters : 2388
INFO:root:Iterations : 101
INFO:root:Time : 2.7699639797210693 [s]
INFO:root:Initial cost : 1.9868208925643174 [px]
INFO:root:Final cost : 0.49779151219613677 [px]
INFO:root:Residuals : 54216
INFO:root:Parameters : 2310
INFO:root:Iterations : 101
INFO:root:Time : 3.1543359756469727 [s]
INFO:root:Initial cost : 1.6076603452916993 [px]
INFO:root:Final cost : 0.4777070227135405 [px]
INFO:root:Residuals : 55226
INFO:root:Parameters : 2337
INFO:root:Iterations : 101
INFO:root:Time : 2.5232768058776855 [s]
INFO:root:Initial cost : 1.5565649560311854 [px]
INFO:root:Final cost : 0.4658693182372789 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:06,  1.35s/it]  4%|▍         | 2/50 [00:02<01:04,  1.34s/it]  6%|▌         | 3/50 [00:03<01:02,  1.33s/it]  8%|▊         | 4/50 [00:05<01:00,  1.31s/it] 10%|█         | 5/50 [00:06<00:59,  1.31s/it] 12%|█▏        | 6/50 [00:07<00:57,  1.30s/it] 14%|█▍        | 7/50 [00:09<00:56,  1.32s/it] 16%|█▌        | 8/50 [00:10<00:55,  1.32s/it] 18%|█▊        | 9/50 [00:11<00:55,  1.35s/it] 20%|██        | 10/50 [00:13<00:54,  1.36s/it] 22%|██▏       | 11/50 [00:14<00:54,  1.40s/it] 24%|██▍       | 12/50 [00:16<00:51,  1.37s/it] 26%|██▌       | 13/50 [00:17<00:49,  1.33s/it] 28%|██▊       | 14/50 [00:18<00:46,  1.30s/it] 30%|███       | 15/50 [00:19<00:45,  1.29s/it] 32%|███▏      | 16/50 [00:21<00:43,  1.29s/it] 34%|███▍      | 17/50 [00:22<00:43,  1.31s/it] 36%|███▌      | 18/50 [00:23<00:42,  1.32s/it] 38%|███▊      | 19/50 [00:25<00:41,  1.33s/it] 40%|████      | 20/50 [00:26<00:40,  1.33s/it] 42%|████▏     | 21/50 [00:27<00:39,  1.35s/it] 44%|████▍     | 22/50 [00:29<00:37,  1.34s/it] 46%|████▌     | 23/50 [00:30<00:36,  1.36s/it] 48%|████▊     | 24/50 [00:32<00:35,  1.36s/it] 50%|█████     | 25/50 [00:33<00:34,  1.37s/it] 52%|█████▏    | 26/50 [00:34<00:33,  1.39s/it] 54%|█████▍    | 27/50 [00:36<00:32,  1.41s/it] 56%|█████▌    | 28/50 [00:37<00:31,  1.41s/it] 58%|█████▊    | 29/50 [00:39<00:29,  1.42s/it] 60%|██████    | 30/50 [00:40<00:28,  1.43s/it] 62%|██████▏   | 31/50 [00:42<00:27,  1.44s/it] 64%|██████▍   | 32/50 [00:43<00:25,  1.44s/it] 66%|██████▌   | 33/50 [00:44<00:24,  1.44s/it] 68%|██████▊   | 34/50 [00:46<00:22,  1.43s/it] 70%|███████   | 35/50 [00:47<00:21,  1.43s/it] 72%|███████▏  | 36/50 [00:49<00:19,  1.43s/it] 74%|███████▍  | 37/50 [00:50<00:18,  1.43s/it] 76%|███████▌  | 38/50 [00:52<00:17,  1.44s/it] 78%|███████▊  | 39/50 [00:53<00:15,  1.44s/it] 80%|████████  | 40/50 [00:55<00:14,  1.43s/it] 82%|████████▏ | 41/50 [00:56<00:12,  1.42s/it] 84%|████████▍ | 42/50 [00:57<00:11,  1.43s/it] 86%|████████▌ | 43/50 [00:59<00:09,  1.43s/it] 88%|████████▊ | 44/50 [01:00<00:08,  1.43s/it] 90%|█████████ | 45/50 [01:02<00:07,  1.43s/it] 92%|█████████▏| 46/50 [01:03<00:05,  1.43s/it] 94%|█████████▍| 47/50 [01:05<00:04,  1.45s/it] 96%|█████████▌| 48/50 [01:06<00:02,  1.48s/it] 98%|█████████▊| 49/50 [01:08<00:01,  1.45s/it]100%|██████████| 50/50 [01:09<00:00,  1.45s/it]100%|██████████| 50/50 [01:09<00:00,  1.39s/it]
sequence:ff80e8-3_obj
metrics: {'epe3d_allo_image_all': 0.6159499830007553, 'epe3d_allo_pixel_all': 0.6159499838545516, 'epe3d_sf_allo_image_all': 0.05590064021758735, 'epe3d_sf_allo_pixel_all': 0.05590064002049936, 'num_valid_pixels': 7400.0, 'delta_0.05': 0.7883783783783784, 'delta_0.1': 0.8339189189189189, 'delta_0.2': 0.8339189189189189, 'delta_0.4': 0.8339189189189189, 'outlier_0.15': 0.16608108108108108, 'delta_epe_0.1': 0.8778378378378379, 'delta_epe_0.3': 0.9502702702702702, 'delta_epe_0.5': 1.0, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.06418918918918919}
Processing sequence: 216ba3-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:15,  2.76s/it]  4%|▍         | 2/50 [00:05<02:15,  2.82s/it]  6%|▌         | 3/50 [00:08<02:08,  2.73s/it]  8%|▊         | 4/50 [00:11<02:06,  2.74s/it] 10%|█         | 5/50 [00:14<02:07,  2.84s/it] 12%|█▏        | 6/50 [00:16<02:04,  2.83s/it] 14%|█▍        | 7/50 [00:19<02:01,  2.82s/it] 16%|█▌        | 8/50 [00:22<01:56,  2.78s/it] 18%|█▊        | 9/50 [00:24<01:50,  2.70s/it] 20%|██        | 10/50 [00:27<01:48,  2.70s/it] 22%|██▏       | 11/50 [00:30<01:43,  2.65s/it] 24%|██▍       | 12/50 [00:32<01:40,  2.64s/it] 26%|██▌       | 13/50 [00:35<01:36,  2.62s/it] 28%|██▊       | 14/50 [00:37<01:34,  2.62s/it] 30%|███       | 15/50 [00:40<01:31,  2.61s/it] 32%|███▏      | 16/50 [00:43<01:29,  2.63s/it] 34%|███▍      | 17/50 [00:45<01:25,  2.58s/it] 36%|███▌      | 18/50 [00:48<01:21,  2.53s/it] 38%|███▊      | 19/50 [00:50<01:17,  2.50s/it] 40%|████      | 20/50 [00:53<01:16,  2.56s/it] 42%|████▏     | 21/50 [00:55<01:14,  2.58s/it] 44%|████▍     | 22/50 [00:58<01:13,  2.61s/it] 46%|████▌     | 23/50 [01:01<01:10,  2.63s/it] 48%|████▊     | 24/50 [01:03<01:09,  2.66s/it] 50%|█████     | 25/50 [01:06<01:06,  2.68s/it] 52%|█████▏    | 26/50 [01:09<01:04,  2.69s/it] 54%|█████▍    | 27/50 [01:12<01:01,  2.69s/it] 56%|█████▌    | 28/50 [01:14<00:58,  2.67s/it] 58%|█████▊    | 29/50 [01:17<00:56,  2.69s/it] 60%|██████    | 30/50 [01:19<00:53,  2.67s/it] 62%|██████▏   | 31/50 [01:22<00:50,  2.68s/it] 64%|██████▍   | 32/50 [01:25<00:47,  2.62s/it] 66%|██████▌   | 33/50 [01:27<00:43,  2.54s/it] 68%|██████▊   | 34/50 [01:29<00:39,  2.48s/it] 70%|███████   | 35/50 [01:32<00:37,  2.47s/it] 72%|███████▏  | 36/50 [01:34<00:33,  2.39s/it] 74%|███████▍  | 37/50 [01:36<00:30,  2.34s/it] 76%|███████▌  | 38/50 [01:39<00:28,  2.36s/it] 78%|███████▊  | 39/50 [01:41<00:25,  2.32s/it] 80%|████████  | 40/50 [01:43<00:23,  2.30s/it] 82%|████████▏ | 41/50 [01:45<00:20,  2.26s/it] 84%|████████▍ | 42/50 [01:48<00:18,  2.26s/it] 86%|████████▌ | 43/50 [01:50<00:15,  2.22s/it] 88%|████████▊ | 44/50 [01:52<00:13,  2.21s/it] 90%|█████████ | 45/50 [01:54<00:10,  2.17s/it] 92%|█████████▏| 46/50 [01:56<00:08,  2.12s/it] 94%|█████████▍| 47/50 [01:58<00:06,  2.03s/it] 96%|█████████▌| 48/50 [02:00<00:03,  1.98s/it] 98%|█████████▊| 49/50 [02:02<00:01,  1.97s/it]100%|██████████| 50/50 [02:03<00:00,  1.94s/it]100%|██████████| 50/50 [02:03<00:00,  2.48s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f34014c08c0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:03<02:27,  3.02s/it]  4%|▍         | 2/50 [00:05<02:12,  2.77s/it]  6%|▌         | 3/50 [00:08<02:12,  2.82s/it]  8%|▊         | 4/50 [00:11<02:06,  2.74s/it] 10%|█         | 5/50 [00:13<02:03,  2.74s/it] 12%|█▏        | 6/50 [00:16<01:58,  2.70s/it] 14%|█▍        | 7/50 [00:18<01:53,  2.63s/it] 16%|█▌        | 8/50 [00:21<01:49,  2.60s/it] 18%|█▊        | 9/50 [00:24<01:46,  2.59s/it] 20%|██        | 10/50 [00:26<01:42,  2.55s/it] 22%|██▏       | 11/50 [00:29<01:39,  2.54s/it] 24%|██▍       | 12/50 [00:31<01:36,  2.54s/it] 26%|██▌       | 13/50 [00:34<01:33,  2.54s/it] 28%|██▊       | 14/50 [00:36<01:31,  2.54s/it] 30%|███       | 15/50 [00:39<01:29,  2.54s/it] 32%|███▏      | 16/50 [00:41<01:27,  2.57s/it] 34%|███▍      | 17/50 [00:44<01:23,  2.54s/it] 36%|███▌      | 18/50 [00:46<01:21,  2.54s/it] 38%|███▊      | 19/50 [00:49<01:17,  2.51s/it] 40%|████      | 20/50 [00:51<01:14,  2.49s/it] 42%|████▏     | 21/50 [00:54<01:11,  2.47s/it] 44%|████▍     | 22/50 [00:56<01:09,  2.48s/it] 46%|████▌     | 23/50 [00:59<01:06,  2.47s/it] 48%|████▊     | 24/50 [01:01<01:03,  2.44s/it] 50%|█████     | 25/50 [01:03<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:06<00:57,  2.41s/it] 54%|█████▍    | 27/50 [01:08<00:55,  2.41s/it] 56%|█████▌    | 28/50 [01:11<00:53,  2.45s/it] 58%|█████▊    | 29/50 [01:13<00:52,  2.48s/it] 60%|██████    | 30/50 [01:16<00:49,  2.47s/it] 62%|██████▏   | 31/50 [01:18<00:46,  2.45s/it] 64%|██████▍   | 32/50 [01:21<00:43,  2.44s/it] 66%|██████▌   | 33/50 [01:23<00:40,  2.38s/it] 68%|██████▊   | 34/50 [01:25<00:37,  2.32s/it] 70%|███████   | 35/50 [01:27<00:33,  2.26s/it] 72%|███████▏  | 36/50 [01:29<00:30,  2.21s/it] 74%|███████▍  | 37/50 [01:31<00:28,  2.17s/it] 76%|███████▌  | 38/50 [01:33<00:25,  2.11s/it] 78%|███████▊  | 39/50 [01:35<00:22,  2.05s/it] 80%|████████  | 40/50 [01:37<00:20,  2.01s/it] 82%|████████▏ | 41/50 [01:39<00:17,  1.98s/it] 84%|████████▍ | 42/50 [01:41<00:15,  1.96s/it] 86%|████████▌ | 43/50 [01:43<00:13,  1.92s/it] 88%|████████▊ | 44/50 [01:44<00:11,  1.88s/it] 90%|█████████ | 45/50 [01:46<00:09,  1.87s/it] 92%|█████████▏| 46/50 [01:48<00:07,  1.85s/it] 94%|█████████▍| 47/50 [01:50<00:05,  1.82s/it] 96%|█████████▌| 48/50 [01:52<00:03,  1.81s/it] 98%|█████████▊| 49/50 [01:53<00:01,  1.80s/it]100%|██████████| 50/50 [01:55<00:00,  1.80s/it]100%|██████████| 50/50 [01:55<00:00,  2.32s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 66476
INFO:root:Parameters : 2394
INFO:root:Iterations : 101
INFO:root:Time : 3.08541202545166 [s]
INFO:root:Initial cost : 1.9151479871396466 [px]
INFO:root:Final cost : 0.4194138461784962 [px]
INFO:root:Residuals : 66648
INFO:root:Parameters : 2391
INFO:root:Iterations : 101
INFO:root:Time : 2.662750005722046 [s]
INFO:root:Initial cost : 1.0760879914330712 [px]
INFO:root:Final cost : 0.29351761493818335 [px]
INFO:root:Residuals : 66830
INFO:root:Parameters : 2397
INFO:root:Iterations : 101
INFO:root:Time : 2.8143861293792725 [s]
INFO:root:Initial cost : 1.0545764675138554 [px]
INFO:root:Final cost : 0.26197981082250366 [px]
INFO:root:Residuals : 66700
INFO:root:Parameters : 2391
INFO:root:Iterations : 101
INFO:root:Time : 3.0050790309906006 [s]
INFO:root:Initial cost : 1.0320796109770625 [px]
INFO:root:Final cost : 0.25905880103024875 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:24,  2.96s/it]  4%|▍         | 2/50 [00:05<02:20,  2.92s/it]  6%|▌         | 3/50 [00:08<02:13,  2.84s/it]  8%|▊         | 4/50 [00:11<02:08,  2.78s/it] 10%|█         | 5/50 [00:13<02:03,  2.75s/it] 12%|█▏        | 6/50 [00:16<02:02,  2.78s/it] 14%|█▍        | 7/50 [00:19<02:00,  2.79s/it] 16%|█▌        | 8/50 [00:22<01:57,  2.80s/it] 18%|█▊        | 9/50 [00:25<01:56,  2.84s/it] 20%|██        | 10/50 [00:28<01:52,  2.82s/it] 22%|██▏       | 11/50 [00:31<01:51,  2.86s/it] 24%|██▍       | 12/50 [00:33<01:47,  2.84s/it] 26%|██▌       | 13/50 [00:36<01:44,  2.81s/it] 28%|██▊       | 14/50 [00:39<01:40,  2.78s/it] 30%|███       | 15/50 [00:42<01:36,  2.76s/it] 32%|███▏      | 16/50 [00:44<01:34,  2.77s/it] 34%|███▍      | 17/50 [00:47<01:31,  2.77s/it] 36%|███▌      | 18/50 [00:50<01:27,  2.75s/it] 38%|███▊      | 19/50 [00:52<01:22,  2.67s/it] 40%|████      | 20/50 [00:55<01:18,  2.61s/it] 42%|████▏     | 21/50 [00:57<01:14,  2.58s/it] 44%|████▍     | 22/50 [01:00<01:13,  2.62s/it] 46%|████▌     | 23/50 [01:03<01:11,  2.66s/it] 48%|████▊     | 24/50 [01:05<01:09,  2.67s/it] 50%|█████     | 25/50 [01:08<01:07,  2.70s/it] 52%|█████▏    | 26/50 [01:11<01:05,  2.73s/it] 54%|█████▍    | 27/50 [01:14<01:02,  2.72s/it] 56%|█████▌    | 28/50 [01:16<00:59,  2.69s/it] 58%|█████▊    | 29/50 [01:19<00:56,  2.70s/it] 60%|██████    | 30/50 [01:22<00:53,  2.67s/it] 62%|██████▏   | 31/50 [01:24<00:50,  2.65s/it] 64%|██████▍   | 32/50 [01:27<00:47,  2.63s/it] 66%|██████▌   | 33/50 [01:29<00:42,  2.53s/it] 68%|██████▊   | 34/50 [01:31<00:38,  2.41s/it] 70%|███████   | 35/50 [01:33<00:34,  2.30s/it] 72%|███████▏  | 36/50 [01:35<00:30,  2.19s/it] 74%|███████▍  | 37/50 [01:37<00:27,  2.11s/it] 76%|███████▌  | 38/50 [01:39<00:24,  2.03s/it] 78%|███████▊  | 39/50 [01:41<00:21,  1.96s/it] 80%|████████  | 40/50 [01:43<00:19,  1.91s/it] 82%|████████▏ | 41/50 [01:45<00:17,  1.92s/it] 84%|████████▍ | 42/50 [01:46<00:15,  1.91s/it] 86%|████████▌ | 43/50 [01:48<00:13,  1.92s/it] 88%|████████▊ | 44/50 [01:50<00:11,  1.92s/it] 90%|█████████ | 45/50 [01:52<00:09,  1.92s/it] 92%|█████████▏| 46/50 [01:54<00:07,  1.92s/it] 94%|█████████▍| 47/50 [01:56<00:05,  1.94s/it] 96%|█████████▌| 48/50 [01:58<00:03,  1.94s/it] 98%|█████████▊| 49/50 [02:00<00:01,  1.90s/it]100%|██████████| 50/50 [02:02<00:00,  1.90s/it]100%|██████████| 50/50 [02:02<00:00,  2.45s/it]
sequence:216ba3-3_obj
metrics: {'epe3d_allo_image_all': 0.8976917731761932, 'epe3d_allo_pixel_all': 0.8976917669806682, 'epe3d_sf_allo_image_all': 0.06303036788012832, 'epe3d_sf_allo_pixel_all': 0.06303036796794811, 'num_valid_pixels': 3550.0, 'delta_0.05': 0.006197183098591549, 'delta_0.1': 0.08873239436619719, 'delta_0.2': 0.7932394366197183, 'delta_0.4': 0.7935211267605634, 'outlier_0.15': 0.3126760563380282, 'delta_epe_0.1': 0.8983098591549296, 'delta_epe_0.3': 0.9566197183098591, 'delta_epe_0.5': 0.9628169014084507, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.04422535211267606}
Processing sequence: 445120-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:53,  1.09s/it]  4%|▍         | 2/50 [00:02<00:53,  1.11s/it]  6%|▌         | 3/50 [00:03<00:53,  1.13s/it]  8%|▊         | 4/50 [00:04<00:53,  1.16s/it] 10%|█         | 5/50 [00:05<00:55,  1.24s/it] 12%|█▏        | 6/50 [00:07<00:52,  1.20s/it] 14%|█▍        | 7/50 [00:08<00:49,  1.14s/it] 16%|█▌        | 8/50 [00:09<00:46,  1.11s/it] 18%|█▊        | 9/50 [00:10<00:44,  1.08s/it] 20%|██        | 10/50 [00:11<00:43,  1.08s/it] 22%|██▏       | 11/50 [00:12<00:41,  1.06s/it] 24%|██▍       | 12/50 [00:13<00:39,  1.05s/it] 26%|██▌       | 13/50 [00:14<00:40,  1.11s/it] 28%|██▊       | 14/50 [00:15<00:39,  1.09s/it] 30%|███       | 15/50 [00:16<00:38,  1.09s/it] 32%|███▏      | 16/50 [00:17<00:37,  1.11s/it] 34%|███▍      | 17/50 [00:19<00:37,  1.14s/it] 36%|███▌      | 18/50 [00:20<00:36,  1.15s/it] 38%|███▊      | 19/50 [00:21<00:36,  1.16s/it] 40%|████      | 20/50 [00:22<00:34,  1.15s/it] 42%|████▏     | 21/50 [00:23<00:33,  1.14s/it] 44%|████▍     | 22/50 [00:24<00:30,  1.11s/it] 46%|████▌     | 23/50 [00:25<00:29,  1.08s/it] 48%|████▊     | 24/50 [00:26<00:28,  1.08s/it] 50%|█████     | 25/50 [00:27<00:26,  1.07s/it] 52%|█████▏    | 26/50 [00:28<00:25,  1.06s/it] 54%|█████▍    | 27/50 [00:29<00:24,  1.06s/it] 56%|█████▌    | 28/50 [00:30<00:23,  1.06s/it] 58%|█████▊    | 29/50 [00:32<00:23,  1.10s/it] 60%|██████    | 30/50 [00:33<00:22,  1.12s/it] 62%|██████▏   | 31/50 [00:34<00:21,  1.13s/it] 64%|██████▍   | 32/50 [00:35<00:20,  1.13s/it] 66%|██████▌   | 33/50 [00:36<00:19,  1.13s/it] 68%|██████▊   | 34/50 [00:37<00:18,  1.16s/it] 70%|███████   | 35/50 [00:39<00:17,  1.19s/it] 72%|███████▏  | 36/50 [00:40<00:16,  1.17s/it] 74%|███████▍  | 37/50 [00:41<00:15,  1.15s/it] 76%|███████▌  | 38/50 [00:42<00:13,  1.16s/it] 78%|███████▊  | 39/50 [00:43<00:12,  1.15s/it] 80%|████████  | 40/50 [00:45<00:11,  1.17s/it] 82%|████████▏ | 41/50 [00:46<00:10,  1.18s/it] 84%|████████▍ | 42/50 [00:47<00:09,  1.19s/it] 86%|████████▌ | 43/50 [00:48<00:08,  1.17s/it] 88%|████████▊ | 44/50 [00:49<00:06,  1.17s/it] 90%|█████████ | 45/50 [00:50<00:05,  1.16s/it] 92%|█████████▏| 46/50 [00:51<00:04,  1.16s/it] 94%|█████████▍| 47/50 [00:53<00:03,  1.16s/it] 96%|█████████▌| 48/50 [00:54<00:02,  1.15s/it] 98%|█████████▊| 49/50 [00:55<00:01,  1.14s/it]100%|██████████| 50/50 [00:56<00:00,  1.12s/it]100%|██████████| 50/50 [00:56<00:00,  1.13s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f3403be9190>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:14,  1.51s/it]  4%|▍         | 2/50 [00:02<00:59,  1.24s/it]  6%|▌         | 3/50 [00:03<00:56,  1.19s/it]  8%|▊         | 4/50 [00:04<00:54,  1.19s/it] 10%|█         | 5/50 [00:05<00:51,  1.14s/it] 12%|█▏        | 6/50 [00:07<00:49,  1.12s/it] 14%|█▍        | 7/50 [00:08<00:47,  1.11s/it] 16%|█▌        | 8/50 [00:09<00:45,  1.09s/it] 18%|█▊        | 9/50 [00:10<00:44,  1.08s/it] 20%|██        | 10/50 [00:11<00:42,  1.07s/it] 22%|██▏       | 11/50 [00:12<00:42,  1.08s/it] 24%|██▍       | 12/50 [00:13<00:40,  1.07s/it] 26%|██▌       | 13/50 [00:14<00:39,  1.07s/it] 28%|██▊       | 14/50 [00:15<00:39,  1.08s/it] 30%|███       | 15/50 [00:16<00:37,  1.06s/it] 32%|███▏      | 16/50 [00:17<00:36,  1.07s/it] 34%|███▍      | 17/50 [00:18<00:34,  1.05s/it] 36%|███▌      | 18/50 [00:19<00:33,  1.06s/it] 38%|███▊      | 19/50 [00:20<00:32,  1.05s/it] 40%|████      | 20/50 [00:21<00:31,  1.04s/it] 42%|████▏     | 21/50 [00:22<00:30,  1.03s/it] 44%|████▍     | 22/50 [00:23<00:28,  1.03s/it] 46%|████▌     | 23/50 [00:24<00:27,  1.02s/it] 48%|████▊     | 24/50 [00:25<00:26,  1.03s/it] 50%|█████     | 25/50 [00:26<00:25,  1.01s/it] 52%|█████▏    | 26/50 [00:27<00:23,  1.01it/s] 54%|█████▍    | 27/50 [00:28<00:22,  1.01it/s] 56%|█████▌    | 28/50 [00:29<00:21,  1.01it/s] 58%|█████▊    | 29/50 [00:30<00:20,  1.03it/s] 60%|██████    | 30/50 [00:31<00:19,  1.04it/s] 62%|██████▏   | 31/50 [00:32<00:18,  1.05it/s] 64%|██████▍   | 32/50 [00:33<00:17,  1.06it/s] 66%|██████▌   | 33/50 [00:34<00:16,  1.06it/s] 68%|██████▊   | 34/50 [00:35<00:15,  1.05it/s] 70%|███████   | 35/50 [00:36<00:14,  1.04it/s] 72%|███████▏  | 36/50 [00:37<00:13,  1.04it/s] 74%|███████▍  | 37/50 [00:38<00:12,  1.06it/s] 76%|███████▌  | 38/50 [00:39<00:11,  1.06it/s] 78%|███████▊  | 39/50 [00:40<00:10,  1.06it/s] 80%|████████  | 40/50 [00:41<00:09,  1.06it/s] 82%|████████▏ | 41/50 [00:42<00:08,  1.05it/s] 84%|████████▍ | 42/50 [00:43<00:07,  1.04it/s] 86%|████████▌ | 43/50 [00:44<00:06,  1.05it/s] 88%|████████▊ | 44/50 [00:44<00:05,  1.05it/s] 90%|█████████ | 45/50 [00:45<00:04,  1.06it/s] 92%|█████████▏| 46/50 [00:46<00:03,  1.06it/s] 94%|█████████▍| 47/50 [00:47<00:02,  1.07it/s] 96%|█████████▌| 48/50 [00:48<00:01,  1.08it/s] 98%|█████████▊| 49/50 [00:49<00:00,  1.07it/s]100%|██████████| 50/50 [00:50<00:00,  1.07it/s]100%|██████████| 50/50 [00:50<00:00,  1.01s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 62140
INFO:root:Parameters : 2307
INFO:root:Iterations : 101
INFO:root:Time : 2.4344170093536377 [s]
INFO:root:Initial cost : 0.9368755872224986 [px]
INFO:root:Final cost : 0.22700752150893902 [px]
INFO:root:Residuals : 62330
INFO:root:Parameters : 2307
INFO:root:Iterations : 101
INFO:root:Time : 2.477108955383301 [s]
INFO:root:Initial cost : 0.796130767276204 [px]
INFO:root:Final cost : 0.20820886055926363 [px]
INFO:root:Residuals : 62224
INFO:root:Parameters : 2301
INFO:root:Iterations : 101
INFO:root:Time : 2.480950117111206 [s]
INFO:root:Initial cost : 0.7960435867635068 [px]
INFO:root:Final cost : 0.2064832347978581 [px]
INFO:root:Residuals : 62228
INFO:root:Parameters : 2301
INFO:root:Iterations : 101
INFO:root:Time : 2.455256938934326 [s]
INFO:root:Initial cost : 0.8056983867068417 [px]
INFO:root:Final cost : 0.20889448800813265 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:59,  1.21s/it]  4%|▍         | 2/50 [00:02<00:57,  1.21s/it]  6%|▌         | 3/50 [00:03<00:53,  1.13s/it]  8%|▊         | 4/50 [00:04<00:50,  1.09s/it] 10%|█         | 5/50 [00:05<00:49,  1.10s/it] 12%|█▏        | 6/50 [00:06<00:50,  1.14s/it] 14%|█▍        | 7/50 [00:07<00:49,  1.15s/it] 16%|█▌        | 8/50 [00:09<00:49,  1.17s/it] 18%|█▊        | 9/50 [00:10<00:48,  1.18s/it] 20%|██        | 10/50 [00:11<00:47,  1.18s/it] 22%|██▏       | 11/50 [00:12<00:45,  1.17s/it] 24%|██▍       | 12/50 [00:13<00:44,  1.17s/it] 26%|██▌       | 13/50 [00:15<00:42,  1.15s/it] 28%|██▊       | 14/50 [00:16<00:39,  1.11s/it] 30%|███       | 15/50 [00:17<00:37,  1.08s/it] 32%|███▏      | 16/50 [00:18<00:35,  1.05s/it] 34%|███▍      | 17/50 [00:19<00:34,  1.03s/it] 36%|███▌      | 18/50 [00:19<00:32,  1.01s/it] 38%|███▊      | 19/50 [00:20<00:30,  1.00it/s] 40%|████      | 20/50 [00:21<00:29,  1.01it/s] 42%|████▏     | 21/50 [00:22<00:28,  1.02it/s] 44%|████▍     | 22/50 [00:23<00:27,  1.03it/s] 46%|████▌     | 23/50 [00:24<00:26,  1.03it/s] 48%|████▊     | 24/50 [00:25<00:25,  1.04it/s] 50%|█████     | 25/50 [00:26<00:23,  1.05it/s] 52%|█████▏    | 26/50 [00:27<00:22,  1.05it/s] 54%|█████▍    | 27/50 [00:28<00:21,  1.06it/s] 56%|█████▌    | 28/50 [00:29<00:20,  1.07it/s] 58%|█████▊    | 29/50 [00:30<00:19,  1.08it/s] 60%|██████    | 30/50 [00:31<00:18,  1.08it/s] 62%|██████▏   | 31/50 [00:32<00:17,  1.09it/s] 64%|██████▍   | 32/50 [00:33<00:16,  1.09it/s] 66%|██████▌   | 33/50 [00:33<00:15,  1.09it/s] 68%|██████▊   | 34/50 [00:34<00:14,  1.10it/s] 70%|███████   | 35/50 [00:35<00:13,  1.09it/s] 72%|███████▏  | 36/50 [00:36<00:12,  1.10it/s] 74%|███████▍  | 37/50 [00:37<00:11,  1.10it/s] 76%|███████▌  | 38/50 [00:38<00:10,  1.10it/s] 78%|███████▊  | 39/50 [00:39<00:09,  1.10it/s] 80%|████████  | 40/50 [00:40<00:09,  1.11it/s] 82%|████████▏ | 41/50 [00:41<00:08,  1.11it/s] 84%|████████▍ | 42/50 [00:42<00:07,  1.11it/s] 86%|████████▌ | 43/50 [00:43<00:06,  1.11it/s] 88%|████████▊ | 44/50 [00:43<00:05,  1.11it/s] 90%|█████████ | 45/50 [00:44<00:04,  1.11it/s] 92%|█████████▏| 46/50 [00:45<00:03,  1.11it/s] 94%|█████████▍| 47/50 [00:46<00:02,  1.11it/s] 96%|█████████▌| 48/50 [00:47<00:01,  1.11it/s] 98%|█████████▊| 49/50 [00:48<00:00,  1.11it/s]100%|██████████| 50/50 [00:49<00:00,  1.11it/s]100%|██████████| 50/50 [00:49<00:00,  1.01it/s]
sequence:445120-3_obj
metrics: {'epe3d_allo_image_all': 1.2486827379465104, 'epe3d_allo_pixel_all': 1.248682741018442, 'epe3d_sf_allo_image_all': 0.04194722447078675, 'epe3d_sf_allo_pixel_all': 0.04194722456714282, 'num_valid_pixels': 5200.0, 'delta_0.05': 0.18423076923076923, 'delta_0.1': 0.49038461538461536, 'delta_0.2': 0.6030769230769231, 'delta_0.4': 0.6053846153846154, 'outlier_0.15': 0.42730769230769233, 'delta_epe_0.1': 0.9121153846153847, 'delta_epe_0.3': 0.9836538461538461, 'delta_epe_0.5': 0.99, 'delta_epe_1.0': 0.9990384615384615, 'outlier_epe_0.25': 0.016923076923076923}
Processing sequence: f14caa-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:59,  1.21s/it]  4%|▍         | 2/50 [00:02<00:58,  1.23s/it]  6%|▌         | 3/50 [00:03<01:00,  1.29s/it]  8%|▊         | 4/50 [00:05<00:59,  1.29s/it] 10%|█         | 5/50 [00:06<01:05,  1.45s/it] 12%|█▏        | 6/50 [00:08<01:01,  1.39s/it] 14%|█▍        | 7/50 [00:09<00:56,  1.32s/it] 16%|█▌        | 8/50 [00:10<00:55,  1.31s/it] 18%|█▊        | 9/50 [00:11<00:54,  1.32s/it] 20%|██        | 10/50 [00:13<00:52,  1.31s/it] 22%|██▏       | 11/50 [00:14<00:50,  1.28s/it] 24%|██▍       | 12/50 [00:15<00:47,  1.25s/it] 26%|██▌       | 13/50 [00:16<00:46,  1.25s/it] 28%|██▊       | 14/50 [00:18<00:46,  1.28s/it] 30%|███       | 15/50 [00:19<00:44,  1.27s/it] 32%|███▏      | 16/50 [00:20<00:42,  1.26s/it] 34%|███▍      | 17/50 [00:21<00:41,  1.26s/it] 36%|███▌      | 18/50 [00:23<00:39,  1.25s/it] 38%|███▊      | 19/50 [00:24<00:38,  1.24s/it] 40%|████      | 20/50 [00:25<00:37,  1.26s/it] 42%|████▏     | 21/50 [00:27<00:38,  1.31s/it] 44%|████▍     | 22/50 [00:28<00:36,  1.30s/it] 46%|████▌     | 23/50 [00:29<00:34,  1.30s/it] 48%|████▊     | 24/50 [00:31<00:33,  1.30s/it] 50%|█████     | 25/50 [00:32<00:33,  1.35s/it] 52%|█████▏    | 26/50 [00:33<00:31,  1.32s/it] 54%|█████▍    | 27/50 [00:35<00:30,  1.31s/it] 56%|█████▌    | 28/50 [00:36<00:28,  1.30s/it] 58%|█████▊    | 29/50 [00:37<00:26,  1.28s/it] 60%|██████    | 30/50 [00:38<00:25,  1.26s/it] 62%|██████▏   | 31/50 [00:40<00:23,  1.26s/it] 64%|██████▍   | 32/50 [00:41<00:22,  1.25s/it] 66%|██████▌   | 33/50 [00:42<00:21,  1.25s/it] 68%|██████▊   | 34/50 [00:43<00:20,  1.25s/it] 70%|███████   | 35/50 [00:44<00:18,  1.24s/it] 72%|███████▏  | 36/50 [00:46<00:17,  1.23s/it] 74%|███████▍  | 37/50 [00:47<00:16,  1.24s/it] 76%|███████▌  | 38/50 [00:48<00:15,  1.32s/it] 78%|███████▊  | 39/50 [00:50<00:14,  1.31s/it] 80%|████████  | 40/50 [00:51<00:12,  1.29s/it] 82%|████████▏ | 41/50 [00:52<00:11,  1.25s/it] 84%|████████▍ | 42/50 [00:53<00:09,  1.22s/it] 86%|████████▌ | 43/50 [00:54<00:08,  1.21s/it] 88%|████████▊ | 44/50 [00:56<00:07,  1.21s/it] 90%|█████████ | 45/50 [00:57<00:05,  1.19s/it] 92%|█████████▏| 46/50 [00:58<00:04,  1.19s/it] 94%|█████████▍| 47/50 [00:59<00:03,  1.19s/it] 96%|█████████▌| 48/50 [01:00<00:02,  1.19s/it] 98%|█████████▊| 49/50 [01:02<00:01,  1.17s/it]100%|██████████| 50/50 [01:03<00:00,  1.19s/it]100%|██████████| 50/50 [01:03<00:00,  1.26s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f2dacfcd430>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:24,  1.73s/it]  4%|▍         | 2/50 [00:03<01:12,  1.50s/it]  6%|▌         | 3/50 [00:04<01:09,  1.47s/it]  8%|▊         | 4/50 [00:05<01:05,  1.42s/it] 10%|█         | 5/50 [00:07<01:00,  1.35s/it] 12%|█▏        | 6/50 [00:08<00:57,  1.30s/it] 14%|█▍        | 7/50 [00:09<00:54,  1.28s/it] 16%|█▌        | 8/50 [00:10<00:53,  1.27s/it] 18%|█▊        | 9/50 [00:11<00:51,  1.26s/it] 20%|██        | 10/50 [00:13<00:49,  1.24s/it] 22%|██▏       | 11/50 [00:14<00:47,  1.23s/it] 24%|██▍       | 12/50 [00:15<00:46,  1.22s/it] 26%|██▌       | 13/50 [00:16<00:44,  1.22s/it] 28%|██▊       | 14/50 [00:18<00:43,  1.22s/it] 30%|███       | 15/50 [00:19<00:42,  1.21s/it] 32%|███▏      | 16/50 [00:20<00:41,  1.22s/it] 34%|███▍      | 17/50 [00:21<00:40,  1.22s/it] 36%|███▌      | 18/50 [00:22<00:39,  1.22s/it] 38%|███▊      | 19/50 [00:24<00:37,  1.22s/it] 40%|████      | 20/50 [00:25<00:36,  1.21s/it] 42%|████▏     | 21/50 [00:26<00:35,  1.21s/it] 44%|████▍     | 22/50 [00:27<00:33,  1.21s/it] 46%|████▌     | 23/50 [00:28<00:32,  1.21s/it] 48%|████▊     | 24/50 [00:30<00:31,  1.21s/it] 50%|█████     | 25/50 [00:31<00:30,  1.21s/it] 52%|█████▏    | 26/50 [00:32<00:28,  1.21s/it] 54%|█████▍    | 27/50 [00:33<00:27,  1.21s/it] 56%|█████▌    | 28/50 [00:34<00:26,  1.20s/it] 58%|█████▊    | 29/50 [00:36<00:25,  1.20s/it] 60%|██████    | 30/50 [00:37<00:23,  1.19s/it] 62%|██████▏   | 31/50 [00:38<00:22,  1.19s/it] 64%|██████▍   | 32/50 [00:39<00:21,  1.19s/it] 66%|██████▌   | 33/50 [00:40<00:20,  1.19s/it] 68%|██████▊   | 34/50 [00:42<00:19,  1.20s/it] 70%|███████   | 35/50 [00:43<00:17,  1.20s/it] 72%|███████▏  | 36/50 [00:44<00:16,  1.19s/it] 74%|███████▍  | 37/50 [00:45<00:15,  1.19s/it] 76%|███████▌  | 38/50 [00:46<00:14,  1.19s/it] 78%|███████▊  | 39/50 [00:48<00:12,  1.18s/it] 80%|████████  | 40/50 [00:49<00:11,  1.18s/it] 82%|████████▏ | 41/50 [00:50<00:10,  1.17s/it] 84%|████████▍ | 42/50 [00:51<00:09,  1.16s/it] 86%|████████▌ | 43/50 [00:52<00:08,  1.16s/it] 88%|████████▊ | 44/50 [00:53<00:06,  1.15s/it] 90%|█████████ | 45/50 [00:54<00:05,  1.14s/it] 92%|█████████▏| 46/50 [00:56<00:04,  1.14s/it] 94%|█████████▍| 47/50 [00:57<00:03,  1.13s/it] 96%|█████████▌| 48/50 [00:58<00:02,  1.13s/it] 98%|█████████▊| 49/50 [00:59<00:01,  1.12s/it]100%|██████████| 50/50 [01:00<00:00,  1.12s/it]100%|██████████| 50/50 [01:00<00:00,  1.21s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 63576
INFO:root:Parameters : 2430
INFO:root:Iterations : 101
INFO:root:Time : 2.397355079650879 [s]
INFO:root:Initial cost : 1.873055102471773 [px]
INFO:root:Final cost : 0.21519598647387686 [px]
INFO:root:Residuals : 64042
INFO:root:Parameters : 2418
INFO:root:Iterations : 101
INFO:root:Time : 2.4474050998687744 [s]
INFO:root:Initial cost : 0.9436847039186046 [px]
INFO:root:Final cost : 0.16521402906849886 [px]
INFO:root:Residuals : 64294
INFO:root:Parameters : 2421
INFO:root:Iterations : 101
INFO:root:Time : 2.4962618350982666 [s]
INFO:root:Initial cost : 0.9310429466839957 [px]
INFO:root:Final cost : 0.16632816418980303 [px]
INFO:root:Residuals : 64454
INFO:root:Parameters : 2424
INFO:root:Iterations : 101
INFO:root:Time : 2.459836959838867 [s]
INFO:root:Initial cost : 0.9352379969280736 [px]
INFO:root:Final cost : 0.16751757060237976 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:01,  1.26s/it]  4%|▍         | 2/50 [00:02<00:59,  1.24s/it]  6%|▌         | 3/50 [00:03<00:57,  1.23s/it]  8%|▊         | 4/50 [00:04<00:56,  1.23s/it] 10%|█         | 5/50 [00:06<00:54,  1.22s/it] 12%|█▏        | 6/50 [00:07<00:53,  1.21s/it] 14%|█▍        | 7/50 [00:08<00:51,  1.21s/it] 16%|█▌        | 8/50 [00:09<00:50,  1.20s/it] 18%|█▊        | 9/50 [00:10<00:49,  1.20s/it] 20%|██        | 10/50 [00:12<00:47,  1.20s/it] 22%|██▏       | 11/50 [00:13<00:46,  1.20s/it] 24%|██▍       | 12/50 [00:14<00:45,  1.20s/it] 26%|██▌       | 13/50 [00:15<00:44,  1.20s/it] 28%|██▊       | 14/50 [00:16<00:43,  1.20s/it] 30%|███       | 15/50 [00:18<00:41,  1.20s/it] 32%|███▏      | 16/50 [00:19<00:40,  1.20s/it] 34%|███▍      | 17/50 [00:20<00:39,  1.20s/it] 36%|███▌      | 18/50 [00:21<00:38,  1.20s/it] 38%|███▊      | 19/50 [00:22<00:37,  1.20s/it] 40%|████      | 20/50 [00:24<00:36,  1.20s/it] 42%|████▏     | 21/50 [00:25<00:34,  1.20s/it] 44%|████▍     | 22/50 [00:26<00:33,  1.20s/it] 46%|████▌     | 23/50 [00:27<00:32,  1.20s/it] 48%|████▊     | 24/50 [00:28<00:31,  1.20s/it] 50%|█████     | 25/50 [00:30<00:29,  1.20s/it] 52%|█████▏    | 26/50 [00:31<00:28,  1.20s/it] 54%|█████▍    | 27/50 [00:32<00:27,  1.20s/it] 56%|█████▌    | 28/50 [00:33<00:26,  1.20s/it] 58%|█████▊    | 29/50 [00:34<00:25,  1.19s/it] 60%|██████    | 30/50 [00:36<00:23,  1.19s/it] 62%|██████▏   | 31/50 [00:37<00:22,  1.19s/it] 64%|██████▍   | 32/50 [00:38<00:21,  1.19s/it] 66%|██████▌   | 33/50 [00:39<00:20,  1.18s/it] 68%|██████▊   | 34/50 [00:40<00:18,  1.18s/it] 70%|███████   | 35/50 [00:41<00:17,  1.18s/it] 72%|███████▏  | 36/50 [00:43<00:16,  1.18s/it] 74%|███████▍  | 37/50 [00:44<00:15,  1.18s/it] 76%|███████▌  | 38/50 [00:45<00:14,  1.17s/it] 78%|███████▊  | 39/50 [00:46<00:12,  1.17s/it] 80%|████████  | 40/50 [00:47<00:11,  1.17s/it] 82%|████████▏ | 41/50 [00:48<00:10,  1.17s/it] 84%|████████▍ | 42/50 [00:50<00:09,  1.16s/it] 86%|████████▌ | 43/50 [00:51<00:08,  1.16s/it] 88%|████████▊ | 44/50 [00:52<00:06,  1.15s/it] 90%|█████████ | 45/50 [00:53<00:05,  1.14s/it] 92%|█████████▏| 46/50 [00:54<00:04,  1.14s/it] 94%|█████████▍| 47/50 [00:55<00:03,  1.13s/it] 96%|█████████▌| 48/50 [00:56<00:02,  1.13s/it] 98%|█████████▊| 49/50 [00:57<00:01,  1.12s/it]100%|██████████| 50/50 [00:59<00:00,  1.12s/it]100%|██████████| 50/50 [00:59<00:00,  1.18s/it]
sequence:f14caa-3_obj
metrics: {'epe3d_allo_image_all': 0.6422793264687061, 'epe3d_allo_pixel_all': 0.6422793270111083, 'epe3d_sf_allo_image_all': 0.04272845729254186, 'epe3d_sf_allo_pixel_all': 0.0427284570256869, 'num_valid_pixels': 3750.0, 'delta_0.05': 0.22106666666666666, 'delta_0.1': 0.704, 'delta_0.2': 0.8610666666666666, 'delta_0.4': 0.8618666666666667, 'outlier_0.15': 0.13893333333333333, 'delta_epe_0.1': 0.9208, 'delta_epe_0.3': 0.9914666666666667, 'delta_epe_0.5': 0.9997333333333334, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.010933333333333333}
Processing sequence: 151c87-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:01,  1.25s/it]  4%|▍         | 2/50 [00:02<01:05,  1.36s/it]  6%|▌         | 3/50 [00:03<01:02,  1.32s/it]  8%|▊         | 4/50 [00:05<01:02,  1.36s/it] 10%|█         | 5/50 [00:06<01:04,  1.44s/it] 12%|█▏        | 6/50 [00:08<01:00,  1.38s/it] 14%|█▍        | 7/50 [00:09<00:58,  1.35s/it] 16%|█▌        | 8/50 [00:10<00:55,  1.33s/it] 18%|█▊        | 9/50 [00:12<00:53,  1.31s/it] 20%|██        | 10/50 [00:13<00:51,  1.30s/it] 22%|██▏       | 11/50 [00:14<00:50,  1.31s/it] 24%|██▍       | 12/50 [00:16<00:50,  1.32s/it] 26%|██▌       | 13/50 [00:17<00:48,  1.32s/it] 28%|██▊       | 14/50 [00:18<00:48,  1.35s/it] 30%|███       | 15/50 [00:20<00:46,  1.34s/it] 32%|███▏      | 16/50 [00:21<00:46,  1.36s/it] 34%|███▍      | 17/50 [00:22<00:44,  1.36s/it] 36%|███▌      | 18/50 [00:24<00:42,  1.34s/it] 38%|███▊      | 19/50 [00:25<00:41,  1.35s/it] 40%|████      | 20/50 [00:26<00:40,  1.35s/it] 42%|████▏     | 21/50 [00:28<00:38,  1.33s/it] 44%|████▍     | 22/50 [00:29<00:37,  1.33s/it] 46%|████▌     | 23/50 [00:30<00:35,  1.33s/it] 48%|████▊     | 24/50 [00:32<00:34,  1.32s/it] 50%|█████     | 25/50 [00:33<00:32,  1.31s/it] 52%|█████▏    | 26/50 [00:34<00:31,  1.30s/it] 54%|█████▍    | 27/50 [00:35<00:29,  1.28s/it] 56%|█████▌    | 28/50 [00:37<00:28,  1.30s/it] 58%|█████▊    | 29/50 [00:38<00:27,  1.30s/it] 60%|██████    | 30/50 [00:39<00:25,  1.28s/it] 62%|██████▏   | 31/50 [00:41<00:24,  1.27s/it] 64%|██████▍   | 32/50 [00:42<00:22,  1.27s/it] 66%|██████▌   | 33/50 [00:43<00:23,  1.36s/it] 68%|██████▊   | 34/50 [00:45<00:21,  1.33s/it] 70%|███████   | 35/50 [00:46<00:19,  1.31s/it] 72%|███████▏  | 36/50 [00:47<00:18,  1.29s/it] 74%|███████▍  | 37/50 [00:48<00:16,  1.28s/it] 76%|███████▌  | 38/50 [00:50<00:15,  1.25s/it] 78%|███████▊  | 39/50 [00:51<00:13,  1.24s/it] 80%|████████  | 40/50 [00:52<00:12,  1.24s/it] 82%|████████▏ | 41/50 [00:53<00:11,  1.22s/it] 84%|████████▍ | 42/50 [00:54<00:09,  1.22s/it] 86%|████████▌ | 43/50 [00:56<00:08,  1.21s/it] 88%|████████▊ | 44/50 [00:57<00:07,  1.21s/it] 90%|█████████ | 45/50 [00:58<00:06,  1.21s/it] 92%|█████████▏| 46/50 [00:59<00:04,  1.22s/it] 94%|█████████▍| 47/50 [01:00<00:03,  1.20s/it] 96%|█████████▌| 48/50 [01:02<00:02,  1.23s/it] 98%|█████████▊| 49/50 [01:03<00:01,  1.23s/it]100%|██████████| 50/50 [01:04<00:00,  1.27s/it]100%|██████████| 50/50 [01:04<00:00,  1.30s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f3416d16d50>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:25,  1.75s/it]  4%|▍         | 2/50 [00:03<01:11,  1.48s/it]  6%|▌         | 3/50 [00:04<01:06,  1.42s/it]  8%|▊         | 4/50 [00:05<01:02,  1.35s/it] 10%|█         | 5/50 [00:06<00:59,  1.32s/it] 12%|█▏        | 6/50 [00:08<00:57,  1.30s/it] 14%|█▍        | 7/50 [00:09<00:54,  1.27s/it] 16%|█▌        | 8/50 [00:10<00:52,  1.25s/it] 18%|█▊        | 9/50 [00:11<00:50,  1.24s/it] 20%|██        | 10/50 [00:13<00:49,  1.24s/it] 22%|██▏       | 11/50 [00:14<00:48,  1.25s/it] 24%|██▍       | 12/50 [00:15<00:47,  1.25s/it] 26%|██▌       | 13/50 [00:16<00:46,  1.25s/it] 28%|██▊       | 14/50 [00:18<00:45,  1.27s/it] 30%|███       | 15/50 [00:19<00:43,  1.25s/it] 32%|███▏      | 16/50 [00:20<00:42,  1.26s/it] 34%|███▍      | 17/50 [00:21<00:41,  1.26s/it] 36%|███▌      | 18/50 [00:23<00:40,  1.27s/it] 38%|███▊      | 19/50 [00:24<00:39,  1.27s/it] 40%|████      | 20/50 [00:25<00:38,  1.28s/it] 42%|████▏     | 21/50 [00:26<00:36,  1.27s/it] 44%|████▍     | 22/50 [00:28<00:35,  1.27s/it] 46%|████▌     | 23/50 [00:29<00:34,  1.26s/it] 48%|████▊     | 24/50 [00:30<00:32,  1.25s/it] 50%|█████     | 25/50 [00:31<00:31,  1.24s/it] 52%|█████▏    | 26/50 [00:33<00:29,  1.24s/it] 54%|█████▍    | 27/50 [00:34<00:28,  1.23s/it] 56%|█████▌    | 28/50 [00:35<00:27,  1.23s/it] 58%|█████▊    | 29/50 [00:36<00:25,  1.22s/it] 60%|██████    | 30/50 [00:38<00:24,  1.22s/it] 62%|██████▏   | 31/50 [00:39<00:23,  1.23s/it] 64%|██████▍   | 32/50 [00:40<00:22,  1.23s/it] 66%|██████▌   | 33/50 [00:41<00:20,  1.23s/it] 68%|██████▊   | 34/50 [00:42<00:19,  1.23s/it] 70%|███████   | 35/50 [00:44<00:18,  1.23s/it] 72%|███████▏  | 36/50 [00:45<00:17,  1.23s/it] 74%|███████▍  | 37/50 [00:46<00:16,  1.23s/it] 76%|███████▌  | 38/50 [00:47<00:14,  1.22s/it] 78%|███████▊  | 39/50 [00:49<00:13,  1.22s/it] 80%|████████  | 40/50 [00:50<00:12,  1.22s/it] 82%|████████▏ | 41/50 [00:51<00:10,  1.22s/it] 84%|████████▍ | 42/50 [00:52<00:09,  1.21s/it] 86%|████████▌ | 43/50 [00:53<00:08,  1.20s/it] 88%|████████▊ | 44/50 [00:55<00:07,  1.20s/it] 90%|█████████ | 45/50 [00:56<00:05,  1.20s/it] 92%|█████████▏| 46/50 [00:57<00:04,  1.19s/it] 94%|█████████▍| 47/50 [00:58<00:03,  1.19s/it] 96%|█████████▌| 48/50 [00:59<00:02,  1.19s/it] 98%|█████████▊| 49/50 [01:00<00:01,  1.19s/it]100%|██████████| 50/50 [01:02<00:00,  1.19s/it]100%|██████████| 50/50 [01:02<00:00,  1.25s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 72016
INFO:root:Parameters : 2535
INFO:root:Iterations : 101
INFO:root:Time : 2.702418088912964 [s]
INFO:root:Initial cost : 1.2441017743823997 [px]
INFO:root:Final cost : 0.18255863700228595 [px]
INFO:root:Residuals : 72254
INFO:root:Parameters : 2547
INFO:root:Iterations : 101
INFO:root:Time : 2.660295009613037 [s]
INFO:root:Initial cost : 0.6777560026661369 [px]
INFO:root:Final cost : 0.1747023898035406 [px]
INFO:root:Residuals : 72148
INFO:root:Parameters : 2544
INFO:root:Iterations : 101
INFO:root:Time : 2.700068950653076 [s]
INFO:root:Initial cost : 0.6686364566457997 [px]
INFO:root:Final cost : 0.16680935741090255 [px]
INFO:root:Residuals : 72262
INFO:root:Parameters : 2547
INFO:root:Iterations : 101
INFO:root:Time : 2.710706949234009 [s]
INFO:root:Initial cost : 0.6621887195825096 [px]
INFO:root:Final cost : 0.1736739493004697 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:03,  1.30s/it]  4%|▍         | 2/50 [00:02<01:01,  1.28s/it]  6%|▌         | 3/50 [00:03<00:59,  1.26s/it]  8%|▊         | 4/50 [00:05<00:57,  1.24s/it] 10%|█         | 5/50 [00:06<00:55,  1.23s/it] 12%|█▏        | 6/50 [00:07<00:53,  1.22s/it] 14%|█▍        | 7/50 [00:08<00:52,  1.21s/it] 16%|█▌        | 8/50 [00:09<00:50,  1.20s/it] 18%|█▊        | 9/50 [00:11<00:49,  1.20s/it] 20%|██        | 10/50 [00:12<00:47,  1.20s/it] 22%|██▏       | 11/50 [00:13<00:46,  1.20s/it] 24%|██▍       | 12/50 [00:14<00:45,  1.21s/it] 26%|██▌       | 13/50 [00:15<00:44,  1.21s/it] 28%|██▊       | 14/50 [00:17<00:44,  1.22s/it] 30%|███       | 15/50 [00:18<00:43,  1.23s/it] 32%|███▏      | 16/50 [00:19<00:42,  1.24s/it] 34%|███▍      | 17/50 [00:20<00:40,  1.24s/it] 36%|███▌      | 18/50 [00:22<00:39,  1.24s/it] 38%|███▊      | 19/50 [00:23<00:38,  1.24s/it] 40%|████      | 20/50 [00:24<00:37,  1.24s/it] 42%|████▏     | 21/50 [00:25<00:35,  1.24s/it] 44%|████▍     | 22/50 [00:27<00:34,  1.24s/it] 46%|████▌     | 23/50 [00:28<00:33,  1.23s/it] 48%|████▊     | 24/50 [00:29<00:31,  1.23s/it] 50%|█████     | 25/50 [00:30<00:30,  1.23s/it] 52%|█████▏    | 26/50 [00:31<00:29,  1.22s/it] 54%|█████▍    | 27/50 [00:33<00:28,  1.22s/it] 56%|█████▌    | 28/50 [00:34<00:26,  1.21s/it] 58%|█████▊    | 29/50 [00:35<00:25,  1.21s/it] 60%|██████    | 30/50 [00:36<00:24,  1.21s/it] 62%|██████▏   | 31/50 [00:37<00:23,  1.21s/it] 64%|██████▍   | 32/50 [00:39<00:21,  1.21s/it] 66%|██████▌   | 33/50 [00:40<00:20,  1.21s/it] 68%|██████▊   | 34/50 [00:41<00:19,  1.22s/it] 70%|███████   | 35/50 [00:42<00:18,  1.21s/it] 72%|███████▏  | 36/50 [00:44<00:17,  1.23s/it] 74%|███████▍  | 37/50 [00:45<00:15,  1.22s/it] 76%|███████▌  | 38/50 [00:46<00:14,  1.21s/it] 78%|███████▊  | 39/50 [00:47<00:13,  1.21s/it] 80%|████████  | 40/50 [00:48<00:12,  1.20s/it] 82%|████████▏ | 41/50 [00:50<00:10,  1.19s/it] 84%|████████▍ | 42/50 [00:51<00:09,  1.19s/it] 86%|████████▌ | 43/50 [00:52<00:08,  1.18s/it] 88%|████████▊ | 44/50 [00:53<00:07,  1.18s/it] 90%|█████████ | 45/50 [00:54<00:05,  1.17s/it] 92%|█████████▏| 46/50 [00:55<00:04,  1.17s/it] 94%|█████████▍| 47/50 [00:57<00:03,  1.17s/it] 96%|█████████▌| 48/50 [00:58<00:02,  1.17s/it] 98%|█████████▊| 49/50 [00:59<00:01,  1.17s/it]100%|██████████| 50/50 [01:00<00:00,  1.17s/it]100%|██████████| 50/50 [01:00<00:00,  1.21s/it]
sequence:151c87-3_obj
metrics: {'epe3d_allo_image_all': 0.46085755348205565, 'epe3d_allo_pixel_all': 0.4608575545416938, 'epe3d_sf_allo_image_all': 0.027804572833701968, 'epe3d_sf_allo_pixel_all': 0.02780457271469964, 'num_valid_pixels': 2250.0, 'delta_0.05': 0.03288888888888889, 'delta_0.1': 0.5626666666666666, 'delta_0.2': 0.8737777777777778, 'delta_0.4': 0.8737777777777778, 'outlier_0.15': 0.128, 'delta_epe_0.1': 0.9937777777777778, 'delta_epe_0.3': 1.0, 'delta_epe_0.5': 1.0, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.0}
Processing sequence: b0b6e8-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:02,  1.27s/it]  4%|▍         | 2/50 [00:02<01:11,  1.49s/it]  6%|▌         | 3/50 [00:04<01:04,  1.38s/it]  8%|▊         | 4/50 [00:05<01:02,  1.37s/it] 10%|█         | 5/50 [00:06<01:00,  1.35s/it] 12%|█▏        | 6/50 [00:08<00:58,  1.32s/it] 14%|█▍        | 7/50 [00:09<00:55,  1.29s/it] 16%|█▌        | 8/50 [00:10<00:53,  1.27s/it] 18%|█▊        | 9/50 [00:11<00:51,  1.25s/it] 20%|██        | 10/50 [00:13<00:50,  1.25s/it] 22%|██▏       | 11/50 [00:14<00:48,  1.25s/it] 24%|██▍       | 12/50 [00:15<00:48,  1.28s/it] 26%|██▌       | 13/50 [00:16<00:46,  1.27s/it] 28%|██▊       | 14/50 [00:18<00:45,  1.26s/it] 30%|███       | 15/50 [00:19<00:44,  1.27s/it] 32%|███▏      | 16/50 [00:20<00:42,  1.26s/it] 34%|███▍      | 17/50 [00:21<00:41,  1.25s/it] 36%|███▌      | 18/50 [00:23<00:40,  1.27s/it] 38%|███▊      | 19/50 [00:24<00:39,  1.26s/it] 40%|████      | 20/50 [00:25<00:38,  1.27s/it] 42%|████▏     | 21/50 [00:26<00:36,  1.25s/it] 44%|████▍     | 22/50 [00:28<00:34,  1.24s/it] 46%|████▌     | 23/50 [00:29<00:34,  1.27s/it] 48%|████▊     | 24/50 [00:30<00:32,  1.25s/it] 50%|█████     | 25/50 [00:31<00:30,  1.24s/it] 52%|█████▏    | 26/50 [00:33<00:30,  1.25s/it] 54%|█████▍    | 27/50 [00:34<00:28,  1.25s/it] 56%|█████▌    | 28/50 [00:35<00:27,  1.25s/it] 58%|█████▊    | 29/50 [00:36<00:25,  1.23s/it] 60%|██████    | 30/50 [00:38<00:25,  1.25s/it] 62%|██████▏   | 31/50 [00:39<00:23,  1.23s/it] 64%|██████▍   | 32/50 [00:40<00:22,  1.23s/it] 66%|██████▌   | 33/50 [00:41<00:20,  1.21s/it] 68%|██████▊   | 34/50 [00:43<00:19,  1.25s/it] 70%|███████   | 35/50 [00:44<00:19,  1.28s/it] 72%|███████▏  | 36/50 [00:45<00:17,  1.26s/it] 74%|███████▍  | 37/50 [00:46<00:16,  1.27s/it] 76%|███████▌  | 38/50 [00:48<00:15,  1.27s/it] 78%|███████▊  | 39/50 [00:49<00:14,  1.29s/it] 80%|████████  | 40/50 [00:50<00:12,  1.27s/it] 82%|████████▏ | 41/50 [00:52<00:11,  1.28s/it] 84%|████████▍ | 42/50 [00:53<00:10,  1.26s/it] 86%|████████▌ | 43/50 [00:54<00:08,  1.28s/it] 88%|████████▊ | 44/50 [00:55<00:07,  1.28s/it] 90%|█████████ | 45/50 [00:57<00:06,  1.27s/it] 92%|█████████▏| 46/50 [00:58<00:05,  1.26s/it] 94%|█████████▍| 47/50 [00:59<00:03,  1.30s/it] 96%|█████████▌| 48/50 [01:01<00:02,  1.29s/it] 98%|█████████▊| 49/50 [01:02<00:01,  1.25s/it]100%|██████████| 50/50 [01:03<00:00,  1.27s/it]100%|██████████| 50/50 [01:03<00:00,  1.27s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f2cc10c08c0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:24,  1.73s/it]  4%|▍         | 2/50 [00:03<01:12,  1.50s/it]  6%|▌         | 3/50 [00:04<01:07,  1.44s/it]  8%|▊         | 4/50 [00:05<01:03,  1.39s/it] 10%|█         | 5/50 [00:07<01:02,  1.39s/it] 12%|█▏        | 6/50 [00:08<00:59,  1.35s/it] 14%|█▍        | 7/50 [00:09<00:56,  1.32s/it] 16%|█▌        | 8/50 [00:10<00:54,  1.30s/it] 18%|█▊        | 9/50 [00:12<00:53,  1.30s/it] 20%|██        | 10/50 [00:13<00:52,  1.31s/it] 22%|██▏       | 11/50 [00:14<00:50,  1.28s/it] 24%|██▍       | 12/50 [00:16<00:48,  1.27s/it] 26%|██▌       | 13/50 [00:17<00:46,  1.25s/it] 28%|██▊       | 14/50 [00:18<00:44,  1.24s/it] 30%|███       | 15/50 [00:19<00:43,  1.24s/it] 32%|███▏      | 16/50 [00:20<00:42,  1.24s/it] 34%|███▍      | 17/50 [00:22<00:40,  1.24s/it] 36%|███▌      | 18/50 [00:23<00:39,  1.25s/it] 38%|███▊      | 19/50 [00:24<00:38,  1.25s/it] 40%|████      | 20/50 [00:25<00:37,  1.24s/it] 42%|████▏     | 21/50 [00:27<00:36,  1.25s/it] 44%|████▍     | 22/50 [00:28<00:34,  1.24s/it] 46%|████▌     | 23/50 [00:29<00:33,  1.24s/it] 48%|████▊     | 24/50 [00:30<00:32,  1.23s/it] 50%|█████     | 25/50 [00:32<00:30,  1.23s/it] 52%|█████▏    | 26/50 [00:33<00:29,  1.23s/it] 54%|█████▍    | 27/50 [00:34<00:28,  1.23s/it] 56%|█████▌    | 28/50 [00:35<00:27,  1.23s/it] 58%|█████▊    | 29/50 [00:36<00:25,  1.23s/it] 60%|██████    | 30/50 [00:38<00:24,  1.23s/it] 62%|██████▏   | 31/50 [00:39<00:23,  1.22s/it] 64%|██████▍   | 32/50 [00:40<00:21,  1.22s/it] 66%|██████▌   | 33/50 [00:41<00:20,  1.22s/it] 68%|██████▊   | 34/50 [00:43<00:19,  1.22s/it] 70%|███████   | 35/50 [00:44<00:18,  1.22s/it] 72%|███████▏  | 36/50 [00:45<00:17,  1.23s/it] 74%|███████▍  | 37/50 [00:46<00:15,  1.22s/it] 76%|███████▌  | 38/50 [00:47<00:14,  1.22s/it] 78%|███████▊  | 39/50 [00:49<00:13,  1.22s/it] 80%|████████  | 40/50 [00:50<00:12,  1.22s/it] 82%|████████▏ | 41/50 [00:51<00:10,  1.22s/it] 84%|████████▍ | 42/50 [00:52<00:09,  1.22s/it] 86%|████████▌ | 43/50 [00:54<00:08,  1.22s/it] 88%|████████▊ | 44/50 [00:55<00:07,  1.21s/it] 90%|█████████ | 45/50 [00:56<00:06,  1.21s/it] 92%|█████████▏| 46/50 [00:57<00:04,  1.21s/it] 94%|█████████▍| 47/50 [00:58<00:03,  1.20s/it] 96%|█████████▌| 48/50 [01:00<00:02,  1.20s/it] 98%|█████████▊| 49/50 [01:01<00:01,  1.20s/it]100%|██████████| 50/50 [01:02<00:00,  1.20s/it]100%|██████████| 50/50 [01:02<00:00,  1.25s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 64992
INFO:root:Parameters : 2445
INFO:root:Iterations : 101
INFO:root:Time : 2.4389150142669678 [s]
INFO:root:Initial cost : 2.334036715558018 [px]
INFO:root:Final cost : 0.48779251437649335 [px]
INFO:root:Residuals : 65438
INFO:root:Parameters : 2445
INFO:root:Iterations : 101
INFO:root:Time : 2.4714620113372803 [s]
INFO:root:Initial cost : 1.6132180486628314 [px]
INFO:root:Final cost : 0.5225716448353929 [px]
INFO:root:Residuals : 63598
INFO:root:Parameters : 2391
INFO:root:Iterations : 101
INFO:root:Time : 2.434601068496704 [s]
INFO:root:Initial cost : 1.4755046743251596 [px]
INFO:root:Final cost : 0.5075316869209981 [px]
INFO:root:Residuals : 63452
INFO:root:Parameters : 2385
INFO:root:Iterations : 101
INFO:root:Time : 2.427172899246216 [s]
INFO:root:Initial cost : 1.4369354055202939 [px]
INFO:root:Final cost : 0.5143952336613103 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:05,  1.33s/it]  4%|▍         | 2/50 [00:02<01:02,  1.30s/it]  6%|▌         | 3/50 [00:03<01:00,  1.28s/it]  8%|▊         | 4/50 [00:05<00:58,  1.27s/it] 10%|█         | 5/50 [00:06<00:56,  1.26s/it] 12%|█▏        | 6/50 [00:07<00:55,  1.26s/it] 14%|█▍        | 7/50 [00:08<00:53,  1.25s/it] 16%|█▌        | 8/50 [00:10<00:52,  1.25s/it] 18%|█▊        | 9/50 [00:11<00:51,  1.25s/it] 20%|██        | 10/50 [00:12<00:49,  1.24s/it] 22%|██▏       | 11/50 [00:13<00:48,  1.23s/it] 24%|██▍       | 12/50 [00:14<00:46,  1.22s/it] 26%|██▌       | 13/50 [00:16<00:45,  1.22s/it] 28%|██▊       | 14/50 [00:17<00:43,  1.21s/it] 30%|███       | 15/50 [00:18<00:42,  1.21s/it] 32%|███▏      | 16/50 [00:19<00:41,  1.21s/it] 34%|███▍      | 17/50 [00:21<00:40,  1.22s/it] 36%|███▌      | 18/50 [00:22<00:38,  1.22s/it] 38%|███▊      | 19/50 [00:23<00:37,  1.22s/it] 40%|████      | 20/50 [00:24<00:36,  1.22s/it] 42%|████▏     | 21/50 [00:25<00:35,  1.22s/it] 44%|████▍     | 22/50 [00:27<00:34,  1.22s/it] 46%|████▌     | 23/50 [00:28<00:32,  1.22s/it] 48%|████▊     | 24/50 [00:29<00:31,  1.22s/it] 50%|█████     | 25/50 [00:30<00:30,  1.22s/it] 52%|█████▏    | 26/50 [00:32<00:29,  1.22s/it] 54%|█████▍    | 27/50 [00:33<00:27,  1.22s/it] 56%|█████▌    | 28/50 [00:34<00:26,  1.22s/it] 58%|█████▊    | 29/50 [00:35<00:25,  1.22s/it] 60%|██████    | 30/50 [00:36<00:24,  1.21s/it] 62%|██████▏   | 31/50 [00:38<00:23,  1.22s/it] 64%|██████▍   | 32/50 [00:39<00:21,  1.21s/it] 66%|██████▌   | 33/50 [00:40<00:20,  1.21s/it] 68%|██████▊   | 34/50 [00:41<00:19,  1.21s/it] 70%|███████   | 35/50 [00:42<00:18,  1.20s/it] 72%|███████▏  | 36/50 [00:44<00:16,  1.20s/it] 74%|███████▍  | 37/50 [00:45<00:15,  1.20s/it] 76%|███████▌  | 38/50 [00:46<00:14,  1.20s/it] 78%|███████▊  | 39/50 [00:47<00:13,  1.20s/it] 80%|████████  | 40/50 [00:48<00:11,  1.19s/it] 82%|████████▏ | 41/50 [00:50<00:10,  1.19s/it] 84%|████████▍ | 42/50 [00:51<00:09,  1.19s/it] 86%|████████▌ | 43/50 [00:52<00:08,  1.19s/it] 88%|████████▊ | 44/50 [00:53<00:07,  1.19s/it] 90%|█████████ | 45/50 [00:54<00:05,  1.19s/it] 92%|█████████▏| 46/50 [00:55<00:04,  1.19s/it] 94%|█████████▍| 47/50 [00:57<00:03,  1.19s/it] 96%|█████████▌| 48/50 [00:58<00:02,  1.19s/it] 98%|█████████▊| 49/50 [00:59<00:01,  1.19s/it]100%|██████████| 50/50 [01:00<00:00,  1.18s/it]100%|██████████| 50/50 [01:00<00:00,  1.21s/it]
sequence:b0b6e8-3_obj
metrics: {'epe3d_allo_image_all': 0.55134392619133, 'epe3d_allo_pixel_all': 0.5513439268476508, 'epe3d_sf_allo_image_all': 0.060070847836323084, 'epe3d_sf_allo_pixel_all': 0.06007084788231368, 'num_valid_pixels': 8900.0, 'delta_0.05': 0.7541573033707866, 'delta_0.1': 0.8247191011235955, 'delta_0.2': 0.8349438202247191, 'delta_0.4': 0.8349438202247191, 'outlier_0.15': 0.16539325842696628, 'delta_epe_0.1': 0.8631460674157303, 'delta_epe_0.3': 0.9496629213483146, 'delta_epe_0.5': 0.9998876404494382, 'delta_epe_1.0': 0.9998876404494382, 'outlier_epe_0.25': 0.07168539325842696}
Processing sequence: 7a54cd-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:44,  1.11it/s]  4%|▍         | 2/50 [00:01<00:47,  1.02it/s]  6%|▌         | 3/50 [00:02<00:47,  1.00s/it]  8%|▊         | 4/50 [00:03<00:46,  1.01s/it] 10%|█         | 5/50 [00:05<00:50,  1.12s/it] 12%|█▏        | 6/50 [00:06<00:47,  1.07s/it] 14%|█▍        | 7/50 [00:07<00:44,  1.04s/it] 16%|█▌        | 8/50 [00:08<00:42,  1.02s/it] 18%|█▊        | 9/50 [00:09<00:41,  1.02s/it] 20%|██        | 10/50 [00:10<00:39,  1.00it/s] 22%|██▏       | 11/50 [00:11<00:38,  1.01it/s] 24%|██▍       | 12/50 [00:12<00:37,  1.01it/s] 26%|██▌       | 13/50 [00:13<00:36,  1.00it/s] 28%|██▊       | 14/50 [00:14<00:35,  1.01it/s] 30%|███       | 15/50 [00:15<00:34,  1.02it/s] 32%|███▏      | 16/50 [00:16<00:33,  1.03it/s] 34%|███▍      | 17/50 [00:17<00:32,  1.02it/s] 36%|███▌      | 18/50 [00:18<00:31,  1.02it/s] 38%|███▊      | 19/50 [00:19<00:30,  1.03it/s] 40%|████      | 20/50 [00:19<00:29,  1.03it/s] 42%|████▏     | 21/50 [00:20<00:28,  1.02it/s] 44%|████▍     | 22/50 [00:21<00:27,  1.02it/s] 46%|████▌     | 23/50 [00:22<00:26,  1.03it/s] 48%|████▊     | 24/50 [00:23<00:25,  1.02it/s] 50%|█████     | 25/50 [00:24<00:24,  1.02it/s] 52%|█████▏    | 26/50 [00:25<00:23,  1.03it/s] 54%|█████▍    | 27/50 [00:26<00:22,  1.03it/s] 56%|█████▌    | 28/50 [00:27<00:21,  1.03it/s] 58%|█████▊    | 29/50 [00:28<00:20,  1.03it/s] 60%|██████    | 30/50 [00:29<00:19,  1.02it/s] 62%|██████▏   | 31/50 [00:30<00:18,  1.02it/s] 64%|██████▍   | 32/50 [00:31<00:17,  1.00it/s] 66%|██████▌   | 33/50 [00:32<00:17,  1.00s/it] 68%|██████▊   | 34/50 [00:33<00:15,  1.00it/s] 70%|███████   | 35/50 [00:34<00:14,  1.00it/s] 72%|███████▏  | 36/50 [00:35<00:13,  1.01it/s] 74%|███████▍  | 37/50 [00:36<00:12,  1.00it/s] 76%|███████▌  | 38/50 [00:37<00:11,  1.01it/s] 78%|███████▊  | 39/50 [00:38<00:11,  1.00s/it] 80%|████████  | 40/50 [00:39<00:10,  1.01s/it] 82%|████████▏ | 41/50 [00:40<00:09,  1.00s/it] 84%|████████▍ | 42/50 [00:41<00:08,  1.01s/it] 86%|████████▌ | 43/50 [00:42<00:07,  1.01s/it] 88%|████████▊ | 44/50 [00:43<00:06,  1.02s/it] 90%|█████████ | 45/50 [00:44<00:05,  1.02s/it] 92%|█████████▏| 46/50 [00:45<00:04,  1.02s/it] 94%|█████████▍| 47/50 [00:46<00:03,  1.01s/it] 96%|█████████▌| 48/50 [00:47<00:02,  1.01s/it] 98%|█████████▊| 49/50 [00:48<00:01,  1.01s/it]100%|██████████| 50/50 [00:49<00:00,  1.02s/it]100%|██████████| 50/50 [00:49<00:00,  1.00it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f2d2c4608c0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]  4%|▍         | 2/50 [00:02<00:54,  1.13s/it]  6%|▌         | 3/50 [00:03<00:48,  1.03s/it]  8%|▊         | 4/50 [00:04<00:45,  1.01it/s] 10%|█         | 5/50 [00:05<00:44,  1.01it/s] 12%|█▏        | 6/50 [00:06<00:42,  1.03it/s] 14%|█▍        | 7/50 [00:07<00:40,  1.06it/s] 16%|█▌        | 8/50 [00:07<00:39,  1.07it/s] 18%|█▊        | 9/50 [00:08<00:37,  1.09it/s] 20%|██        | 10/50 [00:09<00:36,  1.09it/s] 22%|██▏       | 11/50 [00:10<00:35,  1.10it/s] 24%|██▍       | 12/50 [00:11<00:35,  1.08it/s] 26%|██▌       | 13/50 [00:12<00:33,  1.09it/s] 28%|██▊       | 14/50 [00:13<00:33,  1.08it/s] 30%|███       | 15/50 [00:14<00:31,  1.11it/s] 32%|███▏      | 16/50 [00:15<00:30,  1.11it/s] 34%|███▍      | 17/50 [00:16<00:29,  1.12it/s] 36%|███▌      | 18/50 [00:16<00:28,  1.12it/s] 38%|███▊      | 19/50 [00:17<00:27,  1.12it/s] 40%|████      | 20/50 [00:18<00:26,  1.12it/s] 42%|████▏     | 21/50 [00:19<00:25,  1.12it/s] 44%|████▍     | 22/50 [00:20<00:24,  1.12it/s] 46%|████▌     | 23/50 [00:21<00:24,  1.12it/s] 48%|████▊     | 24/50 [00:22<00:23,  1.11it/s] 50%|█████     | 25/50 [00:23<00:22,  1.10it/s] 52%|█████▏    | 26/50 [00:24<00:21,  1.10it/s] 54%|█████▍    | 27/50 [00:25<00:20,  1.11it/s] 56%|█████▌    | 28/50 [00:25<00:19,  1.11it/s] 58%|█████▊    | 29/50 [00:26<00:18,  1.11it/s] 60%|██████    | 30/50 [00:27<00:18,  1.11it/s] 62%|██████▏   | 31/50 [00:28<00:17,  1.11it/s] 64%|██████▍   | 32/50 [00:29<00:16,  1.10it/s] 66%|██████▌   | 33/50 [00:30<00:15,  1.10it/s] 68%|██████▊   | 34/50 [00:31<00:14,  1.10it/s] 70%|███████   | 35/50 [00:32<00:13,  1.10it/s] 72%|███████▏  | 36/50 [00:33<00:12,  1.10it/s] 74%|███████▍  | 37/50 [00:34<00:11,  1.09it/s] 76%|███████▌  | 38/50 [00:35<00:11,  1.09it/s] 78%|███████▊  | 39/50 [00:35<00:10,  1.09it/s] 80%|████████  | 40/50 [00:36<00:09,  1.08it/s] 82%|████████▏ | 41/50 [00:37<00:08,  1.08it/s] 84%|████████▍ | 42/50 [00:38<00:07,  1.08it/s] 86%|████████▌ | 43/50 [00:39<00:06,  1.08it/s] 88%|████████▊ | 44/50 [00:40<00:05,  1.08it/s] 90%|█████████ | 45/50 [00:41<00:04,  1.08it/s] 92%|█████████▏| 46/50 [00:42<00:03,  1.08it/s] 94%|█████████▍| 47/50 [00:43<00:02,  1.08it/s] 96%|█████████▌| 48/50 [00:44<00:01,  1.08it/s] 98%|█████████▊| 49/50 [00:45<00:00,  1.07it/s]100%|██████████| 50/50 [00:46<00:00,  1.07it/s]100%|██████████| 50/50 [00:46<00:00,  1.08it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 65150
INFO:root:Parameters : 2379
INFO:root:Iterations : 101
INFO:root:Time : 2.441365957260132 [s]
INFO:root:Initial cost : 1.1770109169827574 [px]
INFO:root:Final cost : 0.38969970114998886 [px]
INFO:root:Residuals : 65180
INFO:root:Parameters : 2349
INFO:root:Iterations : 101
INFO:root:Time : 2.5002169609069824 [s]
INFO:root:Initial cost : 0.8415376107580749 [px]
INFO:root:Final cost : 0.28922688552511866 [px]
INFO:root:Residuals : 65574
INFO:root:Parameters : 2364
INFO:root:Iterations : 101
INFO:root:Time : 2.4774210453033447 [s]
INFO:root:Initial cost : 0.8280476702259533 [px]
INFO:root:Final cost : 0.36061910166592903 [px]
INFO:root:Residuals : 65274
INFO:root:Parameters : 2355
INFO:root:Iterations : 101
INFO:root:Time : 2.4991469383239746 [s]
INFO:root:Initial cost : 0.79169057146102 [px]
INFO:root:Final cost : 0.2962842401690242 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:52,  1.06s/it]  4%|▍         | 2/50 [00:02<00:48,  1.00s/it]  6%|▌         | 3/50 [00:02<00:45,  1.03it/s]  8%|▊         | 4/50 [00:03<00:44,  1.04it/s] 10%|█         | 5/50 [00:04<00:42,  1.06it/s] 12%|█▏        | 6/50 [00:05<00:41,  1.07it/s] 14%|█▍        | 7/50 [00:06<00:40,  1.07it/s] 16%|█▌        | 8/50 [00:07<00:38,  1.08it/s] 18%|█▊        | 9/50 [00:08<00:37,  1.09it/s] 20%|██        | 10/50 [00:09<00:36,  1.09it/s] 22%|██▏       | 11/50 [00:10<00:35,  1.10it/s] 24%|██▍       | 12/50 [00:11<00:34,  1.10it/s] 26%|██▌       | 13/50 [00:12<00:33,  1.10it/s] 28%|██▊       | 14/50 [00:12<00:32,  1.10it/s] 30%|███       | 15/50 [00:13<00:31,  1.10it/s] 32%|███▏      | 16/50 [00:14<00:30,  1.10it/s] 34%|███▍      | 17/50 [00:15<00:29,  1.10it/s] 36%|███▌      | 18/50 [00:16<00:28,  1.10it/s] 38%|███▊      | 19/50 [00:17<00:28,  1.10it/s] 40%|████      | 20/50 [00:18<00:27,  1.10it/s] 42%|████▏     | 21/50 [00:19<00:26,  1.10it/s] 44%|████▍     | 22/50 [00:20<00:25,  1.10it/s] 46%|████▌     | 23/50 [00:21<00:24,  1.10it/s] 48%|████▊     | 24/50 [00:22<00:23,  1.10it/s] 50%|█████     | 25/50 [00:22<00:22,  1.10it/s] 52%|█████▏    | 26/50 [00:23<00:21,  1.10it/s] 54%|█████▍    | 27/50 [00:24<00:20,  1.10it/s] 56%|█████▌    | 28/50 [00:25<00:20,  1.10it/s] 58%|█████▊    | 29/50 [00:26<00:19,  1.09it/s] 60%|██████    | 30/50 [00:27<00:18,  1.09it/s] 62%|██████▏   | 31/50 [00:28<00:17,  1.09it/s] 64%|██████▍   | 32/50 [00:29<00:16,  1.09it/s] 66%|██████▌   | 33/50 [00:30<00:15,  1.09it/s] 68%|██████▊   | 34/50 [00:31<00:14,  1.09it/s] 70%|███████   | 35/50 [00:32<00:13,  1.08it/s] 72%|███████▏  | 36/50 [00:33<00:12,  1.08it/s] 74%|███████▍  | 37/50 [00:34<00:12,  1.08it/s] 76%|███████▌  | 38/50 [00:34<00:11,  1.07it/s] 78%|███████▊  | 39/50 [00:35<00:10,  1.07it/s] 80%|████████  | 40/50 [00:36<00:09,  1.07it/s] 82%|████████▏ | 41/50 [00:37<00:08,  1.07it/s] 84%|████████▍ | 42/50 [00:38<00:07,  1.07it/s] 86%|████████▌ | 43/50 [00:39<00:06,  1.07it/s] 88%|████████▊ | 44/50 [00:40<00:05,  1.06it/s] 90%|█████████ | 45/50 [00:41<00:04,  1.06it/s] 92%|█████████▏| 46/50 [00:42<00:03,  1.06it/s] 94%|█████████▍| 47/50 [00:43<00:02,  1.06it/s] 96%|█████████▌| 48/50 [00:44<00:01,  1.06it/s] 98%|█████████▊| 49/50 [00:45<00:00,  1.06it/s]100%|██████████| 50/50 [00:46<00:00,  1.06it/s]100%|██████████| 50/50 [00:46<00:00,  1.08it/s]
sequence:7a54cd-3_obj
metrics: {'epe3d_allo_image_all': 0.6915828642249108, 'epe3d_allo_pixel_all': 0.6915828650852419, 'epe3d_sf_allo_image_all': 0.05369675865396857, 'epe3d_sf_allo_pixel_all': 0.053696758522177646, 'num_valid_pixels': 2650.0, 'delta_0.05': 0.11283018867924528, 'delta_0.1': 0.5773584905660377, 'delta_0.2': 0.8071698113207547, 'delta_0.4': 0.8071698113207547, 'outlier_0.15': 0.19660377358490566, 'delta_epe_0.1': 0.9286792452830188, 'delta_epe_0.3': 0.9803773584905661, 'delta_epe_0.5': 0.9962264150943396, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.02339622641509434}
Processing sequence: 927ad1-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:56,  1.15s/it]  4%|▍         | 2/50 [00:02<00:58,  1.23s/it]  6%|▌         | 3/50 [00:03<00:57,  1.22s/it]  8%|▊         | 4/50 [00:04<00:57,  1.24s/it] 10%|█         | 5/50 [00:06<01:00,  1.34s/it] 12%|█▏        | 6/50 [00:07<00:59,  1.35s/it] 14%|█▍        | 7/50 [00:09<00:57,  1.33s/it] 16%|█▌        | 8/50 [00:10<00:55,  1.31s/it] 18%|█▊        | 9/50 [00:11<00:52,  1.28s/it] 20%|██        | 10/50 [00:12<00:50,  1.26s/it] 22%|██▏       | 11/50 [00:13<00:48,  1.23s/it] 24%|██▍       | 12/50 [00:15<00:46,  1.22s/it] 26%|██▌       | 13/50 [00:16<00:45,  1.23s/it] 28%|██▊       | 14/50 [00:17<00:44,  1.24s/it] 30%|███       | 15/50 [00:18<00:42,  1.22s/it] 32%|███▏      | 16/50 [00:20<00:41,  1.21s/it] 34%|███▍      | 17/50 [00:21<00:39,  1.21s/it] 36%|███▌      | 18/50 [00:22<00:38,  1.20s/it] 38%|███▊      | 19/50 [00:23<00:37,  1.19s/it] 40%|████      | 20/50 [00:24<00:35,  1.19s/it] 42%|████▏     | 21/50 [00:25<00:34,  1.19s/it] 44%|████▍     | 22/50 [00:27<00:32,  1.18s/it] 46%|████▌     | 23/50 [00:28<00:32,  1.19s/it] 48%|████▊     | 24/50 [00:29<00:30,  1.18s/it] 50%|█████     | 25/50 [00:30<00:29,  1.16s/it] 52%|█████▏    | 26/50 [00:31<00:28,  1.17s/it] 54%|█████▍    | 27/50 [00:32<00:26,  1.17s/it] 56%|█████▌    | 28/50 [00:34<00:26,  1.18s/it] 58%|█████▊    | 29/50 [00:35<00:24,  1.18s/it] 60%|██████    | 30/50 [00:36<00:23,  1.18s/it] 62%|██████▏   | 31/50 [00:37<00:22,  1.21s/it] 64%|██████▍   | 32/50 [00:38<00:21,  1.19s/it] 66%|██████▌   | 33/50 [00:40<00:20,  1.19s/it] 68%|██████▊   | 34/50 [00:41<00:18,  1.18s/it] 70%|███████   | 35/50 [00:42<00:17,  1.18s/it] 72%|███████▏  | 36/50 [00:43<00:16,  1.19s/it] 74%|███████▍  | 37/50 [00:44<00:15,  1.17s/it] 76%|███████▌  | 38/50 [00:45<00:13,  1.16s/it] 78%|███████▊  | 39/50 [00:47<00:13,  1.19s/it] 80%|████████  | 40/50 [00:48<00:11,  1.17s/it] 82%|████████▏ | 41/50 [00:49<00:10,  1.18s/it] 84%|████████▍ | 42/50 [00:50<00:09,  1.17s/it] 86%|████████▌ | 43/50 [00:51<00:08,  1.17s/it] 88%|████████▊ | 44/50 [00:53<00:06,  1.15s/it] 90%|█████████ | 45/50 [00:54<00:05,  1.15s/it] 92%|█████████▏| 46/50 [00:55<00:04,  1.13s/it] 94%|█████████▍| 47/50 [00:56<00:03,  1.14s/it] 96%|█████████▌| 48/50 [00:57<00:02,  1.14s/it] 98%|█████████▊| 49/50 [00:58<00:01,  1.15s/it]100%|██████████| 50/50 [00:59<00:00,  1.16s/it]100%|██████████| 50/50 [00:59<00:00,  1.20s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f2c7c580260>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:20,  1.65s/it]  4%|▍         | 2/50 [00:02<01:04,  1.35s/it]  6%|▌         | 3/50 [00:03<00:58,  1.25s/it]  8%|▊         | 4/50 [00:05<00:56,  1.22s/it] 10%|█         | 5/50 [00:06<00:54,  1.20s/it] 12%|█▏        | 6/50 [00:07<00:51,  1.18s/it] 14%|█▍        | 7/50 [00:08<00:49,  1.16s/it] 16%|█▌        | 8/50 [00:09<00:49,  1.17s/it] 18%|█▊        | 9/50 [00:10<00:47,  1.16s/it] 20%|██        | 10/50 [00:11<00:45,  1.14s/it] 22%|██▏       | 11/50 [00:13<00:44,  1.13s/it] 24%|██▍       | 12/50 [00:14<00:43,  1.14s/it] 26%|██▌       | 13/50 [00:15<00:42,  1.14s/it] 28%|██▊       | 14/50 [00:16<00:41,  1.14s/it] 30%|███       | 15/50 [00:17<00:39,  1.12s/it] 32%|███▏      | 16/50 [00:18<00:37,  1.12s/it] 34%|███▍      | 17/50 [00:19<00:36,  1.11s/it] 36%|███▌      | 18/50 [00:20<00:35,  1.11s/it] 38%|███▊      | 19/50 [00:21<00:34,  1.10s/it] 40%|████      | 20/50 [00:23<00:33,  1.10s/it] 42%|████▏     | 21/50 [00:24<00:31,  1.10s/it] 44%|████▍     | 22/50 [00:25<00:30,  1.10s/it] 46%|████▌     | 23/50 [00:26<00:29,  1.09s/it] 48%|████▊     | 24/50 [00:27<00:28,  1.08s/it] 50%|█████     | 25/50 [00:28<00:27,  1.09s/it] 52%|█████▏    | 26/50 [00:29<00:26,  1.09s/it] 54%|█████▍    | 27/50 [00:30<00:25,  1.09s/it] 56%|█████▌    | 28/50 [00:31<00:24,  1.09s/it] 58%|█████▊    | 29/50 [00:32<00:22,  1.09s/it] 60%|██████    | 30/50 [00:33<00:21,  1.10s/it] 62%|██████▏   | 31/50 [00:35<00:20,  1.10s/it] 64%|██████▍   | 32/50 [00:36<00:19,  1.10s/it] 66%|██████▌   | 33/50 [00:37<00:18,  1.10s/it] 68%|██████▊   | 34/50 [00:38<00:17,  1.10s/it] 70%|███████   | 35/50 [00:39<00:16,  1.10s/it] 72%|███████▏  | 36/50 [00:40<00:15,  1.09s/it] 74%|███████▍  | 37/50 [00:41<00:14,  1.09s/it] 76%|███████▌  | 38/50 [00:42<00:13,  1.08s/it] 78%|███████▊  | 39/50 [00:43<00:11,  1.08s/it] 80%|████████  | 40/50 [00:44<00:10,  1.08s/it] 82%|████████▏ | 41/50 [00:45<00:09,  1.08s/it] 84%|████████▍ | 42/50 [00:46<00:08,  1.08s/it] 86%|████████▌ | 43/50 [00:48<00:07,  1.08s/it] 88%|████████▊ | 44/50 [00:49<00:06,  1.07s/it] 90%|█████████ | 45/50 [00:50<00:05,  1.06s/it] 92%|█████████▏| 46/50 [00:51<00:04,  1.07s/it] 94%|█████████▍| 47/50 [00:52<00:03,  1.06s/it] 96%|█████████▌| 48/50 [00:53<00:02,  1.06s/it] 98%|█████████▊| 49/50 [00:54<00:01,  1.06s/it]100%|██████████| 50/50 [00:55<00:00,  1.07s/it]100%|██████████| 50/50 [00:55<00:00,  1.11s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 65574
INFO:root:Parameters : 2562
INFO:root:Iterations : 101
INFO:root:Time : 2.5147180557250977 [s]
INFO:root:Initial cost : 4.87861807608415 [px]
INFO:root:Final cost : 0.5301151340112171 [px]
INFO:root:Residuals : 66182
INFO:root:Parameters : 2562
INFO:root:Iterations : 101
INFO:root:Time : 2.5478789806365967 [s]
INFO:root:Initial cost : 1.7213464494489354 [px]
INFO:root:Final cost : 0.3892345821518467 [px]
INFO:root:Residuals : 65740
INFO:root:Parameters : 2538
INFO:root:Iterations : 101
INFO:root:Time : 2.4945290088653564 [s]
INFO:root:Initial cost : 1.4140397620634675 [px]
INFO:root:Final cost : 0.338981652968012 [px]
INFO:root:Residuals : 65674
INFO:root:Parameters : 2532
INFO:root:Iterations : 101
INFO:root:Time : 2.4901230335235596 [s]
INFO:root:Initial cost : 1.3699832982518065 [px]
INFO:root:Final cost : 0.31771827017805704 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:59,  1.21s/it]  4%|▍         | 2/50 [00:02<00:56,  1.17s/it]  6%|▌         | 3/50 [00:03<00:53,  1.14s/it]  8%|▊         | 4/50 [00:04<00:52,  1.13s/it] 10%|█         | 5/50 [00:05<00:50,  1.13s/it] 12%|█▏        | 6/50 [00:06<00:49,  1.13s/it] 14%|█▍        | 7/50 [00:07<00:48,  1.12s/it] 16%|█▌        | 8/50 [00:09<00:47,  1.12s/it] 18%|█▊        | 9/50 [00:10<00:45,  1.12s/it] 20%|██        | 10/50 [00:11<00:44,  1.12s/it] 22%|██▏       | 11/50 [00:12<00:43,  1.12s/it] 24%|██▍       | 12/50 [00:13<00:42,  1.12s/it] 26%|██▌       | 13/50 [00:14<00:41,  1.11s/it] 28%|██▊       | 14/50 [00:15<00:39,  1.11s/it] 30%|███       | 15/50 [00:16<00:38,  1.11s/it] 32%|███▏      | 16/50 [00:17<00:37,  1.11s/it] 34%|███▍      | 17/50 [00:19<00:36,  1.10s/it] 36%|███▌      | 18/50 [00:20<00:35,  1.10s/it] 38%|███▊      | 19/50 [00:21<00:34,  1.11s/it] 40%|████      | 20/50 [00:22<00:33,  1.10s/it] 42%|████▏     | 21/50 [00:23<00:31,  1.10s/it] 44%|████▍     | 22/50 [00:24<00:30,  1.09s/it] 46%|████▌     | 23/50 [00:25<00:29,  1.09s/it] 48%|████▊     | 24/50 [00:26<00:28,  1.08s/it] 50%|█████     | 25/50 [00:27<00:26,  1.07s/it] 52%|█████▏    | 26/50 [00:28<00:25,  1.07s/it] 54%|█████▍    | 27/50 [00:29<00:24,  1.08s/it] 56%|█████▌    | 28/50 [00:30<00:23,  1.09s/it] 58%|█████▊    | 29/50 [00:32<00:22,  1.09s/it] 60%|██████    | 30/50 [00:33<00:21,  1.10s/it] 62%|██████▏   | 31/50 [00:34<00:20,  1.10s/it] 64%|██████▍   | 32/50 [00:35<00:19,  1.10s/it] 66%|██████▌   | 33/50 [00:36<00:18,  1.10s/it] 68%|██████▊   | 34/50 [00:37<00:17,  1.10s/it] 70%|███████   | 35/50 [00:38<00:16,  1.10s/it] 72%|███████▏  | 36/50 [00:39<00:15,  1.09s/it] 74%|███████▍  | 37/50 [00:40<00:14,  1.09s/it] 76%|███████▌  | 38/50 [00:42<00:13,  1.11s/it] 78%|███████▊  | 39/50 [00:43<00:12,  1.10s/it] 80%|████████  | 40/50 [00:44<00:10,  1.09s/it] 82%|████████▏ | 41/50 [00:45<00:09,  1.08s/it] 84%|████████▍ | 42/50 [00:46<00:08,  1.07s/it] 86%|████████▌ | 43/50 [00:47<00:07,  1.07s/it] 88%|████████▊ | 44/50 [00:48<00:06,  1.06s/it] 90%|█████████ | 45/50 [00:49<00:05,  1.05s/it] 92%|█████████▏| 46/50 [00:50<00:04,  1.05s/it] 94%|█████████▍| 47/50 [00:51<00:03,  1.05s/it] 96%|█████████▌| 48/50 [00:52<00:02,  1.05s/it] 98%|█████████▊| 49/50 [00:53<00:01,  1.05s/it]100%|██████████| 50/50 [00:54<00:00,  1.06s/it]100%|██████████| 50/50 [00:54<00:00,  1.09s/it]
sequence:927ad1-3_obj
metrics: {'epe3d_allo_image_all': 0.8943322223424911, 'epe3d_allo_pixel_all': 0.8943322229385376, 'epe3d_sf_allo_image_all': 0.05242467758012936, 'epe3d_sf_allo_pixel_all': 0.0524246776678289, 'num_valid_pixels': 2400.0, 'delta_0.05': 0.0, 'delta_0.1': 0.0008333333333333334, 'delta_0.2': 0.7416666666666667, 'delta_0.4': 0.7766666666666666, 'outlier_0.15': 0.5983333333333334, 'delta_epe_0.1': 0.865, 'delta_epe_0.3': 0.9579166666666666, 'delta_epe_0.5': 1.0, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.0625}
Processing sequence: a5e772-3_obj with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<00:49,  1.00s/it]  4%|▍         | 2/50 [00:02<01:00,  1.26s/it]  6%|▌         | 3/50 [00:03<00:55,  1.17s/it]  8%|▊         | 4/50 [00:04<00:52,  1.15s/it] 10%|█         | 5/50 [00:05<00:51,  1.14s/it] 12%|█▏        | 6/50 [00:06<00:48,  1.11s/it] 14%|█▍        | 7/50 [00:07<00:48,  1.12s/it] 16%|█▌        | 8/50 [00:09<00:46,  1.11s/it] 18%|█▊        | 9/50 [00:10<00:45,  1.12s/it] 20%|██        | 10/50 [00:11<00:44,  1.11s/it] 22%|██▏       | 11/50 [00:12<00:42,  1.10s/it] 24%|██▍       | 12/50 [00:13<00:40,  1.08s/it] 26%|██▌       | 13/50 [00:14<00:40,  1.09s/it] 28%|██▊       | 14/50 [00:15<00:38,  1.08s/it] 30%|███       | 15/50 [00:16<00:37,  1.08s/it] 32%|███▏      | 16/50 [00:17<00:36,  1.08s/it] 34%|███▍      | 17/50 [00:18<00:35,  1.07s/it] 36%|███▌      | 18/50 [00:19<00:34,  1.08s/it] 38%|███▊      | 19/50 [00:20<00:33,  1.07s/it] 40%|████      | 20/50 [00:21<00:31,  1.06s/it] 42%|████▏     | 21/50 [00:23<00:31,  1.07s/it] 44%|████▍     | 22/50 [00:24<00:29,  1.07s/it] 46%|████▌     | 23/50 [00:25<00:28,  1.07s/it] 48%|████▊     | 24/50 [00:26<00:27,  1.06s/it] 50%|█████     | 25/50 [00:27<00:26,  1.06s/it] 52%|█████▏    | 26/50 [00:28<00:25,  1.05s/it] 54%|█████▍    | 27/50 [00:29<00:24,  1.05s/it] 56%|█████▌    | 28/50 [00:30<00:23,  1.05s/it] 58%|█████▊    | 29/50 [00:31<00:21,  1.04s/it] 60%|██████    | 30/50 [00:32<00:21,  1.05s/it] 62%|██████▏   | 31/50 [00:33<00:20,  1.07s/it] 64%|██████▍   | 32/50 [00:34<00:19,  1.06s/it] 66%|██████▌   | 33/50 [00:35<00:18,  1.06s/it] 68%|██████▊   | 34/50 [00:36<00:17,  1.06s/it] 70%|███████   | 35/50 [00:37<00:15,  1.06s/it] 72%|███████▏  | 36/50 [00:38<00:15,  1.08s/it] 74%|███████▍  | 37/50 [00:39<00:13,  1.06s/it] 76%|███████▌  | 38/50 [00:40<00:12,  1.06s/it] 78%|███████▊  | 39/50 [00:42<00:12,  1.09s/it] 80%|████████  | 40/50 [00:43<00:10,  1.09s/it] 82%|████████▏ | 41/50 [00:44<00:09,  1.07s/it] 84%|████████▍ | 42/50 [00:45<00:08,  1.08s/it] 86%|████████▌ | 43/50 [00:46<00:07,  1.07s/it] 88%|████████▊ | 44/50 [00:47<00:06,  1.08s/it] 90%|█████████ | 45/50 [00:48<00:05,  1.11s/it] 92%|█████████▏| 46/50 [00:49<00:04,  1.09s/it] 94%|█████████▍| 47/50 [00:50<00:03,  1.08s/it] 96%|█████████▌| 48/50 [00:51<00:02,  1.07s/it] 98%|█████████▊| 49/50 [00:52<00:01,  1.07s/it]100%|██████████| 50/50 [00:53<00:00,  1.08s/it]100%|██████████| 50/50 [00:53<00:00,  1.08s/it]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f2cc05288c0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:01<01:09,  1.42s/it]  4%|▍         | 2/50 [00:02<00:56,  1.18s/it]  6%|▌         | 3/50 [00:03<00:53,  1.14s/it]  8%|▊         | 4/50 [00:04<00:50,  1.09s/it] 10%|█         | 5/50 [00:05<00:47,  1.06s/it] 12%|█▏        | 6/50 [00:06<00:46,  1.05s/it] 14%|█▍        | 7/50 [00:07<00:45,  1.06s/it] 16%|█▌        | 8/50 [00:08<00:43,  1.04s/it] 18%|█▊        | 9/50 [00:09<00:42,  1.02s/it] 20%|██        | 10/50 [00:10<00:41,  1.03s/it] 22%|██▏       | 11/50 [00:11<00:39,  1.02s/it] 24%|██▍       | 12/50 [00:12<00:38,  1.03s/it] 26%|██▌       | 13/50 [00:13<00:37,  1.03s/it] 28%|██▊       | 14/50 [00:14<00:36,  1.02s/it] 30%|███       | 15/50 [00:15<00:35,  1.01s/it] 32%|███▏      | 16/50 [00:16<00:34,  1.00s/it] 34%|███▍      | 17/50 [00:17<00:32,  1.00it/s] 36%|███▌      | 18/50 [00:18<00:31,  1.01it/s] 38%|███▊      | 19/50 [00:19<00:30,  1.01it/s] 40%|████      | 20/50 [00:20<00:29,  1.01it/s] 42%|████▏     | 21/50 [00:21<00:28,  1.02it/s] 44%|████▍     | 22/50 [00:22<00:27,  1.02it/s] 46%|████▌     | 23/50 [00:23<00:26,  1.01it/s] 48%|████▊     | 24/50 [00:24<00:25,  1.01it/s] 50%|█████     | 25/50 [00:25<00:24,  1.01it/s] 52%|█████▏    | 26/50 [00:26<00:23,  1.00it/s] 54%|█████▍    | 27/50 [00:27<00:22,  1.01it/s] 56%|█████▌    | 28/50 [00:28<00:21,  1.01it/s] 58%|█████▊    | 29/50 [00:29<00:20,  1.01it/s] 60%|██████    | 30/50 [00:30<00:19,  1.02it/s] 62%|██████▏   | 31/50 [00:31<00:18,  1.02it/s] 64%|██████▍   | 32/50 [00:32<00:17,  1.02it/s] 66%|██████▌   | 33/50 [00:33<00:16,  1.03it/s] 68%|██████▊   | 34/50 [00:34<00:15,  1.03it/s] 70%|███████   | 35/50 [00:35<00:14,  1.03it/s] 72%|███████▏  | 36/50 [00:36<00:13,  1.03it/s] 74%|███████▍  | 37/50 [00:37<00:12,  1.03it/s] 76%|███████▌  | 38/50 [00:38<00:11,  1.03it/s] 78%|███████▊  | 39/50 [00:39<00:10,  1.03it/s] 80%|████████  | 40/50 [00:40<00:09,  1.03it/s] 82%|████████▏ | 41/50 [00:41<00:08,  1.03it/s] 84%|████████▍ | 42/50 [00:42<00:07,  1.03it/s] 86%|████████▌ | 43/50 [00:43<00:06,  1.03it/s] 88%|████████▊ | 44/50 [00:44<00:05,  1.03it/s] 90%|█████████ | 45/50 [00:45<00:04,  1.02it/s] 92%|█████████▏| 46/50 [00:46<00:03,  1.02it/s] 94%|█████████▍| 47/50 [00:47<00:02,  1.02it/s] 96%|█████████▌| 48/50 [00:48<00:01,  1.02it/s] 98%|█████████▊| 49/50 [00:49<00:00,  1.02it/s]100%|██████████| 50/50 [00:50<00:00,  1.02it/s]100%|██████████| 50/50 [00:50<00:00,  1.00s/it]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 58996
INFO:root:Parameters : 2256
INFO:root:Iterations : 101
INFO:root:Time : 2.2010841369628906 [s]
INFO:root:Initial cost : 3.2152739514315543 [px]
INFO:root:Final cost : 0.4240911346138915 [px]
INFO:root:Residuals : 57464
INFO:root:Parameters : 2199
INFO:root:Iterations : 101
INFO:root:Time : 2.148409128189087 [s]
INFO:root:Initial cost : 1.149717628445671 [px]
INFO:root:Final cost : 0.2952490986403176 [px]
INFO:root:Residuals : 58406
INFO:root:Parameters : 2229
INFO:root:Iterations : 101
INFO:root:Time : 2.1830639839172363 [s]
INFO:root:Initial cost : 1.0958269657965698 [px]
INFO:root:Final cost : 0.30610470744823515 [px]
INFO:root:Residuals : 58600
INFO:root:Parameters : 2241
INFO:root:Iterations : 101
INFO:root:Time : 2.1995928287506104 [s]
INFO:root:Initial cost : 1.0757356205210893 [px]
INFO:root:Final cost : 0.2962193904564471 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:48,  1.00it/s]  4%|▍         | 2/50 [00:01<00:47,  1.01it/s]  6%|▌         | 3/50 [00:02<00:46,  1.02it/s]  8%|▊         | 4/50 [00:03<00:45,  1.02it/s] 10%|█         | 5/50 [00:04<00:43,  1.02it/s] 12%|█▏        | 6/50 [00:05<00:42,  1.03it/s] 14%|█▍        | 7/50 [00:06<00:41,  1.03it/s] 16%|█▌        | 8/50 [00:07<00:40,  1.03it/s] 18%|█▊        | 9/50 [00:08<00:39,  1.03it/s] 20%|██        | 10/50 [00:09<00:38,  1.03it/s] 22%|██▏       | 11/50 [00:10<00:37,  1.03it/s] 24%|██▍       | 12/50 [00:11<00:36,  1.03it/s] 26%|██▌       | 13/50 [00:12<00:35,  1.03it/s] 28%|██▊       | 14/50 [00:13<00:34,  1.03it/s] 30%|███       | 15/50 [00:14<00:33,  1.03it/s] 32%|███▏      | 16/50 [00:15<00:32,  1.04it/s] 34%|███▍      | 17/50 [00:16<00:31,  1.04it/s] 36%|███▌      | 18/50 [00:17<00:30,  1.04it/s] 38%|███▊      | 19/50 [00:18<00:29,  1.04it/s] 40%|████      | 20/50 [00:19<00:28,  1.04it/s] 42%|████▏     | 21/50 [00:20<00:27,  1.05it/s] 44%|████▍     | 22/50 [00:21<00:26,  1.05it/s] 46%|████▌     | 23/50 [00:22<00:25,  1.05it/s] 48%|████▊     | 24/50 [00:23<00:24,  1.05it/s] 50%|█████     | 25/50 [00:24<00:23,  1.05it/s] 52%|█████▏    | 26/50 [00:25<00:22,  1.05it/s] 54%|█████▍    | 27/50 [00:26<00:21,  1.05it/s] 56%|█████▌    | 28/50 [00:26<00:20,  1.05it/s] 58%|█████▊    | 29/50 [00:27<00:20,  1.05it/s] 60%|██████    | 30/50 [00:28<00:19,  1.05it/s] 62%|██████▏   | 31/50 [00:29<00:18,  1.05it/s] 64%|██████▍   | 32/50 [00:30<00:17,  1.05it/s] 66%|██████▌   | 33/50 [00:31<00:16,  1.05it/s] 68%|██████▊   | 34/50 [00:32<00:15,  1.06it/s] 70%|███████   | 35/50 [00:33<00:14,  1.05it/s] 72%|███████▏  | 36/50 [00:34<00:13,  1.04it/s] 74%|███████▍  | 37/50 [00:35<00:12,  1.05it/s] 76%|███████▌  | 38/50 [00:36<00:11,  1.05it/s] 78%|███████▊  | 39/50 [00:37<00:10,  1.05it/s] 80%|████████  | 40/50 [00:38<00:09,  1.05it/s] 82%|████████▏ | 41/50 [00:39<00:08,  1.05it/s] 84%|████████▍ | 42/50 [00:40<00:07,  1.05it/s] 86%|████████▌ | 43/50 [00:41<00:06,  1.05it/s] 88%|████████▊ | 44/50 [00:42<00:05,  1.05it/s] 90%|█████████ | 45/50 [00:43<00:04,  1.05it/s] 92%|█████████▏| 46/50 [00:44<00:03,  1.05it/s] 94%|█████████▍| 47/50 [00:45<00:02,  1.06it/s] 96%|█████████▌| 48/50 [00:45<00:01,  1.05it/s] 98%|█████████▊| 49/50 [00:46<00:00,  1.05it/s]100%|██████████| 50/50 [00:47<00:00,  1.06it/s]100%|██████████| 50/50 [00:47<00:00,  1.04it/s]
sequence:a5e772-3_obj
metrics: {'epe3d_allo_image_all': 0.48591610088944437, 'epe3d_allo_pixel_all': 0.4859161014556885, 'epe3d_sf_allo_image_all': 0.12807232478633523, 'epe3d_sf_allo_pixel_all': 0.12807232465062823, 'num_valid_pixels': 3500.0, 'delta_0.05': 0.7894285714285715, 'delta_0.1': 0.8454285714285714, 'delta_0.2': 0.846, 'delta_0.4': 0.846, 'outlier_0.15': 0.154, 'delta_epe_0.1': 0.7314285714285714, 'delta_epe_0.3': 0.886, 'delta_epe_0.5': 0.9188571428571428, 'delta_epe_1.0': 0.9951428571428571, 'outlier_epe_0.25': 0.12228571428571429}
Final Metrics across all sequences:
epe3d_allo_image_all: 0.7009919260442258
epe3d_allo_pixel_all: 0.7009919262950148
epe3d_sf_allo_image_all: 0.05576285104034469
epe3d_sf_allo_pixel_all: 0.05576285098592282
num_valid_pixels: 42000.0
delta_0.05: 0.35654279497418984
delta_0.1: 0.5791792091787936
delta_0.2: 0.8071110021272145
delta_0.4: 0.8109499403720681
outlier_0.15: 0.24110785284053407
delta_epe_0.1: 0.8964011410179916
delta_epe_0.3: 0.9655967447906189
delta_epe_0.5: 0.9867521433142704
delta_epe_1.0: 0.9994068959130757
outlier_epe_0.25: 0.04165549521841778
Metrics saved to dynamic_replica_eval_spatrackv2_any4d_benchmarking_metrics.txt
