INFO:numexpr.utils:Note: detected 96 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 96 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
INFO:numexpr.utils:NumExpr defaulting to 16 threads.
Seed set to: 0
Using device: cuda
Found 10 sequences.
Using 10 sequences for evaluation.
Processing sequence: tapvid3d_7885161619764516373_289_280_309_280_1_zEhlk3t1GglE8OLwtHKbpw.npz with 31 pairs
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:08,  3.52it/s]  6%|▋         | 2/31 [00:00<00:11,  2.49it/s] 10%|▉         | 3/31 [00:01<00:10,  2.67it/s] 13%|█▎        | 4/31 [00:01<00:10,  2.63it/s] 16%|█▌        | 5/31 [00:01<00:09,  2.71it/s] 19%|█▉        | 6/31 [00:02<00:08,  2.78it/s] 23%|██▎       | 7/31 [00:02<00:08,  2.82it/s] 26%|██▌       | 8/31 [00:02<00:08,  2.74it/s] 29%|██▉       | 9/31 [00:03<00:08,  2.68it/s] 32%|███▏      | 10/31 [00:03<00:07,  2.79it/s] 35%|███▌      | 11/31 [00:03<00:07,  2.84it/s] 39%|███▊      | 12/31 [00:04<00:07,  2.66it/s] 42%|████▏     | 13/31 [00:04<00:06,  2.74it/s] 45%|████▌     | 14/31 [00:05<00:07,  2.33it/s] 48%|████▊     | 15/31 [00:05<00:06,  2.37it/s] 52%|█████▏    | 16/31 [00:06<00:05,  2.54it/s] 55%|█████▍    | 17/31 [00:06<00:05,  2.63it/s] 58%|█████▊    | 18/31 [00:06<00:04,  2.66it/s] 61%|██████▏   | 19/31 [00:07<00:04,  2.68it/s] 65%|██████▍   | 20/31 [00:07<00:03,  2.75it/s] 68%|██████▊   | 21/31 [00:07<00:03,  2.76it/s] 71%|███████   | 22/31 [00:08<00:03,  2.73it/s] 74%|███████▍  | 23/31 [00:08<00:03,  2.55it/s] 77%|███████▋  | 24/31 [00:09<00:02,  2.66it/s] 81%|████████  | 25/31 [00:09<00:02,  2.90it/s] 84%|████████▍ | 26/31 [00:09<00:01,  2.93it/s] 87%|████████▋ | 27/31 [00:10<00:01,  2.62it/s] 90%|█████████ | 28/31 [00:10<00:01,  2.69it/s] 94%|█████████▎| 29/31 [00:10<00:00,  2.74it/s] 97%|█████████▋| 30/31 [00:11<00:00,  2.64it/s]100%|██████████| 31/31 [00:11<00:00,  2.49it/s]100%|██████████| 31/31 [00:11<00:00,  2.66it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f15f65cb9e0>
Test dataset length:  31
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:11,  2.57it/s]  6%|▋         | 2/31 [00:00<00:07,  3.86it/s] 10%|▉         | 3/31 [00:00<00:06,  4.43it/s] 13%|█▎        | 4/31 [00:00<00:05,  4.70it/s] 16%|█▌        | 5/31 [00:01<00:05,  4.77it/s] 19%|█▉        | 6/31 [00:01<00:05,  4.89it/s] 23%|██▎       | 7/31 [00:01<00:04,  4.90it/s] 26%|██▌       | 8/31 [00:01<00:04,  4.89it/s] 29%|██▉       | 9/31 [00:01<00:04,  5.02it/s] 32%|███▏      | 10/31 [00:02<00:04,  4.87it/s] 35%|███▌      | 11/31 [00:02<00:04,  4.04it/s] 39%|███▊      | 12/31 [00:02<00:04,  4.28it/s] 42%|████▏     | 13/31 [00:02<00:04,  4.40it/s] 45%|████▌     | 14/31 [00:03<00:03,  4.46it/s] 48%|████▊     | 15/31 [00:03<00:03,  4.62it/s] 52%|█████▏    | 16/31 [00:04<00:06,  2.28it/s] 55%|█████▍    | 17/31 [00:04<00:05,  2.48it/s] 58%|█████▊    | 18/31 [00:04<00:04,  2.93it/s] 61%|██████▏   | 19/31 [00:04<00:03,  3.37it/s] 65%|██████▍   | 20/31 [00:05<00:02,  3.78it/s] 68%|██████▊   | 21/31 [00:05<00:02,  4.12it/s] 71%|███████   | 22/31 [00:05<00:02,  4.36it/s] 74%|███████▍  | 23/31 [00:05<00:01,  4.52it/s] 77%|███████▋  | 24/31 [00:05<00:01,  4.71it/s] 81%|████████  | 25/31 [00:06<00:01,  4.87it/s] 84%|████████▍ | 26/31 [00:06<00:01,  4.97it/s] 87%|████████▋ | 27/31 [00:06<00:00,  5.04it/s] 90%|█████████ | 28/31 [00:06<00:00,  4.45it/s] 94%|█████████▎| 29/31 [00:07<00:00,  3.43it/s] 97%|█████████▋| 30/31 [00:07<00:00,  3.76it/s]100%|██████████| 31/31 [00:07<00:00,  4.11it/s]100%|██████████| 31/31 [00:07<00:00,  4.03it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")

WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")

WARNING:py.warnings:/jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")

INFO:dinov2:using MLP layer as FFN
WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

WARNING:py.warnings:/usr/local/lib/python3.12/dist-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

INFO:root:Residuals : 20736
INFO:root:Parameters : 1779
INFO:root:Iterations : 101
INFO:root:Time : 1.353053092956543 [s]
INFO:root:Initial cost : 10.044800199707215 [px]
INFO:root:Final cost : 1.5264870410390106 [px]
INFO:root:Residuals : 17774
INFO:root:Parameters : 1572
INFO:root:Iterations : 101
INFO:root:Time : 1.0487730503082275 [s]
INFO:root:Initial cost : 2.9012255229952526 [px]
INFO:root:Final cost : 0.79974204476325 [px]
INFO:root:Residuals : 17764
INFO:root:Parameters : 1548
INFO:root:Iterations : 101
INFO:root:Time : 0.8128459453582764 [s]
INFO:root:Initial cost : 2.4932082855281705 [px]
INFO:root:Final cost : 0.6326750730035507 [px]
INFO:root:Residuals : 18046
INFO:root:Parameters : 1593
INFO:root:Iterations : 101
INFO:root:Time : 0.844149112701416 [s]
INFO:root:Initial cost : 2.38305952758485 [px]
INFO:root:Final cost : 0.5733346462373474 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:10,  2.88it/s]  6%|▋         | 2/31 [00:00<00:09,  3.07it/s] 10%|▉         | 3/31 [00:01<00:12,  2.30it/s] 13%|█▎        | 4/31 [00:01<00:10,  2.66it/s] 16%|█▌        | 5/31 [00:01<00:08,  2.90it/s] 19%|█▉        | 6/31 [00:02<00:13,  1.88it/s] 23%|██▎       | 7/31 [00:02<00:10,  2.21it/s] 26%|██▌       | 8/31 [00:03<00:09,  2.48it/s] 29%|██▉       | 9/31 [00:03<00:08,  2.71it/s] 32%|███▏      | 10/31 [00:03<00:07,  2.90it/s] 35%|███▌      | 11/31 [00:04<00:06,  3.06it/s] 39%|███▊      | 12/31 [00:04<00:06,  3.14it/s] 42%|████▏     | 13/31 [00:04<00:05,  3.26it/s] 45%|████▌     | 14/31 [00:05<00:05,  3.31it/s] 48%|████▊     | 15/31 [00:05<00:04,  3.37it/s] 52%|█████▏    | 16/31 [00:05<00:05,  2.78it/s] 55%|█████▍    | 17/31 [00:06<00:04,  2.97it/s] 58%|█████▊    | 18/31 [00:06<00:04,  3.06it/s] 61%|██████▏   | 19/31 [00:06<00:03,  3.21it/s] 65%|██████▍   | 20/31 [00:07<00:04,  2.37it/s] 68%|██████▊   | 21/31 [00:07<00:03,  2.63it/s] 71%|███████   | 22/31 [00:07<00:03,  2.82it/s] 74%|███████▍  | 23/31 [00:08<00:02,  2.98it/s] 77%|███████▋  | 24/31 [00:08<00:02,  3.07it/s] 81%|████████  | 25/31 [00:08<00:01,  3.22it/s] 84%|████████▍ | 26/31 [00:09<00:01,  3.11it/s] 87%|████████▋ | 27/31 [00:09<00:01,  3.19it/s] 90%|█████████ | 28/31 [00:09<00:00,  3.27it/s] 94%|█████████▎| 29/31 [00:10<00:00,  2.86it/s] 97%|█████████▋| 30/31 [00:10<00:00,  2.33it/s]100%|██████████| 31/31 [00:11<00:00,  2.56it/s]100%|██████████| 31/31 [00:11<00:00,  2.79it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_7885161619764516373_289_280_309_280_1_zEhlk3t1GglE8OLwtHKbpw.npz
metrics: {'epe3d_allo_image_all': 3.4059227781911052, 'epe3d_allo_pixel_all': 3.5194535573323567, 'epe3d_sf_allo_image_all': 4.734924718256919, 'epe3d_sf_allo_pixel_all': 4.89275557729933, 'num_valid_pixels': 540.0, 'delta_0.05': 0.5740740740740741, 'delta_0.1': 0.8314814814814815, 'delta_0.2': 0.9629629629629629, 'delta_0.4': 0.9888888888888889, 'outlier_0.15': 0.07592592592592592, 'delta_epe_0.1': 0.001851851851851852, 'delta_epe_0.3': 0.03518518518518519, 'delta_epe_0.5': 0.08148148148148149, 'delta_epe_1.0': 0.21296296296296297, 'outlier_epe_0.25': 0.9814814814814815}
Processing sequence: tapvid3d_6722602826685649765_2280_000_2300_000_1_NobqX95Kf7CR9x1pNFjyUw.npz with 30 pairs
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:11,  2.52it/s]  7%|▋         | 2/30 [00:00<00:10,  2.74it/s] 10%|█         | 3/30 [00:01<00:09,  2.98it/s] 13%|█▎        | 4/30 [00:01<00:12,  2.04it/s] 17%|█▋        | 5/30 [00:02<00:11,  2.08it/s] 20%|██        | 6/30 [00:02<00:11,  2.17it/s] 23%|██▎       | 7/30 [00:02<00:09,  2.40it/s] 27%|██▋       | 8/30 [00:03<00:12,  1.83it/s] 30%|███       | 9/30 [00:04<00:10,  1.99it/s] 33%|███▎      | 10/30 [00:04<00:08,  2.30it/s] 37%|███▋      | 11/30 [00:04<00:07,  2.59it/s] 40%|████      | 12/30 [00:05<00:06,  2.63it/s] 43%|████▎     | 13/30 [00:05<00:06,  2.78it/s] 47%|████▋     | 14/30 [00:06<00:09,  1.65it/s] 50%|█████     | 15/30 [00:07<00:09,  1.52it/s] 53%|█████▎    | 16/30 [00:09<00:15,  1.08s/it] 57%|█████▋    | 17/30 [00:09<00:11,  1.13it/s] 60%|██████    | 18/30 [00:10<00:11,  1.07it/s] 63%|██████▎   | 19/30 [00:11<00:09,  1.19it/s] 67%|██████▋   | 20/30 [00:11<00:07,  1.43it/s] 70%|███████   | 21/30 [00:12<00:06,  1.43it/s] 73%|███████▎  | 22/30 [00:13<00:05,  1.60it/s] 77%|███████▋  | 23/30 [00:13<00:04,  1.70it/s] 80%|████████  | 24/30 [00:15<00:05,  1.18it/s] 83%|████████▎ | 25/30 [00:15<00:03,  1.44it/s] 87%|████████▋ | 26/30 [00:15<00:02,  1.71it/s] 90%|█████████ | 27/30 [00:16<00:01,  1.80it/s] 93%|█████████▎| 28/30 [00:16<00:01,  1.94it/s] 97%|█████████▋| 29/30 [00:17<00:00,  2.02it/s]100%|██████████| 30/30 [00:17<00:00,  1.87it/s]100%|██████████| 30/30 [00:17<00:00,  1.70it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c50b685f0>
Test dataset length:  30
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:23,  1.25it/s]  7%|▋         | 2/30 [00:00<00:12,  2.27it/s] 10%|█         | 3/30 [00:01<00:09,  2.98it/s] 13%|█▎        | 4/30 [00:01<00:10,  2.59it/s] 17%|█▋        | 5/30 [00:02<00:09,  2.65it/s] 20%|██        | 6/30 [00:02<00:07,  3.05it/s] 23%|██▎       | 7/30 [00:03<00:11,  1.94it/s] 27%|██▋       | 8/30 [00:03<00:09,  2.39it/s] 30%|███       | 9/30 [00:03<00:07,  2.85it/s] 33%|███▎      | 10/30 [00:03<00:06,  3.27it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.65it/s] 40%|████      | 12/30 [00:05<00:10,  1.64it/s] 43%|████▎     | 13/30 [00:05<00:08,  2.03it/s] 47%|████▋     | 14/30 [00:05<00:06,  2.45it/s] 50%|█████     | 15/30 [00:06<00:05,  2.76it/s] 53%|█████▎    | 16/30 [00:06<00:04,  3.10it/s] 57%|█████▋    | 17/30 [00:06<00:03,  3.38it/s] 60%|██████    | 18/30 [00:06<00:03,  3.62it/s] 63%|██████▎   | 19/30 [00:06<00:02,  3.97it/s] 67%|██████▋   | 20/30 [00:07<00:02,  3.99it/s] 70%|███████   | 21/30 [00:07<00:02,  3.83it/s] 73%|███████▎  | 22/30 [00:07<00:01,  4.09it/s] 77%|███████▋  | 23/30 [00:07<00:01,  4.15it/s] 80%|████████  | 24/30 [00:08<00:01,  4.33it/s] 83%|████████▎ | 25/30 [00:08<00:01,  4.32it/s] 87%|████████▋ | 26/30 [00:08<00:00,  4.46it/s] 90%|█████████ | 27/30 [00:08<00:00,  4.45it/s] 93%|█████████▎| 28/30 [00:08<00:00,  4.64it/s] 97%|█████████▋| 29/30 [00:09<00:00,  4.81it/s]100%|██████████| 30/30 [00:09<00:00,  4.80it/s]100%|██████████| 30/30 [00:09<00:00,  3.19it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 33114
INFO:root:Parameters : 2094
INFO:root:Iterations : 101
INFO:root:Time : 2.5662460327148438 [s]
INFO:root:Initial cost : 1.6445975451824575 [px]
INFO:root:Final cost : 0.475528685691448 [px]
INFO:root:Residuals : 31466
INFO:root:Parameters : 1995
INFO:root:Iterations : 101
INFO:root:Time : 2.121030807495117 [s]
INFO:root:Initial cost : 1.1066291604614498 [px]
INFO:root:Final cost : 0.10871112525738404 [px]
INFO:root:Residuals : 30730
INFO:root:Parameters : 1965
INFO:root:Iterations : 101
INFO:root:Time : 1.5355761051177979 [s]
INFO:root:Initial cost : 1.0718238352130407 [px]
INFO:root:Final cost : 0.10515716904954642 [px]
INFO:root:Residuals : 30444
INFO:root:Parameters : 1959
INFO:root:Iterations : 101
INFO:root:Time : 1.4239308834075928 [s]
INFO:root:Initial cost : 1.0402390224801819 [px]
INFO:root:Final cost : 0.1004269974729448 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:10,  2.84it/s]  7%|▋         | 2/30 [00:00<00:09,  3.06it/s] 10%|█         | 3/30 [00:00<00:08,  3.20it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.33it/s] 17%|█▋        | 5/30 [00:01<00:07,  3.17it/s] 20%|██        | 6/30 [00:01<00:07,  3.23it/s] 23%|██▎       | 7/30 [00:02<00:08,  2.80it/s] 27%|██▋       | 8/30 [00:02<00:08,  2.59it/s] 30%|███       | 9/30 [00:03<00:07,  2.83it/s] 33%|███▎      | 10/30 [00:03<00:06,  3.01it/s] 37%|███▋      | 11/30 [00:03<00:06,  3.12it/s] 40%|████      | 12/30 [00:04<00:10,  1.68it/s] 43%|████▎     | 13/30 [00:05<00:08,  1.98it/s] 47%|████▋     | 14/30 [00:06<00:11,  1.42it/s] 50%|█████     | 15/30 [00:06<00:09,  1.62it/s] 53%|█████▎    | 16/30 [00:07<00:07,  1.91it/s] 57%|█████▋    | 17/30 [00:07<00:05,  2.19it/s] 60%|██████    | 18/30 [00:07<00:06,  1.97it/s] 63%|██████▎   | 19/30 [00:08<00:05,  2.00it/s] 67%|██████▋   | 20/30 [00:08<00:04,  2.05it/s] 70%|███████   | 21/30 [00:09<00:03,  2.33it/s] 73%|███████▎  | 22/30 [00:09<00:03,  2.57it/s] 77%|███████▋  | 23/30 [00:10<00:03,  1.75it/s] 80%|████████  | 24/30 [00:10<00:03,  1.98it/s] 83%|████████▎ | 25/30 [00:11<00:02,  1.92it/s] 87%|████████▋ | 26/30 [00:11<00:01,  2.16it/s] 90%|█████████ | 27/30 [00:12<00:01,  2.29it/s] 93%|█████████▎| 28/30 [00:12<00:00,  2.50it/s] 97%|█████████▋| 29/30 [00:12<00:00,  2.61it/s]100%|██████████| 30/30 [00:13<00:00,  2.72it/s]100%|██████████| 30/30 [00:13<00:00,  2.29it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_6722602826685649765_2280_000_2300_000_1_NobqX95Kf7CR9x1pNFjyUw.npz
metrics: {'epe3d_allo_image_all': 0.2631948933005333, 'epe3d_allo_pixel_all': 0.27227058081791317, 'epe3d_sf_allo_image_all': 0.2150534691909949, 'epe3d_sf_allo_pixel_all': 0.2224691040410197, 'num_valid_pixels': 406.0, 'delta_0.05': 0.9285714285714286, 'delta_0.1': 1.0, 'delta_0.2': 1.0, 'delta_0.4': 1.0, 'outlier_0.15': 0.0, 'delta_epe_0.1': 0.12807881773399016, 'delta_epe_0.3': 0.7783251231527094, 'delta_epe_0.5': 0.9802955665024631, 'delta_epe_1.0': 1.0, 'outlier_epe_0.25': 0.35960591133004927}
Processing sequence: tapvid3d_14133920963894906769_1480_000_1500_000_3_KSPCQq3x1TP1os4O6y3joA.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:17,  2.72it/s]  4%|▍         | 2/50 [00:00<00:19,  2.42it/s]  6%|▌         | 3/50 [00:01<00:17,  2.63it/s]  8%|▊         | 4/50 [00:01<00:17,  2.66it/s] 10%|█         | 5/50 [00:01<00:16,  2.67it/s] 12%|█▏        | 6/50 [00:02<00:17,  2.45it/s] 14%|█▍        | 7/50 [00:02<00:17,  2.52it/s] 16%|█▌        | 8/50 [00:03<00:16,  2.55it/s] 18%|█▊        | 9/50 [00:03<00:16,  2.52it/s] 20%|██        | 10/50 [00:03<00:16,  2.39it/s] 22%|██▏       | 11/50 [00:04<00:15,  2.53it/s] 24%|██▍       | 12/50 [00:04<00:14,  2.57it/s] 26%|██▌       | 13/50 [00:05<00:13,  2.76it/s] 28%|██▊       | 14/50 [00:05<00:15,  2.31it/s] 30%|███       | 15/50 [00:05<00:14,  2.45it/s] 32%|███▏      | 16/50 [00:06<00:13,  2.52it/s] 34%|███▍      | 17/50 [00:06<00:13,  2.53it/s] 36%|███▌      | 18/50 [00:07<00:12,  2.53it/s] 38%|███▊      | 19/50 [00:07<00:12,  2.54it/s] 40%|████      | 20/50 [00:07<00:11,  2.59it/s] 42%|████▏     | 21/50 [00:08<00:11,  2.62it/s] 44%|████▍     | 22/50 [00:08<00:10,  2.61it/s] 46%|████▌     | 23/50 [00:09<00:10,  2.60it/s] 48%|████▊     | 24/50 [00:09<00:09,  2.74it/s] 50%|█████     | 25/50 [00:09<00:09,  2.72it/s] 52%|█████▏    | 26/50 [00:10<00:08,  2.67it/s] 54%|█████▍    | 27/50 [00:10<00:08,  2.60it/s] 56%|█████▌    | 28/50 [00:10<00:08,  2.67it/s] 58%|█████▊    | 29/50 [00:11<00:07,  2.65it/s] 60%|██████    | 30/50 [00:11<00:07,  2.60it/s] 62%|██████▏   | 31/50 [00:12<00:07,  2.65it/s] 64%|██████▍   | 32/50 [00:12<00:06,  2.64it/s] 66%|██████▌   | 33/50 [00:13<00:08,  2.04it/s] 68%|██████▊   | 34/50 [00:13<00:07,  2.15it/s] 70%|███████   | 35/50 [00:13<00:06,  2.28it/s] 72%|███████▏  | 36/50 [00:14<00:05,  2.41it/s] 74%|███████▍  | 37/50 [00:14<00:05,  2.51it/s] 76%|███████▌  | 38/50 [00:15<00:04,  2.51it/s] 78%|███████▊  | 39/50 [00:15<00:04,  2.56it/s] 80%|████████  | 40/50 [00:15<00:03,  2.65it/s] 82%|████████▏ | 41/50 [00:16<00:03,  2.80it/s] 84%|████████▍ | 42/50 [00:16<00:02,  2.80it/s] 86%|████████▌ | 43/50 [00:16<00:02,  2.77it/s] 88%|████████▊ | 44/50 [00:17<00:02,  2.84it/s] 90%|█████████ | 45/50 [00:17<00:01,  2.98it/s] 92%|█████████▏| 46/50 [00:17<00:01,  3.05it/s] 94%|█████████▍| 47/50 [00:18<00:01,  2.70it/s] 96%|█████████▌| 48/50 [00:18<00:00,  2.86it/s] 98%|█████████▊| 49/50 [00:18<00:00,  2.63it/s]100%|██████████| 50/50 [00:19<00:00,  2.51it/s]100%|██████████| 50/50 [00:19<00:00,  2.58it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c5070e360>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:25,  1.89it/s]  4%|▍         | 2/50 [00:00<00:16,  2.86it/s]  6%|▌         | 3/50 [00:01<00:14,  3.29it/s]  8%|▊         | 4/50 [00:01<00:13,  3.36it/s] 10%|█         | 5/50 [00:01<00:12,  3.61it/s] 12%|█▏        | 6/50 [00:01<00:11,  3.81it/s] 14%|█▍        | 7/50 [00:02<00:11,  3.86it/s] 16%|█▌        | 8/50 [00:02<00:10,  3.86it/s] 18%|█▊        | 9/50 [00:02<00:10,  4.00it/s] 20%|██        | 10/50 [00:02<00:10,  3.98it/s] 22%|██▏       | 11/50 [00:03<00:09,  3.96it/s] 24%|██▍       | 12/50 [00:03<00:11,  3.17it/s] 26%|██▌       | 13/50 [00:03<00:12,  3.08it/s] 28%|██▊       | 14/50 [00:04<00:13,  2.73it/s] 30%|███       | 15/50 [00:04<00:11,  3.08it/s] 32%|███▏      | 16/50 [00:04<00:10,  3.29it/s] 34%|███▍      | 17/50 [00:05<00:09,  3.51it/s] 36%|███▌      | 18/50 [00:05<00:08,  3.57it/s] 38%|███▊      | 19/50 [00:06<00:13,  2.32it/s] 40%|████      | 20/50 [00:06<00:11,  2.69it/s] 42%|████▏     | 21/50 [00:06<00:09,  3.03it/s] 44%|████▍     | 22/50 [00:06<00:08,  3.33it/s] 46%|████▌     | 23/50 [00:06<00:07,  3.55it/s] 48%|████▊     | 24/50 [00:07<00:06,  3.74it/s] 50%|█████     | 25/50 [00:07<00:06,  3.79it/s] 52%|█████▏    | 26/50 [00:07<00:06,  3.89it/s] 54%|█████▍    | 27/50 [00:07<00:05,  3.94it/s] 56%|█████▌    | 28/50 [00:08<00:05,  4.04it/s] 58%|█████▊    | 29/50 [00:08<00:05,  4.11it/s] 60%|██████    | 30/50 [00:08<00:04,  4.16it/s] 62%|██████▏   | 31/50 [00:08<00:04,  4.22it/s] 64%|██████▍   | 32/50 [00:09<00:04,  4.18it/s] 66%|██████▌   | 33/50 [00:09<00:04,  4.21it/s] 68%|██████▊   | 34/50 [00:09<00:04,  3.81it/s] 70%|███████   | 35/50 [00:09<00:03,  3.91it/s] 72%|███████▏  | 36/50 [00:10<00:03,  4.03it/s] 74%|███████▍  | 37/50 [00:10<00:03,  4.13it/s] 76%|███████▌  | 38/50 [00:10<00:02,  4.19it/s] 78%|███████▊  | 39/50 [00:10<00:02,  4.24it/s] 80%|████████  | 40/50 [00:11<00:02,  4.22it/s] 82%|████████▏ | 41/50 [00:11<00:02,  4.16it/s] 84%|████████▍ | 42/50 [00:11<00:02,  3.15it/s] 86%|████████▌ | 43/50 [00:12<00:02,  3.43it/s] 88%|████████▊ | 44/50 [00:12<00:01,  3.67it/s] 90%|█████████ | 45/50 [00:12<00:01,  3.86it/s] 92%|█████████▏| 46/50 [00:12<00:01,  3.91it/s] 94%|█████████▍| 47/50 [00:13<00:00,  4.03it/s] 96%|█████████▌| 48/50 [00:13<00:00,  4.00it/s] 98%|█████████▊| 49/50 [00:13<00:00,  3.97it/s]100%|██████████| 50/50 [00:14<00:00,  3.05it/s]100%|██████████| 50/50 [00:14<00:00,  3.55it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 60988
INFO:root:Parameters : 2223
INFO:root:Iterations : 101
INFO:root:Time : 2.5304481983184814 [s]
INFO:root:Initial cost : 1.3647712286654758 [px]
INFO:root:Final cost : 0.3434369912854069 [px]
INFO:root:Residuals : 62024
INFO:root:Parameters : 2271
INFO:root:Iterations : 101
INFO:root:Time : 2.616910934448242 [s]
INFO:root:Initial cost : 1.1790655987169805 [px]
INFO:root:Final cost : 0.29562583281992255 [px]
INFO:root:Residuals : 61992
INFO:root:Parameters : 2283
INFO:root:Iterations : 101
INFO:root:Time : 2.9968371391296387 [s]
INFO:root:Initial cost : 1.172714114847244 [px]
INFO:root:Final cost : 0.31996077880775053 [px]
INFO:root:Residuals : 62542
INFO:root:Parameters : 2307
INFO:root:Iterations : 101
INFO:root:Time : 2.7926058769226074 [s]
INFO:root:Initial cost : 1.127404402553436 [px]
INFO:root:Final cost : 0.24876235539135455 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:17,  2.80it/s]  4%|▍         | 2/50 [00:00<00:20,  2.36it/s]  6%|▌         | 3/50 [00:01<00:17,  2.63it/s]  8%|▊         | 4/50 [00:01<00:16,  2.82it/s] 10%|█         | 5/50 [00:01<00:15,  2.82it/s] 12%|█▏        | 6/50 [00:02<00:16,  2.61it/s] 14%|█▍        | 7/50 [00:02<00:16,  2.58it/s] 16%|█▌        | 8/50 [00:03<00:15,  2.66it/s] 18%|█▊        | 9/50 [00:03<00:18,  2.25it/s] 20%|██        | 10/50 [00:03<00:16,  2.37it/s] 22%|██▏       | 11/50 [00:04<00:15,  2.49it/s] 24%|██▍       | 12/50 [00:07<00:42,  1.12s/it] 26%|██▌       | 13/50 [00:07<00:33,  1.12it/s] 28%|██▊       | 14/50 [00:07<00:27,  1.31it/s] 30%|███       | 15/50 [00:08<00:22,  1.58it/s] 32%|███▏      | 16/50 [00:08<00:18,  1.86it/s] 34%|███▍      | 17/50 [00:08<00:15,  2.07it/s] 36%|███▌      | 18/50 [00:09<00:18,  1.75it/s] 38%|███▊      | 19/50 [00:10<00:18,  1.67it/s] 40%|████      | 20/50 [00:10<00:16,  1.85it/s] 42%|████▏     | 21/50 [00:11<00:15,  1.86it/s] 44%|████▍     | 22/50 [00:11<00:14,  1.98it/s] 46%|████▌     | 23/50 [00:12<00:13,  1.94it/s] 48%|████▊     | 24/50 [00:12<00:12,  2.13it/s] 50%|█████     | 25/50 [00:13<00:10,  2.28it/s] 52%|█████▏    | 26/50 [00:13<00:10,  2.40it/s] 54%|█████▍    | 27/50 [00:13<00:09,  2.46it/s] 56%|█████▌    | 28/50 [00:14<00:09,  2.43it/s] 58%|█████▊    | 29/50 [00:14<00:08,  2.47it/s] 60%|██████    | 30/50 [00:14<00:07,  2.65it/s] 62%|██████▏   | 31/50 [00:15<00:06,  2.79it/s] 64%|██████▍   | 32/50 [00:15<00:06,  2.83it/s] 66%|██████▌   | 33/50 [00:16<00:06,  2.55it/s] 68%|██████▊   | 34/50 [00:16<00:06,  2.50it/s] 70%|███████   | 35/50 [00:16<00:06,  2.50it/s] 72%|███████▏  | 36/50 [00:17<00:06,  2.07it/s] 74%|███████▍  | 37/50 [00:17<00:05,  2.30it/s] 76%|███████▌  | 38/50 [00:18<00:04,  2.47it/s] 78%|███████▊  | 39/50 [00:18<00:04,  2.60it/s] 80%|████████  | 40/50 [00:18<00:03,  2.67it/s] 82%|████████▏ | 41/50 [00:19<00:03,  2.57it/s] 84%|████████▍ | 42/50 [00:19<00:03,  2.38it/s] 86%|████████▌ | 43/50 [00:20<00:03,  2.33it/s] 88%|████████▊ | 44/50 [00:20<00:02,  2.40it/s] 90%|█████████ | 45/50 [00:20<00:02,  2.45it/s] 92%|█████████▏| 46/50 [00:21<00:01,  2.42it/s] 94%|█████████▍| 47/50 [00:21<00:01,  2.58it/s] 96%|█████████▌| 48/50 [00:22<00:00,  2.61it/s] 98%|█████████▊| 49/50 [00:22<00:00,  2.75it/s]100%|██████████| 50/50 [00:22<00:00,  2.55it/s]100%|██████████| 50/50 [00:22<00:00,  2.18it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_14133920963894906769_1480_000_1500_000_3_KSPCQq3x1TP1os4O6y3joA.npz
metrics: {'epe3d_allo_image_all': 1.100411829650402, 'epe3d_allo_pixel_all': 1.1228692166659298, 'epe3d_sf_allo_image_all': 3.101274605989456, 'epe3d_sf_allo_pixel_all': 3.16456591839693, 'num_valid_pixels': 588.0, 'delta_0.05': 0.7108843537414966, 'delta_0.1': 1.0, 'delta_0.2': 1.0, 'delta_0.4': 1.0, 'outlier_0.15': 0.0, 'delta_epe_0.1': 0.0, 'delta_epe_0.3': 0.0, 'delta_epe_0.5': 0.0, 'delta_epe_1.0': 0.05272108843537415, 'outlier_epe_0.25': 1.0}
Processing sequence: tapvid3d_10235335145367115211_5420_000_5440_000_2_4iry-kJsWTWnjLdVm-S8XA.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:19,  2.57it/s]  4%|▍         | 2/50 [00:00<00:20,  2.34it/s]  6%|▌         | 3/50 [00:01<00:19,  2.38it/s]  8%|▊         | 4/50 [00:01<00:23,  1.94it/s] 10%|█         | 5/50 [00:02<00:22,  2.00it/s] 12%|█▏        | 6/50 [00:02<00:19,  2.28it/s] 14%|█▍        | 7/50 [00:03<00:17,  2.52it/s] 16%|█▌        | 8/50 [00:03<00:15,  2.70it/s] 18%|█▊        | 9/50 [00:03<00:15,  2.71it/s] 20%|██        | 10/50 [00:04<00:14,  2.79it/s] 22%|██▏       | 11/50 [00:04<00:13,  2.90it/s] 24%|██▍       | 12/50 [00:04<00:12,  2.99it/s] 26%|██▌       | 13/50 [00:05<00:12,  2.85it/s] 28%|██▊       | 14/50 [00:05<00:12,  2.90it/s] 30%|███       | 15/50 [00:05<00:12,  2.88it/s] 32%|███▏      | 16/50 [00:06<00:11,  2.84it/s] 34%|███▍      | 17/50 [00:06<00:11,  2.78it/s] 36%|███▌      | 18/50 [00:06<00:11,  2.84it/s] 38%|███▊      | 19/50 [00:07<00:11,  2.80it/s] 40%|████      | 20/50 [00:07<00:10,  2.84it/s] 42%|████▏     | 21/50 [00:08<00:11,  2.47it/s] 44%|████▍     | 22/50 [00:08<00:10,  2.63it/s] 46%|████▌     | 23/50 [00:08<00:09,  2.78it/s] 48%|████▊     | 24/50 [00:09<00:09,  2.80it/s] 50%|█████     | 25/50 [00:09<00:08,  2.87it/s] 52%|█████▏    | 26/50 [00:09<00:08,  2.91it/s] 54%|█████▍    | 27/50 [00:10<00:07,  2.95it/s] 56%|█████▌    | 28/50 [00:10<00:07,  2.87it/s] 58%|█████▊    | 29/50 [00:10<00:07,  2.96it/s] 60%|██████    | 30/50 [00:11<00:07,  2.64it/s] 62%|██████▏   | 31/50 [00:11<00:08,  2.30it/s] 64%|██████▍   | 32/50 [00:12<00:08,  2.25it/s] 66%|██████▌   | 33/50 [00:12<00:06,  2.43it/s] 68%|██████▊   | 34/50 [00:13<00:08,  1.87it/s] 70%|███████   | 35/50 [00:13<00:07,  2.00it/s] 72%|███████▏  | 36/50 [00:14<00:06,  2.10it/s] 74%|███████▍  | 37/50 [00:14<00:06,  2.16it/s] 76%|███████▌  | 38/50 [00:15<00:05,  2.18it/s] 78%|███████▊  | 39/50 [00:15<00:04,  2.21it/s] 80%|████████  | 40/50 [00:15<00:04,  2.26it/s] 82%|████████▏ | 41/50 [00:16<00:03,  2.28it/s] 84%|████████▍ | 42/50 [00:16<00:03,  2.33it/s] 86%|████████▌ | 43/50 [00:17<00:02,  2.35it/s] 88%|████████▊ | 44/50 [00:17<00:02,  2.40it/s] 90%|█████████ | 45/50 [00:17<00:01,  2.54it/s] 92%|█████████▏| 46/50 [00:18<00:01,  2.48it/s] 94%|█████████▍| 47/50 [00:18<00:01,  2.46it/s] 96%|█████████▌| 48/50 [00:19<00:00,  2.50it/s] 98%|█████████▊| 49/50 [00:19<00:00,  2.68it/s]100%|██████████| 50/50 [00:19<00:00,  2.82it/s]100%|██████████| 50/50 [00:19<00:00,  2.53it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c50a1e240>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:25,  1.92it/s]  4%|▍         | 2/50 [00:00<00:16,  2.89it/s]  6%|▌         | 3/50 [00:00<00:13,  3.36it/s]  8%|▊         | 4/50 [00:01<00:12,  3.64it/s] 10%|█         | 5/50 [00:01<00:11,  3.83it/s] 12%|█▏        | 6/50 [00:01<00:11,  3.94it/s] 14%|█▍        | 7/50 [00:01<00:11,  3.89it/s] 16%|█▌        | 8/50 [00:02<00:10,  3.91it/s] 18%|█▊        | 9/50 [00:02<00:10,  3.98it/s] 20%|██        | 10/50 [00:02<00:09,  4.03it/s] 22%|██▏       | 11/50 [00:02<00:09,  4.06it/s] 24%|██▍       | 12/50 [00:03<00:09,  4.10it/s] 26%|██▌       | 13/50 [00:03<00:08,  4.13it/s] 28%|██▊       | 14/50 [00:03<00:09,  3.96it/s] 30%|███       | 15/50 [00:03<00:08,  4.03it/s] 32%|███▏      | 16/50 [00:04<00:08,  4.06it/s] 34%|███▍      | 17/50 [00:04<00:08,  4.09it/s] 36%|███▌      | 18/50 [00:04<00:07,  4.13it/s] 38%|███▊      | 19/50 [00:04<00:07,  4.14it/s] 40%|████      | 20/50 [00:05<00:07,  3.98it/s] 42%|████▏     | 21/50 [00:05<00:07,  4.04it/s] 44%|████▍     | 22/50 [00:05<00:06,  4.09it/s] 46%|████▌     | 23/50 [00:05<00:06,  4.12it/s] 48%|████▊     | 24/50 [00:06<00:06,  4.14it/s] 50%|█████     | 25/50 [00:06<00:05,  4.17it/s] 52%|█████▏    | 26/50 [00:06<00:05,  4.18it/s] 54%|█████▍    | 27/50 [00:06<00:05,  4.20it/s] 56%|█████▌    | 28/50 [00:07<00:05,  4.20it/s] 58%|█████▊    | 29/50 [00:07<00:04,  4.21it/s] 60%|██████    | 30/50 [00:07<00:05,  3.64it/s] 62%|██████▏   | 31/50 [00:07<00:05,  3.80it/s] 64%|██████▍   | 32/50 [00:08<00:04,  3.89it/s] 66%|██████▌   | 33/50 [00:08<00:04,  3.98it/s] 68%|██████▊   | 34/50 [00:08<00:04,  3.68it/s] 70%|███████   | 35/50 [00:08<00:04,  3.73it/s] 72%|███████▏  | 36/50 [00:09<00:03,  3.78it/s] 74%|███████▍  | 37/50 [00:09<00:03,  3.85it/s] 76%|███████▌  | 38/50 [00:09<00:03,  3.88it/s] 78%|███████▊  | 39/50 [00:09<00:02,  3.89it/s] 80%|████████  | 40/50 [00:10<00:02,  3.87it/s] 82%|████████▏ | 41/50 [00:10<00:02,  3.82it/s] 84%|████████▍ | 42/50 [00:12<00:06,  1.15it/s] 86%|████████▌ | 43/50 [00:13<00:05,  1.35it/s] 88%|████████▊ | 44/50 [00:13<00:03,  1.67it/s] 90%|█████████ | 45/50 [00:13<00:02,  2.02it/s] 92%|█████████▏| 46/50 [00:14<00:01,  2.33it/s] 94%|█████████▍| 47/50 [00:14<00:01,  2.63it/s] 96%|█████████▌| 48/50 [00:14<00:00,  2.65it/s] 98%|█████████▊| 49/50 [00:14<00:00,  2.84it/s]100%|██████████| 50/50 [00:15<00:00,  2.93it/s]100%|██████████| 50/50 [00:15<00:00,  3.26it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 33842
INFO:root:Parameters : 1971
INFO:root:Iterations : 101
INFO:root:Time : 1.508188009262085 [s]
INFO:root:Initial cost : 13.49262314902453 [px]
INFO:root:Final cost : 1.2634394788017007 [px]
INFO:root:Residuals : 24628
INFO:root:Parameters : 1473
INFO:root:Iterations : 101
INFO:root:Time : 0.9695701599121094 [s]
INFO:root:Initial cost : 5.188907872305805 [px]
INFO:root:Final cost : 0.5560175717220286 [px]
INFO:root:Residuals : 21268
INFO:root:Parameters : 1383
INFO:root:Iterations : 101
INFO:root:Time : 1.5094830989837646 [s]
INFO:root:Initial cost : 3.799516356031377 [px]
INFO:root:Final cost : 0.5304267502194899 [px]
INFO:root:Residuals : 22122
INFO:root:Parameters : 1458
INFO:root:Iterations : 101
INFO:root:Time : 1.7053380012512207 [s]
INFO:root:Initial cost : 4.025213585043897 [px]
INFO:root:Final cost : 0.5543330414592484 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:31,  1.57it/s]  4%|▍         | 2/50 [00:01<00:28,  1.69it/s]  6%|▌         | 3/50 [00:01<00:24,  1.89it/s]  8%|▊         | 4/50 [00:02<00:24,  1.91it/s] 10%|█         | 5/50 [00:02<00:23,  1.91it/s] 12%|█▏        | 6/50 [00:03<00:22,  1.95it/s] 14%|█▍        | 7/50 [00:03<00:21,  1.95it/s] 16%|█▌        | 8/50 [00:04<00:21,  1.95it/s] 18%|█▊        | 9/50 [00:04<00:21,  1.88it/s] 20%|██        | 10/50 [00:05<00:21,  1.88it/s] 22%|██▏       | 11/50 [00:05<00:20,  1.91it/s] 24%|██▍       | 12/50 [00:06<00:20,  1.88it/s] 26%|██▌       | 13/50 [00:06<00:19,  1.94it/s] 28%|██▊       | 14/50 [00:07<00:24,  1.48it/s] 30%|███       | 15/50 [00:08<00:20,  1.67it/s] 32%|███▏      | 16/50 [00:08<00:18,  1.86it/s] 34%|███▍      | 17/50 [00:09<00:15,  2.07it/s] 36%|███▌      | 18/50 [00:09<00:13,  2.29it/s] 38%|███▊      | 19/50 [00:10<00:16,  1.84it/s] 40%|████      | 20/50 [00:10<00:15,  1.99it/s] 42%|████▏     | 21/50 [00:12<00:29,  1.03s/it] 44%|████▍     | 22/50 [00:13<00:23,  1.17it/s] 46%|████▌     | 23/50 [00:13<00:19,  1.39it/s] 48%|████▊     | 24/50 [00:14<00:16,  1.60it/s] 50%|█████     | 25/50 [00:14<00:13,  1.83it/s] 52%|█████▏    | 26/50 [00:14<00:12,  1.97it/s] 54%|█████▍    | 27/50 [00:15<00:11,  2.05it/s] 56%|█████▌    | 28/50 [00:15<00:10,  2.10it/s] 58%|█████▊    | 29/50 [00:16<00:09,  2.20it/s] 60%|██████    | 30/50 [00:16<00:08,  2.39it/s] 62%|██████▏   | 31/50 [00:16<00:07,  2.41it/s] 64%|██████▍   | 32/50 [00:17<00:07,  2.36it/s] 66%|██████▌   | 33/50 [00:17<00:07,  2.36it/s] 68%|██████▊   | 34/50 [00:19<00:14,  1.10it/s] 70%|███████   | 35/50 [00:20<00:11,  1.36it/s] 72%|███████▏  | 36/50 [00:20<00:08,  1.62it/s] 74%|███████▍  | 37/50 [00:20<00:06,  1.88it/s] 76%|███████▌  | 38/50 [00:21<00:05,  2.05it/s] 78%|███████▊  | 39/50 [00:21<00:04,  2.28it/s] 80%|████████  | 40/50 [00:21<00:04,  2.48it/s] 82%|████████▏ | 41/50 [00:22<00:03,  2.60it/s] 84%|████████▍ | 42/50 [00:22<00:03,  2.29it/s] 86%|████████▌ | 43/50 [00:23<00:02,  2.48it/s] 88%|████████▊ | 44/50 [00:23<00:02,  2.64it/s] 90%|█████████ | 45/50 [00:23<00:01,  2.65it/s] 92%|█████████▏| 46/50 [00:24<00:01,  2.73it/s] 94%|█████████▍| 47/50 [00:24<00:01,  2.68it/s] 96%|█████████▌| 48/50 [00:24<00:00,  2.75it/s] 98%|█████████▊| 49/50 [00:25<00:00,  2.82it/s]100%|██████████| 50/50 [00:25<00:00,  2.90it/s]100%|██████████| 50/50 [00:25<00:00,  1.96it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_10235335145367115211_5420_000_5440_000_2_4iry-kJsWTWnjLdVm-S8XA.npz
metrics: {'epe3d_allo_image_all': 5.913902441263199, 'epe3d_allo_pixel_all': 6.03459432781959, 'epe3d_sf_allo_image_all': 16.895436331033707, 'epe3d_sf_allo_pixel_all': 17.240241154116028, 'num_valid_pixels': 98.0, 'delta_0.05': 0.2755102040816326, 'delta_0.1': 0.45918367346938777, 'delta_0.2': 0.7346938775510204, 'delta_0.4': 1.0, 'outlier_0.15': 0.42857142857142855, 'delta_epe_0.1': 0.0, 'delta_epe_0.3': 0.02040816326530612, 'delta_epe_0.5': 0.02040816326530612, 'delta_epe_1.0': 0.02040816326530612, 'outlier_epe_0.25': 1.0}
Processing sequence: tapvid3d_15787777881771177481_8820_000_8840_000_1_UXZ_-cxfnEoFoB1zGjetcg.npz with 24 pairs
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:06,  3.78it/s]  8%|▊         | 2/24 [00:00<00:06,  3.67it/s] 12%|█▎        | 3/24 [00:00<00:05,  3.65it/s] 17%|█▋        | 4/24 [00:01<00:06,  3.19it/s] 21%|██        | 5/24 [00:01<00:05,  3.29it/s] 25%|██▌       | 6/24 [00:01<00:05,  3.28it/s] 29%|██▉       | 7/24 [00:02<00:04,  3.41it/s] 33%|███▎      | 8/24 [00:02<00:04,  3.52it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.55it/s] 42%|████▏     | 10/24 [00:02<00:03,  3.57it/s] 46%|████▌     | 11/24 [00:03<00:03,  3.52it/s] 50%|█████     | 12/24 [00:03<00:03,  3.57it/s] 54%|█████▍    | 13/24 [00:03<00:03,  3.58it/s] 58%|█████▊    | 14/24 [00:03<00:02,  3.63it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.44it/s] 67%|██████▋   | 16/24 [00:04<00:02,  3.51it/s] 71%|███████   | 17/24 [00:04<00:01,  3.58it/s] 75%|███████▌  | 18/24 [00:05<00:01,  3.59it/s] 79%|███████▉  | 19/24 [00:05<00:01,  3.60it/s] 83%|████████▎ | 20/24 [00:05<00:01,  3.41it/s] 88%|████████▊ | 21/24 [00:05<00:00,  3.50it/s] 92%|█████████▏| 22/24 [00:06<00:00,  3.54it/s] 96%|█████████▌| 23/24 [00:06<00:00,  3.28it/s]100%|██████████| 24/24 [00:07<00:00,  2.91it/s]100%|██████████| 24/24 [00:07<00:00,  3.40it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c50a40fe0>
Test dataset length:  24
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:13,  1.69it/s]  8%|▊         | 2/24 [00:00<00:07,  2.76it/s] 12%|█▎        | 3/24 [00:01<00:06,  3.04it/s] 17%|█▋        | 4/24 [00:01<00:09,  2.20it/s] 21%|██        | 5/24 [00:01<00:07,  2.64it/s] 25%|██▌       | 6/24 [00:02<00:05,  3.09it/s] 29%|██▉       | 7/24 [00:02<00:05,  3.39it/s] 33%|███▎      | 8/24 [00:02<00:04,  3.71it/s] 38%|███▊      | 9/24 [00:02<00:03,  3.90it/s] 42%|████▏     | 10/24 [00:03<00:03,  4.12it/s] 46%|████▌     | 11/24 [00:03<00:03,  4.29it/s] 50%|█████     | 12/24 [00:03<00:02,  4.42it/s] 54%|█████▍    | 13/24 [00:03<00:02,  4.50it/s] 58%|█████▊    | 14/24 [00:04<00:03,  2.92it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.25it/s] 67%|██████▋   | 16/24 [00:04<00:02,  3.53it/s] 71%|███████   | 17/24 [00:04<00:01,  3.88it/s] 75%|███████▌  | 18/24 [00:05<00:01,  4.14it/s] 79%|███████▉  | 19/24 [00:05<00:01,  4.38it/s] 83%|████████▎ | 20/24 [00:05<00:00,  4.57it/s] 88%|████████▊ | 21/24 [00:05<00:00,  4.72it/s] 92%|█████████▏| 22/24 [00:05<00:00,  4.70it/s] 96%|█████████▌| 23/24 [00:06<00:00,  4.78it/s]100%|██████████| 24/24 [00:06<00:00,  4.72it/s]100%|██████████| 24/24 [00:06<00:00,  3.71it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 18884
INFO:root:Parameters : 2088
INFO:root:Iterations : 101
INFO:root:Time : 0.8343579769134521 [s]
INFO:root:Initial cost : 10.286142503395121 [px]
INFO:root:Final cost : 1.1351505554400885 [px]
INFO:root:Residuals : 15608
INFO:root:Parameters : 1644
INFO:root:Iterations : 101
INFO:root:Time : 0.7598950862884521 [s]
INFO:root:Initial cost : 4.003958757357176 [px]
INFO:root:Final cost : 0.6201212191014708 [px]
INFO:root:Residuals : 13656
INFO:root:Parameters : 1533
INFO:root:Iterations : 101
INFO:root:Time : 0.648094892501831 [s]
INFO:root:Initial cost : 3.4076439025144323 [px]
INFO:root:Final cost : 0.497790171228523 [px]
INFO:root:Residuals : 13906
INFO:root:Parameters : 1584
INFO:root:Iterations : 101
INFO:root:Time : 0.7220759391784668 [s]
INFO:root:Initial cost : 3.4079845327877867 [px]
INFO:root:Final cost : 0.47597184947679577 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:10,  2.16it/s]  8%|▊         | 2/24 [00:00<00:08,  2.68it/s] 12%|█▎        | 3/24 [00:01<00:06,  3.01it/s] 17%|█▋        | 4/24 [00:01<00:06,  3.20it/s] 21%|██        | 5/24 [00:01<00:05,  3.30it/s] 25%|██▌       | 6/24 [00:01<00:05,  3.34it/s] 29%|██▉       | 7/24 [00:02<00:05,  3.23it/s] 33%|███▎      | 8/24 [00:02<00:04,  3.31it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.37it/s] 42%|████▏     | 10/24 [00:03<00:04,  3.30it/s] 46%|████▌     | 11/24 [00:03<00:04,  3.11it/s] 50%|█████     | 12/24 [00:03<00:03,  3.12it/s] 54%|█████▍    | 13/24 [00:04<00:03,  2.99it/s] 58%|█████▊    | 14/24 [00:04<00:03,  3.05it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.07it/s] 67%|██████▋   | 16/24 [00:05<00:03,  2.27it/s] 71%|███████   | 17/24 [00:05<00:03,  2.29it/s] 75%|███████▌  | 18/24 [00:06<00:02,  2.46it/s] 79%|███████▉  | 19/24 [00:06<00:01,  2.60it/s] 83%|████████▎ | 20/24 [00:06<00:01,  2.82it/s] 88%|████████▊ | 21/24 [00:07<00:01,  2.66it/s] 92%|█████████▏| 22/24 [00:07<00:00,  2.85it/s] 96%|█████████▌| 23/24 [00:07<00:00,  2.91it/s]100%|██████████| 24/24 [00:08<00:00,  2.99it/s]100%|██████████| 24/24 [00:08<00:00,  2.90it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_15787777881771177481_8820_000_8840_000_1_UXZ_-cxfnEoFoB1zGjetcg.npz
metrics: {'epe3d_allo_image_all': 4.311319902539253, 'epe3d_allo_pixel_all': 4.498768593954003, 'epe3d_sf_allo_image_all': 8.84444938848416, 'epe3d_sf_allo_pixel_all': 9.228990666244341, 'num_valid_pixels': 368.0, 'delta_0.05': 0.22554347826086957, 'delta_0.1': 0.6277173913043478, 'delta_0.2': 0.9375, 'delta_0.4': 1.0, 'outlier_0.15': 0.15760869565217392, 'delta_epe_0.1': 0.0, 'delta_epe_0.3': 0.0, 'delta_epe_0.5': 0.0, 'delta_epe_1.0': 0.043478260869565216, 'outlier_epe_0.25': 1.0}
Processing sequence: tapvid3d_12979718722917614085_1039_490_1059_490_1_KhrMLUyoIY_G1Khh0CNvlA.npz with 28 pairs
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:08,  3.22it/s]  7%|▋         | 2/28 [00:00<00:08,  3.01it/s] 11%|█         | 3/28 [00:00<00:08,  3.02it/s] 14%|█▍        | 4/28 [00:01<00:07,  3.08it/s] 18%|█▊        | 5/28 [00:01<00:08,  2.69it/s] 21%|██▏       | 6/28 [00:02<00:07,  2.91it/s] 25%|██▌       | 7/28 [00:02<00:06,  3.11it/s] 29%|██▊       | 8/28 [00:02<00:06,  3.20it/s] 32%|███▏      | 9/28 [00:02<00:05,  3.36it/s] 36%|███▌      | 10/28 [00:03<00:05,  3.47it/s] 39%|███▉      | 11/28 [00:03<00:05,  3.36it/s] 43%|████▎     | 12/28 [00:03<00:04,  3.23it/s] 46%|████▋     | 13/28 [00:04<00:05,  2.62it/s] 50%|█████     | 14/28 [00:04<00:05,  2.64it/s] 54%|█████▎    | 15/28 [00:05<00:04,  2.78it/s] 57%|█████▋    | 16/28 [00:05<00:04,  2.83it/s] 61%|██████    | 17/28 [00:05<00:03,  2.89it/s] 64%|██████▍   | 18/28 [00:06<00:03,  2.96it/s] 68%|██████▊   | 19/28 [00:06<00:02,  3.04it/s] 71%|███████▏  | 20/28 [00:06<00:02,  2.99it/s] 75%|███████▌  | 21/28 [00:06<00:02,  3.19it/s] 79%|███████▊  | 22/28 [00:07<00:02,  2.67it/s] 82%|████████▏ | 23/28 [00:07<00:01,  2.53it/s] 86%|████████▌ | 24/28 [00:08<00:01,  2.70it/s] 89%|████████▉ | 25/28 [00:08<00:01,  2.87it/s] 93%|█████████▎| 26/28 [00:08<00:00,  3.10it/s] 96%|█████████▋| 27/28 [00:09<00:00,  3.22it/s]100%|██████████| 28/28 [00:09<00:00,  3.34it/s]100%|██████████| 28/28 [00:09<00:00,  3.00it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c5085f200>
Test dataset length:  28
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:13,  2.03it/s]  7%|▋         | 2/28 [00:00<00:08,  3.08it/s] 11%|█         | 3/28 [00:00<00:06,  3.66it/s] 14%|█▍        | 4/28 [00:01<00:05,  4.11it/s] 18%|█▊        | 5/28 [00:01<00:05,  4.33it/s] 21%|██▏       | 6/28 [00:01<00:04,  4.42it/s] 25%|██▌       | 7/28 [00:01<00:04,  4.63it/s] 29%|██▊       | 8/28 [00:01<00:04,  4.67it/s] 32%|███▏      | 9/28 [00:02<00:04,  4.71it/s] 36%|███▌      | 10/28 [00:02<00:03,  4.72it/s] 39%|███▉      | 11/28 [00:02<00:03,  4.83it/s] 43%|████▎     | 12/28 [00:02<00:03,  4.66it/s] 46%|████▋     | 13/28 [00:02<00:03,  4.80it/s] 50%|█████     | 14/28 [00:03<00:02,  4.87it/s] 54%|█████▎    | 15/28 [00:03<00:02,  4.88it/s] 57%|█████▋    | 16/28 [00:03<00:02,  4.89it/s] 61%|██████    | 17/28 [00:03<00:02,  4.82it/s] 64%|██████▍   | 18/28 [00:03<00:02,  4.92it/s] 68%|██████▊   | 19/28 [00:04<00:01,  4.98it/s] 71%|███████▏  | 20/28 [00:04<00:01,  4.89it/s] 75%|███████▌  | 21/28 [00:04<00:01,  4.93it/s] 79%|███████▊  | 22/28 [00:04<00:01,  4.94it/s] 82%|████████▏ | 23/28 [00:05<00:01,  4.98it/s] 86%|████████▌ | 24/28 [00:05<00:00,  4.94it/s] 89%|████████▉ | 25/28 [00:05<00:00,  4.88it/s] 93%|█████████▎| 26/28 [00:05<00:00,  4.91it/s] 96%|█████████▋| 27/28 [00:05<00:00,  4.89it/s]100%|██████████| 28/28 [00:06<00:00,  4.89it/s]100%|██████████| 28/28 [00:06<00:00,  4.60it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 24788
INFO:root:Parameters : 1986
INFO:root:Iterations : 101
INFO:root:Time : 1.7219090461730957 [s]
INFO:root:Initial cost : 9.360259277607954 [px]
INFO:root:Final cost : 1.2751299013537674 [px]
INFO:root:Residuals : 16608
INFO:root:Parameters : 1575
INFO:root:Iterations : 101
INFO:root:Time : 1.138267993927002 [s]
INFO:root:Initial cost : 4.131768322641269 [px]
INFO:root:Final cost : 0.731978806257557 [px]
INFO:root:Residuals : 13108
INFO:root:Parameters : 1407
INFO:root:Iterations : 101
INFO:root:Time : 1.0441970825195312 [s]
INFO:root:Initial cost : 2.7592542730745064 [px]
INFO:root:Final cost : 0.5089223451087248 [px]
INFO:root:Residuals : 12792
INFO:root:Parameters : 1410
INFO:root:Iterations : 101
INFO:root:Time : 1.0574848651885986 [s]
INFO:root:Initial cost : 2.796090104891202 [px]
INFO:root:Final cost : 0.4971566763264868 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:11,  2.25it/s]  7%|▋         | 2/28 [00:01<00:15,  1.72it/s] 11%|█         | 3/28 [00:01<00:12,  1.95it/s] 14%|█▍        | 4/28 [00:01<00:11,  2.09it/s] 18%|█▊        | 5/28 [00:02<00:10,  2.12it/s] 21%|██▏       | 6/28 [00:03<00:11,  1.87it/s] 25%|██▌       | 7/28 [00:03<00:11,  1.80it/s] 29%|██▊       | 8/28 [00:04<00:12,  1.62it/s] 32%|███▏      | 9/28 [00:05<00:12,  1.56it/s] 36%|███▌      | 10/28 [00:07<00:20,  1.13s/it] 39%|███▉      | 11/28 [00:07<00:15,  1.08it/s] 43%|████▎     | 12/28 [00:08<00:12,  1.31it/s] 46%|████▋     | 13/28 [00:08<00:09,  1.51it/s] 50%|█████     | 14/28 [00:09<00:08,  1.65it/s] 54%|█████▎    | 15/28 [00:09<00:07,  1.73it/s] 57%|█████▋    | 16/28 [00:10<00:06,  1.88it/s] 61%|██████    | 17/28 [00:10<00:05,  2.00it/s] 64%|██████▍   | 18/28 [00:11<00:05,  1.86it/s] 68%|██████▊   | 19/28 [00:11<00:04,  1.88it/s] 71%|███████▏  | 20/28 [00:12<00:04,  1.97it/s] 75%|███████▌  | 21/28 [00:12<00:03,  2.09it/s] 79%|███████▊  | 22/28 [00:13<00:03,  1.89it/s] 82%|████████▏ | 23/28 [00:13<00:02,  1.96it/s] 86%|████████▌ | 24/28 [00:14<00:01,  2.05it/s] 89%|████████▉ | 25/28 [00:14<00:01,  2.15it/s] 93%|█████████▎| 26/28 [00:14<00:00,  2.19it/s] 96%|█████████▋| 27/28 [00:15<00:00,  2.19it/s]100%|██████████| 28/28 [00:15<00:00,  2.17it/s]100%|██████████| 28/28 [00:15<00:00,  1.77it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_12979718722917614085_1039_490_1059_490_1_KhrMLUyoIY_G1Khh0CNvlA.npz
metrics: {'epe3d_allo_image_all': 4.862393387726375, 'epe3d_allo_pixel_all': 5.042482061739321, 'epe3d_sf_allo_image_all': 8.213294514587947, 'epe3d_sf_allo_pixel_all': 8.517490557388022, 'num_valid_pixels': 540.0, 'delta_0.05': 0.3907407407407407, 'delta_0.1': 0.6796296296296296, 'delta_0.2': 0.8981481481481481, 'delta_0.4': 0.9648148148148148, 'outlier_0.15': 0.1537037037037037, 'delta_epe_0.1': 0.001851851851851852, 'delta_epe_0.3': 0.022222222222222223, 'delta_epe_0.5': 0.03518518518518519, 'delta_epe_1.0': 0.04259259259259259, 'outlier_epe_0.25': 0.9777777777777777}
Processing sequence: tapvid3d_6674547510992884047_1560_000_1580_000_3_xt4keJ9bhybE6_EUbvSHZA.npz with 26 pairs
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:10,  2.44it/s]  8%|▊         | 2/26 [00:00<00:12,  1.95it/s] 12%|█▏        | 3/26 [00:01<00:12,  1.87it/s] 15%|█▌        | 4/26 [00:02<00:13,  1.65it/s] 19%|█▉        | 5/26 [00:02<00:11,  1.85it/s] 23%|██▎       | 6/26 [00:03<00:09,  2.01it/s] 27%|██▋       | 7/26 [00:03<00:09,  2.01it/s] 31%|███       | 8/26 [00:04<00:11,  1.54it/s] 35%|███▍      | 9/26 [00:05<00:09,  1.72it/s] 38%|███▊      | 10/26 [00:05<00:08,  1.91it/s] 42%|████▏     | 11/26 [00:05<00:07,  2.01it/s] 46%|████▌     | 12/26 [00:06<00:08,  1.68it/s] 50%|█████     | 13/26 [00:07<00:08,  1.59it/s] 54%|█████▍    | 14/26 [00:07<00:06,  1.84it/s] 58%|█████▊    | 15/26 [00:08<00:05,  2.11it/s] 62%|██████▏   | 16/26 [00:08<00:05,  2.00it/s] 65%|██████▌   | 17/26 [00:08<00:03,  2.28it/s] 69%|██████▉   | 18/26 [00:09<00:03,  2.51it/s] 73%|███████▎  | 19/26 [00:09<00:03,  2.14it/s] 77%|███████▋  | 20/26 [00:10<00:02,  2.20it/s] 81%|████████  | 21/26 [00:10<00:02,  2.47it/s] 85%|████████▍ | 22/26 [00:10<00:01,  2.71it/s] 88%|████████▊ | 23/26 [00:11<00:01,  2.90it/s] 92%|█████████▏| 24/26 [00:11<00:00,  2.42it/s] 96%|█████████▌| 25/26 [00:11<00:00,  2.65it/s]100%|██████████| 26/26 [00:12<00:00,  2.50it/s]100%|██████████| 26/26 [00:12<00:00,  2.09it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c4f4cd850>
Test dataset length:  26
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:13,  1.80it/s]  8%|▊         | 2/26 [00:01<00:11,  2.02it/s] 12%|█▏        | 3/26 [00:01<00:08,  2.74it/s] 15%|█▌        | 4/26 [00:01<00:08,  2.60it/s] 19%|█▉        | 5/26 [00:02<00:10,  2.01it/s] 23%|██▎       | 6/26 [00:02<00:08,  2.45it/s] 27%|██▋       | 7/26 [00:02<00:07,  2.68it/s] 31%|███       | 8/26 [00:03<00:05,  3.04it/s] 35%|███▍      | 9/26 [00:03<00:04,  3.43it/s] 38%|███▊      | 10/26 [00:03<00:05,  3.06it/s] 42%|████▏     | 11/26 [00:03<00:04,  3.46it/s] 46%|████▌     | 12/26 [00:04<00:03,  3.54it/s] 50%|█████     | 13/26 [00:04<00:03,  3.69it/s] 54%|█████▍    | 14/26 [00:04<00:03,  3.34it/s] 58%|█████▊    | 15/26 [00:04<00:02,  3.72it/s] 62%|██████▏   | 16/26 [00:06<00:04,  2.02it/s] 65%|██████▌   | 17/26 [00:06<00:03,  2.44it/s] 69%|██████▉   | 18/26 [00:06<00:02,  2.87it/s] 73%|███████▎  | 19/26 [00:06<00:02,  2.95it/s] 77%|███████▋  | 20/26 [00:06<00:01,  3.31it/s] 81%|████████  | 21/26 [00:07<00:01,  3.51it/s] 85%|████████▍ | 22/26 [00:07<00:01,  3.79it/s] 88%|████████▊ | 23/26 [00:07<00:01,  2.93it/s] 92%|█████████▏| 24/26 [00:08<00:00,  3.31it/s] 96%|█████████▌| 25/26 [00:08<00:00,  3.40it/s]100%|██████████| 26/26 [00:08<00:00,  3.78it/s]100%|██████████| 26/26 [00:08<00:00,  2.99it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 35306
INFO:root:Parameters : 2214
INFO:root:Iterations : 101
INFO:root:Time : 1.650662899017334 [s]
INFO:root:Initial cost : 2.1889834648454096 [px]
INFO:root:Final cost : 0.44235919969577364 [px]
INFO:root:Residuals : 35100
INFO:root:Parameters : 2202
INFO:root:Iterations : 101
INFO:root:Time : 1.397122859954834 [s]
INFO:root:Initial cost : 1.4810165009652072 [px]
INFO:root:Final cost : 0.1881695533056288 [px]
INFO:root:Residuals : 34136
INFO:root:Parameters : 2145
INFO:root:Iterations : 101
INFO:root:Time : 1.4713609218597412 [s]
INFO:root:Initial cost : 1.3908702351914088 [px]
INFO:root:Final cost : 0.17422424220967916 [px]
INFO:root:Residuals : 33046
INFO:root:Parameters : 2082
INFO:root:Iterations : 101
INFO:root:Time : 1.3953402042388916 [s]
INFO:root:Initial cost : 1.3151264215095282 [px]
INFO:root:Final cost : 0.1715414216396694 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:13,  1.84it/s]  8%|▊         | 2/26 [00:00<00:09,  2.49it/s] 12%|█▏        | 3/26 [00:01<00:08,  2.75it/s] 15%|█▌        | 4/26 [00:02<00:17,  1.28it/s] 19%|█▉        | 5/26 [00:03<00:13,  1.51it/s] 23%|██▎       | 6/26 [00:03<00:11,  1.69it/s] 27%|██▋       | 7/26 [00:04<00:11,  1.72it/s] 31%|███       | 8/26 [00:05<00:13,  1.31it/s] 35%|███▍      | 9/26 [00:06<00:15,  1.13it/s] 38%|███▊      | 10/26 [00:06<00:11,  1.35it/s] 42%|████▏     | 11/26 [00:07<00:09,  1.58it/s] 46%|████▌     | 12/26 [00:07<00:09,  1.53it/s] 50%|█████     | 13/26 [00:08<00:08,  1.50it/s] 54%|█████▍    | 14/26 [00:09<00:07,  1.68it/s] 58%|█████▊    | 15/26 [00:09<00:06,  1.64it/s] 62%|██████▏   | 16/26 [00:11<00:09,  1.07it/s] 65%|██████▌   | 17/26 [00:12<00:08,  1.08it/s] 69%|██████▉   | 18/26 [00:12<00:06,  1.32it/s] 73%|███████▎  | 19/26 [00:13<00:04,  1.51it/s] 77%|███████▋  | 20/26 [00:13<00:03,  1.69it/s] 81%|████████  | 21/26 [00:14<00:04,  1.23it/s] 85%|████████▍ | 22/26 [00:15<00:02,  1.41it/s] 88%|████████▊ | 23/26 [00:15<00:01,  1.62it/s] 92%|█████████▏| 24/26 [00:16<00:01,  1.79it/s] 96%|█████████▌| 25/26 [00:16<00:00,  1.86it/s]100%|██████████| 26/26 [00:17<00:00,  1.81it/s]100%|██████████| 26/26 [00:17<00:00,  1.51it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_6674547510992884047_1560_000_1580_000_3_xt4keJ9bhybE6_EUbvSHZA.npz
metrics: {'epe3d_allo_image_all': 6.639469934197573, 'epe3d_allo_pixel_all': 6.905048740093525, 'epe3d_sf_allo_image_all': 10.662715804118376, 'epe3d_sf_allo_pixel_all': 11.089224407489484, 'num_valid_pixels': 325.0, 'delta_0.05': 0.09230769230769231, 'delta_0.1': 0.19692307692307692, 'delta_0.2': 0.3569230769230769, 'delta_0.4': 0.5846153846153846, 'outlier_0.15': 0.7230769230769231, 'delta_epe_0.1': 0.0, 'delta_epe_0.3': 0.0, 'delta_epe_0.5': 0.0, 'delta_epe_1.0': 0.04, 'outlier_epe_0.25': 1.0}
Processing sequence: tapvid3d_17993467596234560701_4940_000_4960_000_1_QHCDaXdDjHRbm1BaoyCNDA.npz with 50 pairs
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:21,  2.29it/s]  4%|▍         | 2/50 [00:00<00:21,  2.21it/s]  6%|▌         | 3/50 [00:01<00:21,  2.17it/s]  8%|▊         | 4/50 [00:02<00:31,  1.44it/s] 10%|█         | 5/50 [00:02<00:27,  1.62it/s] 12%|█▏        | 6/50 [00:03<00:24,  1.81it/s] 14%|█▍        | 7/50 [00:03<00:22,  1.90it/s] 16%|█▌        | 8/50 [00:04<00:21,  1.95it/s] 18%|█▊        | 9/50 [00:04<00:20,  1.98it/s] 20%|██        | 10/50 [00:05<00:19,  2.01it/s] 22%|██▏       | 11/50 [00:05<00:18,  2.08it/s] 24%|██▍       | 12/50 [00:06<00:17,  2.15it/s] 26%|██▌       | 13/50 [00:06<00:16,  2.19it/s] 28%|██▊       | 14/50 [00:07<00:16,  2.19it/s] 30%|███       | 15/50 [00:07<00:17,  2.00it/s] 32%|███▏      | 16/50 [00:08<00:16,  2.07it/s] 34%|███▍      | 17/50 [00:08<00:15,  2.07it/s] 36%|███▌      | 18/50 [00:09<00:17,  1.80it/s] 38%|███▊      | 19/50 [00:09<00:16,  1.88it/s] 40%|████      | 20/50 [00:10<00:15,  1.96it/s] 42%|████▏     | 21/50 [00:10<00:14,  2.01it/s] 44%|████▍     | 22/50 [00:11<00:13,  2.07it/s] 46%|████▌     | 23/50 [00:11<00:12,  2.09it/s] 48%|████▊     | 24/50 [00:12<00:12,  2.13it/s] 50%|█████     | 25/50 [00:12<00:11,  2.10it/s] 52%|█████▏    | 26/50 [00:13<00:11,  2.00it/s] 54%|█████▍    | 27/50 [00:13<00:11,  2.05it/s] 56%|█████▌    | 28/50 [00:14<00:10,  2.05it/s] 58%|█████▊    | 29/50 [00:14<00:10,  2.09it/s] 60%|██████    | 30/50 [00:14<00:09,  2.12it/s] 62%|██████▏   | 31/50 [00:15<00:09,  2.10it/s] 64%|██████▍   | 32/50 [00:15<00:08,  2.13it/s] 66%|██████▌   | 33/50 [00:16<00:07,  2.15it/s] 68%|██████▊   | 34/50 [00:16<00:07,  2.26it/s] 70%|███████   | 35/50 [00:17<00:06,  2.29it/s] 72%|███████▏  | 36/50 [00:17<00:06,  2.26it/s] 74%|███████▍  | 37/50 [00:18<00:05,  2.25it/s] 76%|███████▌  | 38/50 [00:18<00:05,  2.26it/s] 78%|███████▊  | 39/50 [00:18<00:04,  2.24it/s] 80%|████████  | 40/50 [00:19<00:04,  2.42it/s] 82%|████████▏ | 41/50 [00:19<00:03,  2.60it/s] 84%|████████▍ | 42/50 [00:19<00:02,  2.75it/s] 86%|████████▌ | 43/50 [00:20<00:02,  2.85it/s] 88%|████████▊ | 44/50 [00:20<00:02,  2.91it/s] 90%|█████████ | 45/50 [00:21<00:02,  2.18it/s] 92%|█████████▏| 46/50 [00:21<00:01,  2.36it/s] 94%|█████████▍| 47/50 [00:21<00:01,  2.50it/s] 96%|█████████▌| 48/50 [00:22<00:00,  2.65it/s] 98%|█████████▊| 49/50 [00:22<00:00,  2.78it/s]100%|██████████| 50/50 [00:22<00:00,  2.88it/s]100%|██████████| 50/50 [00:22<00:00,  2.18it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c50828fe0>
Test dataset length:  50
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:27,  1.76it/s]  4%|▍         | 2/50 [00:00<00:17,  2.71it/s]  6%|▌         | 3/50 [00:01<00:14,  3.22it/s]  8%|▊         | 4/50 [00:01<00:24,  1.84it/s] 10%|█         | 5/50 [00:02<00:19,  2.30it/s] 12%|█▏        | 6/50 [00:02<00:16,  2.69it/s] 14%|█▍        | 7/50 [00:02<00:14,  3.03it/s] 16%|█▌        | 8/50 [00:02<00:12,  3.25it/s] 18%|█▊        | 9/50 [00:03<00:12,  3.41it/s] 20%|██        | 10/50 [00:03<00:11,  3.46it/s] 22%|██▏       | 11/50 [00:03<00:10,  3.64it/s] 24%|██▍       | 12/50 [00:04<00:15,  2.52it/s] 26%|██▌       | 13/50 [00:04<00:13,  2.84it/s] 28%|██▊       | 14/50 [00:04<00:11,  3.06it/s] 30%|███       | 15/50 [00:05<00:10,  3.30it/s] 32%|███▏      | 16/50 [00:05<00:11,  3.02it/s] 34%|███▍      | 17/50 [00:05<00:10,  3.16it/s] 36%|███▌      | 18/50 [00:06<00:09,  3.35it/s] 38%|███▊      | 19/50 [00:06<00:08,  3.56it/s] 40%|████      | 20/50 [00:06<00:08,  3.67it/s] 42%|████▏     | 21/50 [00:07<00:09,  3.06it/s] 44%|████▍     | 22/50 [00:07<00:08,  3.31it/s] 46%|████▌     | 23/50 [00:07<00:07,  3.51it/s] 48%|████▊     | 24/50 [00:07<00:07,  3.57it/s] 50%|█████     | 25/50 [00:08<00:06,  3.66it/s] 52%|█████▏    | 26/50 [00:08<00:06,  3.62it/s] 54%|█████▍    | 27/50 [00:08<00:08,  2.64it/s] 56%|█████▌    | 28/50 [00:09<00:07,  2.90it/s] 58%|█████▊    | 29/50 [00:09<00:06,  3.23it/s] 60%|██████    | 30/50 [00:09<00:05,  3.39it/s] 62%|██████▏   | 31/50 [00:09<00:05,  3.52it/s] 64%|██████▍   | 32/50 [00:10<00:04,  3.61it/s] 66%|██████▌   | 33/50 [00:10<00:04,  3.71it/s] 68%|██████▊   | 34/50 [00:10<00:04,  3.67it/s] 70%|███████   | 35/50 [00:11<00:04,  3.73it/s] 72%|███████▏  | 36/50 [00:11<00:03,  3.69it/s] 74%|███████▍  | 37/50 [00:11<00:03,  3.70it/s] 76%|███████▌  | 38/50 [00:11<00:03,  3.60it/s] 78%|███████▊  | 39/50 [00:12<00:03,  3.66it/s] 80%|████████  | 40/50 [00:12<00:02,  3.69it/s] 82%|████████▏ | 41/50 [00:12<00:02,  3.71it/s] 84%|████████▍ | 42/50 [00:12<00:02,  3.77it/s] 86%|████████▌ | 43/50 [00:13<00:01,  3.89it/s] 88%|████████▊ | 44/50 [00:13<00:01,  3.86it/s] 90%|█████████ | 45/50 [00:13<00:01,  3.07it/s] 92%|█████████▏| 46/50 [00:14<00:01,  3.19it/s] 94%|█████████▍| 47/50 [00:14<00:00,  3.33it/s] 96%|█████████▌| 48/50 [00:14<00:00,  3.37it/s] 98%|█████████▊| 49/50 [00:15<00:00,  3.25it/s]100%|██████████| 50/50 [00:15<00:00,  3.21it/s]100%|██████████| 50/50 [00:15<00:00,  3.24it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
INFO:root:Residuals : 24148
INFO:root:Parameters : 1599
INFO:root:Iterations : 101
INFO:root:Time : 1.019477128982544 [s]
INFO:root:Initial cost : 14.722389507252064 [px]
INFO:root:Final cost : 0.7119797631340185 [px]
INFO:root:Residuals : 26318
INFO:root:Parameters : 1866
INFO:root:Iterations : 101
INFO:root:Time : 1.1543011665344238 [s]
INFO:root:Initial cost : 5.3114683694435385 [px]
INFO:root:Final cost : 0.9794014659174564 [px]
INFO:root:Residuals : 22842
INFO:root:Parameters : 1716
INFO:root:Iterations : 101
INFO:root:Time : 1.0130338668823242 [s]
INFO:root:Initial cost : 4.246309050403799 [px]
INFO:root:Final cost : 0.40913584986494206 [px]
INFO:root:Residuals : 21626
INFO:root:Parameters : 1677
INFO:root:Iterations : 101
INFO:root:Time : 0.9574770927429199 [s]
INFO:root:Initial cost : 3.7191556902811955 [px]
INFO:root:Final cost : 0.42513131140022464 [px]
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:00<00:18,  2.66it/s]  4%|▍         | 2/50 [00:00<00:17,  2.80it/s]  6%|▌         | 3/50 [00:01<00:16,  2.89it/s]  8%|▊         | 4/50 [00:02<00:34,  1.33it/s] 10%|█         | 5/50 [00:02<00:27,  1.66it/s] 12%|█▏        | 6/50 [00:03<00:22,  1.97it/s] 14%|█▍        | 7/50 [00:03<00:19,  2.23it/s] 16%|█▌        | 8/50 [00:03<00:17,  2.43it/s] 18%|█▊        | 9/50 [00:04<00:15,  2.57it/s] 20%|██        | 10/50 [00:04<00:14,  2.68it/s] 22%|██▏       | 11/50 [00:04<00:14,  2.78it/s] 24%|██▍       | 12/50 [00:05<00:13,  2.79it/s] 26%|██▌       | 13/50 [00:05<00:12,  2.85it/s] 28%|██▊       | 14/50 [00:05<00:12,  2.82it/s] 30%|███       | 15/50 [00:06<00:13,  2.62it/s] 32%|███▏      | 16/50 [00:06<00:14,  2.30it/s] 34%|███▍      | 17/50 [00:07<00:14,  2.34it/s] 36%|███▌      | 18/50 [00:07<00:13,  2.36it/s] 38%|███▊      | 19/50 [00:08<00:13,  2.37it/s] 40%|████      | 20/50 [00:08<00:12,  2.39it/s] 42%|████▏     | 21/50 [00:09<00:13,  2.13it/s] 44%|████▍     | 22/50 [00:09<00:14,  1.89it/s] 46%|████▌     | 23/50 [00:10<00:13,  2.02it/s] 48%|████▊     | 24/50 [00:10<00:11,  2.25it/s] 50%|█████     | 25/50 [00:10<00:10,  2.45it/s] 52%|█████▏    | 26/50 [00:11<00:10,  2.20it/s] 54%|█████▍    | 27/50 [00:11<00:10,  2.16it/s] 56%|█████▌    | 28/50 [00:12<00:09,  2.37it/s] 58%|█████▊    | 29/50 [00:12<00:09,  2.25it/s] 60%|██████    | 30/50 [00:12<00:08,  2.45it/s] 62%|██████▏   | 31/50 [00:13<00:07,  2.62it/s] 64%|██████▍   | 32/50 [00:13<00:06,  2.75it/s] 66%|██████▌   | 33/50 [00:13<00:05,  2.86it/s] 68%|██████▊   | 34/50 [00:14<00:07,  2.23it/s] 70%|███████   | 35/50 [00:14<00:06,  2.43it/s] 72%|███████▏  | 36/50 [00:15<00:05,  2.60it/s] 74%|███████▍  | 37/50 [00:15<00:04,  2.72it/s] 76%|███████▌  | 38/50 [00:15<00:04,  2.80it/s] 78%|███████▊  | 39/50 [00:16<00:03,  2.82it/s] 80%|████████  | 40/50 [00:16<00:03,  2.85it/s] 82%|████████▏ | 41/50 [00:16<00:03,  2.92it/s] 84%|████████▍ | 42/50 [00:17<00:02,  2.83it/s] 86%|████████▌ | 43/50 [00:17<00:02,  2.90it/s] 88%|████████▊ | 44/50 [00:17<00:02,  2.96it/s] 90%|█████████ | 45/50 [00:18<00:01,  3.01it/s] 92%|█████████▏| 46/50 [00:18<00:01,  3.05it/s] 94%|█████████▍| 47/50 [00:18<00:00,  3.07it/s] 96%|█████████▌| 48/50 [00:19<00:00,  3.08it/s] 98%|█████████▊| 49/50 [00:19<00:00,  3.10it/s]100%|██████████| 50/50 [00:19<00:00,  3.06it/s]100%|██████████| 50/50 [00:19<00:00,  2.51it/s]
Skipping image pair 0 due to no valid points in gt_valid_mask0
sequence:/ocean/projects/cis220039p/mdt2/datasets/dydust3r/tapvid3d_dataset/drivetrack/tapvid3d_17993467596234560701_4940_000_4960_000_1_QHCDaXdDjHRbm1BaoyCNDA.npz
metrics: {'epe3d_allo_image_all': 4.595717221498489, 'epe3d_allo_pixel_all': 4.6895073916137315, 'epe3d_sf_allo_image_all': 10.943223706483842, 'epe3d_sf_allo_pixel_all': 11.166554850349247, 'num_valid_pixels': 637.0, 'delta_0.05': 0.3092621664050236, 'delta_0.1': 0.7048665620094191, 'delta_0.2': 0.989010989010989, 'delta_0.4': 1.0, 'outlier_0.15': 0.0423861852433281, 'delta_epe_0.1': 0.0, 'delta_epe_0.3': 0.015698587127158554, 'delta_epe_0.5': 0.0282574568288854, 'delta_epe_1.0': 0.061224489795918366, 'outlier_epe_0.25': 0.989010989010989}
Processing sequence: tapvid3d_11940460932056521663_1760_000_1780_000_1_9yu1CheynE6kQgwzmHcInQ.npz with 33 pairs
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:08,  3.69it/s]  6%|▌         | 2/33 [00:00<00:14,  2.19it/s]  9%|▉         | 3/33 [00:01<00:13,  2.22it/s] 12%|█▏        | 4/33 [00:01<00:12,  2.34it/s] 15%|█▌        | 5/33 [00:02<00:11,  2.43it/s] 18%|█▊        | 6/33 [00:02<00:11,  2.26it/s] 21%|██        | 7/33 [00:03<00:11,  2.26it/s] 24%|██▍       | 8/33 [00:03<00:10,  2.32it/s] 27%|██▋       | 9/33 [00:03<00:10,  2.34it/s] 30%|███       | 10/33 [00:04<00:10,  2.16it/s] 33%|███▎      | 11/33 [00:04<00:09,  2.31it/s] 36%|███▋      | 12/33 [00:05<00:09,  2.33it/s] 39%|███▉      | 13/33 [00:05<00:09,  2.14it/s] 42%|████▏     | 14/33 [00:06<00:08,  2.22it/s] 45%|████▌     | 15/33 [00:06<00:07,  2.36it/s] 48%|████▊     | 16/33 [00:07<00:08,  2.00it/s] 52%|█████▏    | 17/33 [00:08<00:09,  1.61it/s] 55%|█████▍    | 18/33 [00:08<00:08,  1.79it/s] 58%|█████▊    | 19/33 [00:08<00:07,  1.91it/s] 61%|██████    | 20/33 [00:09<00:06,  2.01it/s] 64%|██████▎   | 21/33 [00:09<00:05,  2.18it/s] 67%|██████▋   | 22/33 [00:10<00:04,  2.31it/s] 70%|██████▉   | 23/33 [00:10<00:04,  2.30it/s] 73%|███████▎  | 24/33 [00:11<00:04,  2.20it/s] 76%|███████▌  | 25/33 [00:11<00:03,  2.27it/s] 79%|███████▉  | 26/33 [00:12<00:03,  2.12it/s] 82%|████████▏ | 27/33 [00:12<00:02,  2.14it/s] 85%|████████▍ | 28/33 [00:12<00:02,  2.25it/s] 88%|████████▊ | 29/33 [00:13<00:01,  2.29it/s] 91%|█████████ | 30/33 [00:13<00:01,  2.30it/s] 94%|█████████▍| 31/33 [00:14<00:00,  2.29it/s] 97%|█████████▋| 32/33 [00:14<00:00,  2.27it/s]100%|██████████| 33/33 [00:14<00:00,  2.34it/s]100%|██████████| 33/33 [00:14<00:00,  2.20it/s]
Building Test Data loader for dataset:  <torch.utils.data.dataset.Subset object at 0x7f1c50a7fda0>
Test dataset length:  33
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:18,  1.77it/s]  6%|▌         | 2/33 [00:00<00:11,  2.68it/s]  9%|▉         | 3/33 [00:01<00:09,  3.27it/s] 12%|█▏        | 4/33 [00:01<00:08,  3.38it/s] 15%|█▌        | 5/33 [00:01<00:07,  3.66it/s] 18%|█▊        | 6/33 [00:01<00:06,  3.89it/s] 21%|██        | 7/33 [00:02<00:09,  2.73it/s] 24%|██▍       | 8/33 [00:02<00:07,  3.16it/s] 27%|██▋       | 9/33 [00:02<00:06,  3.53it/s] 30%|███       | 10/33 [00:02<00:05,  3.85it/s] 33%|███▎      | 11/33 [00:03<00:05,  3.96it/s] 36%|███▋      | 12/33 [00:03<00:05,  4.02it/s] 39%|███▉      | 13/33 [00:03<00:04,  4.10it/s] 42%|████▏     | 14/33 [00:03<00:04,  3.92it/s] 45%|████▌     | 15/33 [00:04<00:04,  4.10it/s] 48%|████▊     | 16/33 [00:04<00:04,  3.57it/s] 52%|█████▏    | 17/33 [00:06<00:13,  1.22it/s] 55%|█████▍    | 18/33 [00:06<00:09,  1.52it/s] 58%|█████▊    | 19/33 [00:07<00:07,  1.92it/s] 61%|██████    | 20/33 [00:07<00:05,  2.30it/s] 64%|██████▎   | 21/33 [00:07<00:04,  2.70it/s] 67%|██████▋   | 22/33 [00:07<00:03,  3.01it/s] 70%|██████▉   | 23/33 [00:08<00:03,  3.23it/s] 73%|███████▎  | 24/33 [00:08<00:02,  3.53it/s] 76%|███████▌  | 25/33 [00:08<00:02,  3.78it/s] 79%|███████▉  | 26/33 [00:08<00:02,  3.18it/s] 82%|████████▏ | 27/33 [00:09<00:01,  3.46it/s] 85%|████████▍ | 28/33 [00:09<00:01,  3.55it/s] 88%|████████▊ | 29/33 [00:09<00:01,  3.76it/s] 91%|█████████ | 30/33 [00:09<00:00,  3.89it/s] 94%|█████████▍| 31/33 [00:10<00:00,  4.03it/s] 97%|█████████▋| 32/33 [00:10<00:00,  3.33it/s]100%|██████████| 33/33 [00:11<00:00,  2.67it/s]100%|██████████| 33/33 [00:11<00:00,  2.96it/s]
Using cache found in /jet/home/jkarhade/.cache/torch/hub/facebookresearch_dinov2_main
INFO:dinov2:using MLP layer as FFN
Initializing <class 'anymap.models.mapa.any4d_mapa_dual_dpt_model.Any4D_MAPA_Dual_DPT'> with kwargs: {'torch_hub_force_reload': False, 'pretrained_checkpoint_path': None, 'load_specific_pretrained_submodules': False, 'specific_pretrained_submodules': [], 'name': 'any4d_mapa_dual_dpt', 'encoder_config': {'encoder_str': 'dinov2', 'name': 'dinov2_large', 'data_norm_type': 'dinov2', 'size': 'large', 'with_registers': False, 'uses_torch_hub': False, 'gradient_checkpointing': False}, 'info_sharing_config': {'model_type': 'alternating_attention', 'model_return_type': 'intermediate_features', 'custom_positional_encoding': None, 'module_args': {'name': 'aat_24_layers_ifr_mapa', 'indices': [11, 17], 'norm_intermediate': True, 'size': '24_layers', 'depth': 24, 'distinguish_ref_and_non_ref_views': True, 'gradient_checkpointing': False}}, 'pred_head_config': {'adaptor_config': {'input_dim': 6, 'scene_rep_dim': 4, 'type': 'raydirs+depth+pose+confidence+mask', 'scene_rep_type': 'raydirs+depth+pose', 'dense_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 6}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'raydirs+depth+pose+confidence+mask', 'dpt_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'ray_directions_mode': 'linear', 'ray_directions_normalize_to_unit_sphere': True, 'ray_directions_normalize_to_unit_image_plane': False, 'ray_directions_vmin': -inf, 'ray_directions_vmax': inf, 'ray_directions_clamp_min_of_z_dir': False, 'ray_directions_z_dir_min': -inf, 'depth_mode': 'exp', 'depth_vmin': 0, 'depth_vmax': inf, 'confidence_type': 'exp', 'confidence_vmin': 1, 'confidence_vmax': inf}, 'pose_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'raydirs+depth+pose+confidence+mask+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'scene_flow_pred_head_config': {'adaptor_config': {'input_dim': 3, 'scene_rep_dim': 3, 'type': 'scene_flow+pose+scale', 'scene_rep_type': 'scene_flow+pose+scale', 'dense_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_pred_init_dict': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_pred_init_dict': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'type': 'dpt+pose', 'feature_head': {'feature_dim': 256, 'hooks': [0, 1, 2, 3]}, 'regressor_head': {'output_dim': 3}, 'pose_head': {'num_resconv_block': 2, 'rot_representation_dim': 4}, 'scale_head': {'output_dim': 1}, 'adaptor_type': 'scene_flow+pose+scale', 'dpt_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'linear', 'vmin': -inf, 'vmax': inf}, 'pose_adaptor': {'name': 'scene_flow+pose+scale', 'cam_trans_mode': 'linear', 'cam_trans_vmin': -inf, 'cam_trans_vmax': inf, 'quaternions_mode': 'linear', 'quaternions_normalize': True, 'quaternions_vmin': -inf, 'quaternions_vmax': inf}, 'scale_adaptor': {'name': 'scene_flow+pose+scale', 'mode': 'exp', 'vmin': 1e-08, 'vmax': inf}}, 'geometric_input_config': {'ray_dirs_encoder_config': {'name': 'ray_dirs_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'depth_encoder_config': {'name': 'depth_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder', 'apply_pe': False}, 'cam_rot_encoder_config': {'name': 'cam_rot_quats_encoder', 'in_chans': 4, 'encoder_str': 'global_rep_encoder'}, 'cam_trans_encoder_config': {'name': 'cam_trans_encoder', 'in_chans': 3, 'encoder_str': 'global_rep_encoder'}, 'scale_encoder_config': {'name': 'scale_encoder', 'in_chans': 1, 'encoder_str': 'global_rep_encoder'}, 'event_encoder_config': {'name': 'event_encoder', 'in_chans': 1, 'encoder_str': 'dense_rep_encoder'}, 'scene_flow_encoder_config': {'name': 'scene_flow_encoder', 'in_chans': 3, 'encoder_str': 'dense_rep_encoder'}, 'overall_prob': 0, 'dropout_prob': 1, 'ray_dirs_prob': 0, 'depth_prob': 0, 'cam_prob': 0, 'sparse_depth_prob': 0, 'sparsification_removal_percent': 0, 'depth_scale_norm_all_prob': 0, 'pose_scale_norm_all_prob': 0, 'event_imgs_prob': 0, 'scene_flow_prob': 0}}
Loading pretrained dinov2_vitl14 from torch hub
Loading model from:  /ocean/projects/cis220039p/mdt2/jkarhade/Any4D/any4d_experiments/mapanything_finetune_megatraining/any4d_mapa_dual_dpt_aug_training_dynamic_all_mapa_finetune_run_no_metric_supervision/checkpoint-best.pth
<All keys matched successfully>
Traceback (most recent call last):
  File "/ocean/projects/cis220039p/mdt2/jkarhade/Any4D/benchmarking/SpaTrackerV2/spatrackv2_any4d_benchmark.py", line 819, in <module>
    main()
  File "/ocean/projects/cis220039p/mdt2/jkarhade/Any4D/benchmarking/SpaTrackerV2/spatrackv2_any4d_benchmark.py", line 595, in main
    predictions = spatrackv2_inference(args, collected_views, collected_imgs, query_pts)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/cis220039p/mdt2/jkarhade/Any4D/benchmarking/SpaTrackerV2/spatrackv2_any4d_benchmark.py", line 430, in spatrackv2_inference
    ) = model.forward(video_tensor, depth=depth_tensor,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/cis220039p/mdt2/jkarhade/Any4D/benchmarking/SpaTrackerV2/models/SpaTrackV2/models/predictor.py", line 83, in forward
    ret = self.spatrack.forward_stream(video, queries, T_org=T_,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/cis220039p/mdt2/jkarhade/Any4D/benchmarking/SpaTrackerV2/models/SpaTrackV2/models/SpaTrack.py", line 293, in forward_stream
    out = self.forward(segment, pts_q=queries_new,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/cis220039p/mdt2/jkarhade/Any4D/benchmarking/SpaTrackerV2/models/SpaTrackV2/models/SpaTrack.py", line 623, in forward
    indices = torch.randint(0, pts_q.shape[2], (pad_num,), device=pts_q.device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: random_ expects 'from' to be less than 'to', but got from=0 >= to=0
